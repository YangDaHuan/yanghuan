/*!
 * jQuery outside events - v1.1 - 3/16/2010
 * http://benalman.com/projects/jquery-outside-events-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
define("components/containerbuilder/containerbuilder",[],function(){function a(a){var b=a.Position.XPos,c=a.Position.YPos,d=a.Width.Value,e=a.Height.Value,f='<div class="arcComponentContainer" style="left: '+b+"px;"+"top: "+c+"px;"+"width: "+d+"px;"+"height: "+e+'px;"'+" />";return $(f)}return{createContainer:a}}),define("stringtools",[],function(){var a={};return a.browserLangToArcplanLang=function(a){var b=a,c=a.indexOf("-");return c>0&&(b=a.substring(0,c)),b},a.encodeUtf8=function(a){return unescape(encodeURIComponent(a))},a.encodeBase64=function(a){var b="",c="",d,e,f,g,h,i,j,k=0,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";typeof a!="undefined"&&a!==null&&(b=a.toString());if(b.length===0)return"";do d=e=f=0,g=h=i=j=0,d=b.charCodeAt(k),k+1<b.length&&(e=b.charCodeAt(k+1)),k+2<b.length&&(f=b.charCodeAt(k+2)),k+=3,g=d/4,h=d%4*16+e/16,i=e%16*4+f/64,j=f%64,k===b.length+2?i=j=64:k===b.length+1&&(j=64),c=c+l.charAt(g)+l.charAt(h)+l.charAt(i)+l.charAt(j);while(k<b.length);return c},a.escapeForXml=function(a){var b;return typeof a=="string"?(b=a.replace(/&/g,"&amp;"),b=b.replace(/</g,"&lt;"),b):a.toString()},a.encodeDocName=function(a){var b="";return typeof a=="string"&&(b=encodeURIComponent(a),b=b.replace(/!/g,"%21"),b=b.replace(/'/g,"%27"),b=b.replace(/\(/g,"%28"),b=b.replace(/\)/g,"%29"),b=b.replace(/~/g,"%7E"),b=b.replace(/_/g,"%5F"),b=b.replace(/%/g,"_")),b},a.makeID=function(b,c){var d=a.encodeDocName(b);return"Cont"+Math.abs(c)+"_"+d},a.makeClassName=function(a){return"arc"+a},a.convertNewLineToHTMLBreaks=function(a){return typeof a=="string"?a.replace(/(\r\n|[\r\n])/g,"<br />"):""},a.removeExtension=function(a){return a.replace(/\.apd$/i,"")},a.hasUrlWrongProtocol=function(a,b){var c="",d=a.indexOf("://");return d!==-1?(c=a.substring(0,d+1),c.toLowerCase()!==b.toLowerCase()):!1},a.removeRubbishFromClientBaseURL=function(a){return a.replace(/\.js[a-zA-Z0-9=%\?\.]*/,"")},a}),define("assert/assert",[],function(){return function(a,b){if(!a)throw b=b||"Assertion failed",new Error(b)}}),define("nodetypes",[],{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}),define("guitypes",[],function(){var a={Undefined:"0",Logon:"-1",Question:"-2",Message:"-3",SAPVariable:"-4",Popupmenu:"-5",Textentry:"-6",DomainLogon:"-7",UserPrinter:"-8",FileToApplet:"-11",FileFromApplet:"-12",ClientParameter:"-13",UserFunction:"-14",LogonMixed:"-15",DomainLogonMixed:"-16",SAPCookie:"-17",WebServerVariable:"-18",Mkdir:"-19",StartJS:"-20",GetKeychain:"-21",ClientStoreKey:"-22",LogonMixedKeepLogin:"-23"};return a.isLoginGUIType=function(b){var c=b.Type||a.Undefined;return c===a.Logon||c===a.DomainLogon||c===a.LogonMixed||c===a.DomainLogonMixed||c===a.LogonMixedKeepLogin},a.isDomainLogin=function(b){var c=b.Type||a.Undefined;return c===a.DomainLogon||b.Type===a.DomainLogonMixed},a.isLogonMixedKeepLogin=function(b){var c=b.Type||a.Undefined;return c===a.LogonMixedKeepLogin},a}),define("keycodes",{Tab:9,Enter:13,ESC:27,UpArrow:38,DownArrow:40,LeftArrow:37,RightArrow:39,Space:32,Semicolon:186,Equals:187,Slash:191,Point:190,Dash:189,DecimalPoint:110,Minus:109,Divide:111,OpenBracket:219,CloseBracket:221,PageUp:33,PageDown:34,End:35,Pos1:36}),define("drivertype",[],function(){var a=["SAPDriver","SAPSEMDriver","OIWDriver","OLAPBIWDriver","BWNativeDriver","SAPQueryDriver","SAPHANAMDXDriver"],b={SQLSDriver:"1",ODBCDriver:"2",MAC_ODBCDriver:"3",MAC_DALDriver:"4",ISObjectDriver:"5",SAPDriver:"6",MIKDriver:"7",MCubeDriver:"8",OIWDriver:"9",SAPHier:"10",ALEADriver:"11",EXPRESSDriver:"12",ESSBASEDriver:"13",BIWDriver:"14",MIKOLAPDriver:"15",TM1Driver:"16",BIWHier:"17",MDXHier:"18",DYNADriver:"19",HYPERIONDriver:"20",SAPQueryDriver:"21",XMLDriver:"22",NewBIWHier:"23",OLAPODBCDriver:"24",XMLONLINEDriver:"25",WEBSERVICEDriver:"26",SAPSEMDriver:"27",HFMDriver:"28",IBMOLAPDriver:"29",ORACLEDriver:"30",LDAPDriver:"31",CubeViewsDriver:"32",ORACLEOLAPDMLDriver:"33",TAMINODriver:"34",OLAPZeroSuppression:"35",AdabasDriver:"36",PowerOLAPDriver:"37",NoDriverClientLogin:"38",OLAPDBDriver:"1000",OLAPBIWDriver:"1001",OLAPTM1Driver:"1003",OLAPMSDriver:"1004",OLAPUniversal:"1005",BWNativeDriver:"1006",MICROSTRATDriver:"1007",XMLADriver:"1008",EssbaseMDXDriver:"1009",CubingServicesDriver:"1010",OLAPTeraDataDriver:"1011",OracleOLAPMDXDriver:"1012",SAPHANAMDXDriver:"1013",KOGNITIOPABLODriver:"1014",LUCANETDriver:"1015",ORACLEOLAPDriver:"1101",UNDEFINEDDRIVER:"10000",UNDEFINEDOLAPDRIVER:"10001",FORMULAREFDriver:"10002"};return b.isSAPDriver=function(c){var d="",e;typeof c.UserLogin=="object"&&(d=c.UserLogin.DriverType||"");for(e=0;e<a.length;e+=1)if(d===b[a[e]])return!0;return!1},b}),define("usertypes",{windows:"0",arcplan:"1",arcplanOrWindows:"2"}),define("replytypes",{storeKey:22,getKeychain:21,startJS:20,msgbox:2,question:2,popupmenu:5,printerAlias:8}),define("jstorage",[],function(){var a={};return function(){function s(){var a=!1;if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval"),a=!0,window.localStorage.removeItem("_tmptest")}catch(b){}if(a)try{window.localStorage&&(f=window.localStorage,i="localStorage",l=f.jStorage_update)}catch(c){}else if("globalStorage"in window)try{window.globalStorage&&(f=window.globalStorage[window.location.hostname],i="globalStorage",l=f.jStorage_update)}catch(d){}else{g=document.createElement("link");if(!g.addBehavior){g=null;return}g.style.behavior="url(#default#userData)",document.getElementsByTagName("head")[0].appendChild(g);try{g.load("jStorage")}catch(e){g.setAttribute("jStorage","{}"),g.save("jStorage"),g.load("jStorage")}var h="{}";try{h=g.getAttribute("jStorage")}catch(j){}try{l=g.getAttribute("jStorage_update")}catch(k){}f.jStorage=h,i="userDataBehavior"}A(),D(),t("local"),t("session"),v(),E(),"addEventListener"in window&&window.addEventListener("pageshow",function(a){a.persisted&&w()},!1)}function t(a,b){function m(){if(a!="session")return;try{k=d.parse(window.name||"{}")}catch(b){k={}}}function n(){if(a!="session")return;window.name=d.stringify(k)}var f=!1,g=0,h,j,k={},l=Math.random();if(!b&&typeof window[a+"Storage"]!="undefined")return;if(a=="local"&&window.globalStorage){localStorage=window.globalStorage[window.location.hostname];return}if(i!="userDataBehavior")return;b&&window[a+"Storage"]&&window[a+"Storage"].parentNode&&window[a+"Storage"].parentNode.removeChild(window[a+"Storage"]),j=document.createElement("button"),document.getElementsByTagName("head")[0].appendChild(j),a=="local"?k=e:a=="session"&&m();for(h in k)k.hasOwnProperty(h)&&h!="__jstorage_meta"&&h!="length"&&typeof k[h]!="undefined"&&(h in j||g++,j[h]=k[h]);j.length=g,j.key=function(a){var b=0,c;m();for(c in k)if(k.hasOwnProperty(c)&&c!="__jstorage_meta"&&c!="length"&&typeof k[c]!="undefined"){if(b==a)return c;b++}},j.getItem=function(b){return m(),a=="session"?k[b]:c.jStorage.get(b)},j.setItem=function(a,b){if(typeof b=="undefined")return;j[a]=(b||"").toString()},j.removeItem=function(b){if(a=="local")return c.jStorage.deleteKey(b);j[b]=undefined,f=!0,b in j&&j.removeAttribute(b),f=!1},j.clear=function(){if(a=="session"){window.name="",t("session",!0);return}c.jStorage.flush()},a=="local"&&(r=function(a,b){if(a=="length")return;f=!0,typeof b=="undefined"?a in j&&(g--,j.removeAttribute(a)):(a in j||g++,j[a]=(b||"").toString()),j.length=g,f=!1}),j.attachEvent("onpropertychange",function(b){if(b.propertyName=="length")return;if(f||b.propertyName=="length")return;if(a=="local")!(b.propertyName in k)&&typeof j[b.propertyName]!="undefined"&&g++;else if(a=="session"){m(),typeof j[b.propertyName]=="undefined"||b.propertyName in k?typeof j[b.propertyName]=="undefined"&&b.propertyName in k?(delete k[b.propertyName],g--):k[b.propertyName]=j[b.propertyName]:(k[b.propertyName]=j[b.propertyName],g++),n(),j.length=g;return}c.jStorage.set(b.propertyName,j[b.propertyName]),j.length=g}),window[a+"Storage"]=j}function u(){var a="{}";if(i=="userDataBehavior"){g.load("jStorage");try{a=g.getAttribute("jStorage")}catch(b){}try{l=g.getAttribute("jStorage_update")}catch(c){}f.jStorage=a}A(),D(),E()}function v(){i=="localStorage"||i=="globalStorage"?"addEventListener"in window?window.addEventListener("storage",w,!1):document.attachEvent("onstorage",w):i=="userDataBehavior"&&setInterval(w,1e3)}function w(){var a;clearTimeout(k),k=setTimeout(function(){if(i=="localStorage"||i=="globalStorage")a=f.jStorage_update;else if(i=="userDataBehavior"){g.load("jStorage");try{a=g.getAttribute("jStorage_update")}catch(b){}}a&&a!=l&&(l=a,x())},25)}function x(){var a=d.parse(d.stringify(e.__jstorage_meta.CRC32)),b;u(),b=d.parse(d.stringify(e.__jstorage_meta.CRC32));var c,f=[],g=[];for(c in a)if(a.hasOwnProperty(c)){if(!b[c]){g.push(c);continue}a[c]!=b[c]&&f.push(c)}for(c in b)b.hasOwnProperty(c)&&(a[c]||f.push(c));y(f,"updated"),y(g,"deleted")}function y(a,b){a=[].concat(a||[]);if(b=="flushed"){a=[];for(var c in j)j.hasOwnProperty(c)&&a.push(c);b="deleted"}for(var d=0,e=a.length;d<e;d++)if(j[a[d]])for(var f=0,g=j[a[d]].length;f<g;f++)j[a[d]][f](a[d],b)}function z(){var a=(+(new Date)).toString();i=="localStorage"||i=="globalStorage"?f.jStorage_update=a:i=="userDataBehavior"&&(g.setAttribute("jStorage_update",a),g.save("jStorage")),w()}function A(){if(f.jStorage)try{e=d.parse(String(f.jStorage))}catch(a){f.jStorage="{}"}else f.jStorage="{}";h=f.jStorage?String(f.jStorage).length:0,e.__jstorage_meta||(e.__jstorage_meta={}),e.__jstorage_meta.CRC32||(e.__jstorage_meta.CRC32={})}function B(){G();try{f.jStorage=d.stringify(e),g&&(g.setAttribute("jStorage",f.jStorage),g.save("jStorage")),h=f.jStorage?String(f.jStorage).length:0}catch(a){}}function C(a){if(!a||typeof a!="string"&&typeof a!="number")throw new TypeError("Key name must be string or numeric");if(a=="__jstorage_meta")throw new TypeError("Reserved key name");return!0}function D(){var a,b,c,d,f=Infinity,g=!1,h=[];clearTimeout(o);if(!e.__jstorage_meta||typeof e.__jstorage_meta.TTL!="object")return;a=+(new Date),c=e.__jstorage_meta.TTL,d=e.__jstorage_meta.CRC32;for(b in c)c.hasOwnProperty(b)&&(c[b]<=a?(delete c[b],delete d[b],delete e[b],g=!0,h.push(b)):c[b]<f&&(f=c[b]));f!=Infinity&&(o=setTimeout(D,f-a)),g&&(B(),z(),y(h,"deleted"))}function E(){if(!e.__jstorage_meta.PubSub)return;var a,b=n;for(var c=len=e.__jstorage_meta.PubSub.length-1;c>=0;c--)a=e.__jstorage_meta.PubSub[c],a[0]>n&&(b=a[0],F(a[1],a[2]));n=b}function F(a,b){if(m[a])for(var c=0,e=m[a].length;c<e;c++)m[a][c](a,d.parse(d.stringify(b)))}function G(){if(!e.__jstorage_meta.PubSub)return;var a=+(new Date)-2e3;for(var b=0,c=e.__jstorage_meta.PubSub.length;b<c;b++)if(e.__jstorage_meta.PubSub[b][0]<=a){e.__jstorage_meta.PubSub.splice(b,e.__jstorage_meta.PubSub.length-b);break}e.__jstorage_meta.PubSub.length||delete e.__jstorage_meta.PubSub}function H(a,b){e.__jstorage_meta||(e.__jstorage_meta={}),e.__jstorage_meta.PubSub||(e.__jstorage_meta.PubSub=[]),e.__jstorage_meta.PubSub.unshift([+(new Date),a,b]),B(),z()}function I(a,b){b=b||0;var c=0,d=0;b^=-1;for(var e=0,f=a.length;e<f;e++)c=(b^a.charCodeAt(e))&255,d="0x"+p.substr(c*9,8),b=b>>>8^d;return b^-1}var b="0.3.0",c=window.jQuery||window.$||(window.$={}),d={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&function(a){return String(a).evalJSON()}||c.parseJSON||c.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||c.toJSON};if(!d.parse||!d.stringify)throw new Error("No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page");var e={},f={jStorage:"{}"},g=null,h=0,i=!1,j={},k=!1,l=0,m={},n=+(new Date),o,p="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D",q={isXML:function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1},encode:function(a){if(!this.isXML(a))return!1;try{return(new XMLSerializer).serializeToString(a)}catch(b){try{return a.xml}catch(c){}}return!1},decode:function(a){var b="DOMParser"in window&&(new DOMParser).parseFromString||window.ActiveXObject&&function(a){var b=new ActiveXObject("Microsoft.XMLDOM");return b.async="false",b.loadXML(a),b},c;return b?(c=b.call("DOMParser"in window&&new DOMParser||window,a,"text/xml"),this.isXML(c)?c:!1):!1}},r=function(){};a={version:b,set:function(a,b,c){C(a),c=c||{};if(typeof b=="undefined")return this.deleteKey(a),b;if(q.isXML(b))b={_is_xml:!0,xml:q.encode(b)};else{if(typeof b=="function")return undefined;b&&typeof b=="object"&&(b=d.parse(d.stringify(b)))}return e[a]=b,e.__jstorage_meta.CRC32[a]=I(d.stringify(b)),this.setTTL(a,c.TTL||0),r(a,b),y(a,"updated"),b},get:function(a,b){return C(a),a in e?e[a]&&typeof e[a]=="object"&&e[a]._is_xml&&e[a]._is_xml?q.decode(e[a].xml):e[a]:typeof b=="undefined"?null:b},deleteKey:function(a){return C(a),a in e?(delete e[a],typeof e.__jstorage_meta.TTL=="object"&&a in e.__jstorage_meta.TTL&&delete e.__jstorage_meta.TTL[a],delete e.__jstorage_meta.CRC32[a],r(a,undefined),B(),z(),y(a,"deleted"),!0):!1},setTTL:function(a,b){var c=+(new Date);return C(a),b=Number(b)||0,a in e?(e.__jstorage_meta.TTL||(e.__jstorage_meta.TTL={}),b>0?e.__jstorage_meta.TTL[a]=c+b:delete e.__jstorage_meta.TTL[a],B(),D(),z(),!0):!1},getTTL:function(a){var b=+(new Date),c;return C(a),a in e&&e.__jstorage_meta.TTL&&e.__jstorage_meta.TTL[a]?(c=e.__jstorage_meta.TTL[a]-b,c||0):0},flush:function(){return e={__jstorage_meta:{CRC32:{}}},t("local",!0),B(),z(),y(null,"flushed"),!0},storageObj:function(){function a(){}return a.prototype=e,new a},index:function(){var a=[],b;for(b in e)e.hasOwnProperty(b)&&b!="__jstorage_meta"&&a.push(b);return a},storageSize:function(){return h},currentBackend:function(){return i},storageAvailable:function(){return!!i},listenKeyChange:function(a,b){C(a),j[a]||(j[a]=[]),j[a].push(b)},stopListening:function(a,b){C(a);if(!j[a])return;if(!b){delete j[a];return}for(var c=j[a].length-1;c>=0;c--)j[a][c]==b&&j[a].splice(c,1)},subscribe:function(a,b){a=(a||"").toString();if(!a)throw new TypeError("Channel not defined");m[a]||(m[a]=[]),m[a].push(b)},publish:function(a,b){a=(a||"").toString();if(!a)throw new TypeError("Channel not defined");H(a,b)},reInit:function(){u()}},s()}(),a}),define("keychainstorage",["jstorage"],function(a){function e(){return{rows:function(){function d(a,b){var c;return b>=0&&b<a.length&&(c=a[b]),c}var a=[],b=[],c=0;return{length:0,rowCount:function(){return a.length},item:function(b){return d(a,b)},id:function(a){return d(b,a)},push:function(d,e){b.push(d),a.push(e),c+=1,this.length=c}}}()}}function f(a,b,c){return{application:a,user:b,key:c}}function g(b){var c,d,e;if(b&&b.rows){c=b.rows.rowCount();for(d=0;d<c;d+=1)e=b.rows.id(d),a.deleteKey(e.toString())}}function h(b){var c=e(),d=a.index(),f=d.length,g,h,i,j;for(h=0;h<f;h+=1)g=d[h],i=a.get(g.toString()),j=!0,b&&typeof b=="function"&&(j=b(i)),j&&c.rows.push(g,i);return c}var b,c=1,d={version:"1.0"};return d.databaseSupported=function(){return b===undefined&&(b=a?a.storageAvailable():!1),b},d.initDatabase=function(){var b,e;if(!d.databaseSupported())return;b=a.index(),e=Math.max.apply(Math,b),c=e<0?0:1*e+1},d.updateEntryById=function(b,c,e,g){if(!d.databaseSupported())return;a.set(b.toString(),f(c,e,g))},d.createEntry=function(a,b,e){if(!d.databaseSupported())return-1;d.updateEntryById(c,a,b,e);var f=d.selectById(c);return f.row!==0?(c+=1,c-1):-1},d.selectByUsername=function(a){if(!d.databaseSupported())return e();var b=h(function(b){return b.user===a});return b},d.selectById=function(b){var c=e(),f;return d.databaseSupported()&&(f=a.get(b.toString()),f!==undefined&&c.rows.push(b,f)),c},d.selectByKey=function(a){var b=e();return d.databaseSupported()&&(b=h(function(b){return b.key===a})),b},d.selectByApplication=function(a){var b=e();return d.databaseSupported()&&(b=h(function(b){return b.application===a})),b},d.selectAll=function(){var a=e();return d.databaseSupported()&&(a=h(function(){return!0})),a},d.updateEntryByKey=function(b,c,e,g){if(!d.databaseSupported())return;var h=d.selectByKey(b);h.rows.rowCount()>0&&a.set(h.rows.id(0).toString(),f(c,e,g))},d.deleteEntriesByUsername=function(a){if(!d.databaseSupported())return;var b=d.selectByUsername(a);g(b)},d.deleteEntriesByKey=function(a){if(!d.databaseSupported())return;var b=d.selectByKey(a);g(b)},d.deleteEntriesById=function(a){if(!d.databaseSupported())return;var b=d.selectById(a);g(b)},d.deleteEntriesByApplication=function(a){if(!d.databaseSupported())return;var b=d.selectByApplication(a);g(b)},d.deleteAllEntries=function(){if(!d.databaseSupported())return;var a=d.selectAll();g(a)},d.getEntryCount=function(){var a=d.selectAll();return a.rows.length},d.initDatabase(),d}),function(a){typeof define=="function"&&define.amd?define("jquery-outside-events-plugin",["jquery"],a):a(jQuery)}(function(a,b,c){function d(d,e){function h(b){a(f).each(function(){var c=a(this);this!==b.target&&!c.has(b.target).length&&c.triggerHandler(e,[b.target])})}e=e||d+c;var f=a(),g=d+"."+e+"-special-event";a.event.special[e]={setup:function(){f=f.add(this),f.length===1&&a(b).bind(g,h)},teardown:function(){f=f.not(this),f.length===0&&a(b).unbind(g)},add:function(a){var b=a.handler;a.handler=function(a,c){a.target=c,b.apply(this,arguments)}}}}"$:nomunge",b=b||document,c=c||"outside",a.map("click dblclick mousemove mousedown mouseup mouseover mouseout change select submit keydown keypress keyup".split(" "),function(a){d(a)}),d("focusin","focus"+c),d("focusout","blur"+c),a.addOutsideEvent=d}),define("keepalive",[],function(){var a={},b=3e5;return a.startKeepAlives=function(a){return setInterval(a,b)},a.stopKeepAlives=function(a){a!==undefined&&clearInterval(a)},a}),define("events/eventdatafactory",[],function(){function a(a,b){return{id:a,ref:b}}return{createInstance:a}}),define("tooltiptypes",[],function(){var a={None:0,EachCell:1,EachRow:2,EachColumn:3,WholeObject:4};return a}),define("tooltip",["tooltiptypes"],function(a){var b={},c=2;return b.toolTipStringForObject=function(a){return a.Elements[c]&&a.Elements[c].ToolTip?a.Elements[c].ToolTip:""},b.toolTipStringForRow=function(a,b){var d=c+b;return a.Elements[d]&&a.Elements[d].ToolTip?a.Elements[d].ToolTip:""},b.toolTipStringForColumn=function(a,b){var d=c+b;return a.Elements[d]&&a.Elements[d].ToolTip?a.Elements[d].ToolTip:""},b.toolTipStringForCell=function(a,b,d){var e=c+(b*a.Elements[0].NumCols+d);return a.Elements[e]&&a.Elements[e].ToolTip?a.Elements[e].ToolTip:""},b}),define("dmfieldtypes",[],function(){var a={VEmpty:"0",VDouble:"1",VChar:"2",VTime:"5",VImage:"6",VError:"11",VBlob:"12",VSAP:"20",VRTF:"22",VLink:"28",VEnterprise:"32",VEmfDib:"35",VMetadata:"38",VHTML:"39"};return a}),define("htmltemplates",[],function(){var a={},b={};return a.flatMenu='<div class="dynaMenu arcDraggable"><div class="arcHierPopup"><div class="arcHierPopupSelectionOverflowContainer"><div class="arcHierPopupSelection"></div></div></div><div style="z-index: auto;" class="arcPopupContent arcHierPopupContent"><div class="arcMenu"><ul></ul></div></div></div>',a.flatMenuNative='<div class="dynaMenu arcDraggable"><div class="arcHierPopup"><div class="arcHierPopupSelectionOverflowContainer"><div class="arcHierPopupSelection"></div></div></div><select class="arcMenu arcPopupContent"></select></div>',a.hierMenu='<div class="dynaHierMenu arcDraggable"><div class="arcHierPopup"><div class="arcHierPopupSelectionOverflowContainer"><div class="arcHierPopupSelection"></div></div></div><div style="z-index: auto;" class="arcHierPopupContent"><div class="arcHierPopupInnerDiv" style="position:relative;overflow-y:auto;overflow-x:hidden;border-style:none;top:0px;left:0px;width:100%;"><div style="position:relative;overflow:hidden;border-style:none;top:0px;left:0px;"><div class="arcHier arcVert arcTree"><ol></ol></div></div></div><div class="arcHierPopupDlgContainer"><div style="background-color: rgb(255, 255, 255); visibility: hidden;" class="arcHierPopupDlg"><input type="button" value="Cancel" name="cancel"><input type="button" value="OK" name="ok" disabled="disabled"></div></div></div></div>',a.checkBox='<div class="dynaCheckbox" style="z-index:{z-index}; {borderDivStyle}" {title}><div class="dynaCheckbox" style="left: 0px; top: 0px; position: relative;"><div class="dynaCheckbox" style="left: 0px; top: 0px; position: relative;"><table class="dynaTable dynaCheckbox" cellspacing="0" style="left: 0px; top: 0px; position: relative; border-collapse: separate; {tableStyle}"><tbody></tbody></table></div></div></div>',a.radioButton='<div class="dynaRadio" style="z-index:{z-index};" {title}><div class="dynaRadio" style="left: 0px; top: 0px; position: relative;"><div class="dynaRadio" style="left: 0px; top: 0px; position: relative;"><table class="dynaRadio {tableClass}" style="left: 0px; top: 0px; position: relative; border-collapse: separate;"><tbody></tbody></table></div></div></div>',b.getHtmlTemplate=function(b){return a[b]},b}),define("viewupdater",[],function(){function b(a,b,c){var d=c.split("/"),e=d.length,f,g,h,i;for(i in a)if(a.hasOwnProperty(i)){g=a[i],h=b;if(typeof g=="object"){for(f=0;f<e-1;f+=1)g.hasOwnProperty(d[f])&&h.hasOwnProperty(d[f])&&(h=h[d[f]],g=g[d[f]]);g[d[e-1]]=h[d[e-1]]}}}function c(a,c){var d={BaseProperties:c};b(a,d,"BaseProperties/Position/XPos"),b(a,d,"BaseProperties/Position/YPos")}function d(a,c){var d={BaseProperties:c};b(a,d,"BaseProperties/Width/Value")}function e(a,c){var d={BaseProperties:c};b(a,d,"BaseProperties/Height/Value")}function f(a,c){var d={BaseProperties:c};b(a,d,"BaseProperties/Export")}function g(a,c){var d={BaseProperties:c};b(a,d,"BaseProperties/ViewAvailability")}function h(a,c){var d={BaseProperties:c};b(a,d,"BaseProperties/Layout")}function i(a,c){var d={ObjectProperties:c};b(a,d,"ObjectProperties/ColumnWidth/Elements")}function j(a,c){var d={ObjectProperties:c};b(a,d,"ObjectProperties/VScrollbarAllowed/Value")}function k(a,c){var d={ObjectProperties:c};b(a,d,"ObjectProperties/HScrollbarAllowed/Value")}function l(a,b){}function m(a,b){}function n(a,c){var d={ObjectProperties:c};b(a,d,"ObjectProperties/VertScrollDependencies/Elements")}function o(a,c){var d={ObjectProperties:c};b(a,d,"ObjectProperties/HoriScrollDependencies/Elements")}var a={};return a.updateViewBaseProperties=function(a,b){c(a,b),d(a,b),e(a,b),f(a,b),g(a,b),h(a,b)},a.updateViewObjectProperties=function(a,b){i(a,b),j(a,b),k(a,b),l(a,b),m(a,b),n(a,b),o(a,b)},a}),define("layoutbehavior",{EAdjustToAvailableSpace:0,EAdjustToContent:1,EAdjustToLayoutObject:2,EFixedSize:3,EFixedSizeAndPosition:4}),define("propertybuilder",[],function(){var a={};return a.buildProperties=function(a,b,c,d,e,f){var g=0,h=a.length,i,j,k,l,m,n,o=new RegExp("^[a-z|A-Z|0-9]*$");for(g=0;g<h;g+=1){m=a[g],n=m.property;if(o.test(n))j=m.prefix?m.prefix:"get",j+=n,i="set"+n,k="has"+n+"Changed",l="set"+n+"Changed",b[j]=d(n),b[i]=c(n),b[k]=f(n),b[l]=e(n),m.equalsMethod&&(b["are"+n+"sEqual"]=m.equalsMethod);else throw"No special characters allowed in property names."}},a}),define("properties",["layoutbehavior","propertybuilder","stringtools"],function(a,b,c){function g(a,b){e[a]=b}function h(a){return e[a]}function i(a,b){e[a]=b}function j(a,b,c){if(a&&a.length>0)if(c!==undefined)g(a[0].id+"_"+b,c);else return h(a[0].id+"_"+b)}function k(a,b){a&&a.length>0&&i(a[0].id+"_"+b)}function l(a,b,c){if(c===undefined)k(a,b);else{var e={value:c,changed:!1},f,g,h;typeof j(a,b)!="undefined"?(e.changed=j(a,b).changed,f=j(a,b).value,typeof f=="object"?(g="are"+b+"sEqual",h=d[g],h&&(e.changed=!h(f,c)||e.changed)):e.changed=f!==c||e.changed):e.changed=!0,j(a,b,e)}}function m(a,b){var c=j(a,b);return c?c.value:c}function n(a,b){var c=j(a,b);return c?c.changed:!0}function o(a,b,c){var d=j(a,b);d&&(d.changed=c)}function p(a){return function(b,c){return l(b,a,c)}}function q(a){return function(b){return m(b,a)}}function r(a){return function(b,c){return o(b,a,c)}}function s(a){return function(b){return n(b,a)}}var d={},e={},f=[{property:"DatavirtualizationProperties",prefix:undefined},{property:"Active",prefix:"is"},{property:"Visible",prefix:"is"},{property:"DocName",prefix:undefined},{property:"DocType",prefix:undefined},{property:"ID",prefix:undefined},{property:"ZIndex",prefix:undefined},{property:"ObjType",prefix:undefined},{property:"Pattern",prefix:undefined},{property:"SelectType",prefix:undefined},{property:"ShowIcons",prefix:undefined},{property:"SelectionPath",prefix:undefined},{property:"ShowRootNode",prefix:undefined},{property:"OneDimHasSumKnotLast",prefix:"is"},{property:"HierFormat",prefix:undefined},{property:"DimensionNumber",prefix:undefined},{property:"HTMLEditor",prefix:undefined},{property:"DocAutoCenter",prefix:"is"},{property:"Font",prefix:undefined,equalsMethod:function(a,b){var c,d,e;d=Object.keys(a),e=Object.keys(b),c=d.length===6&&e.length===6&&a.fontFamily===b.fontFamily&&a.fontSize===b.fontSize&&a.fontStyle===b.fontStyle&&a.fontWeight===b.fontWeight&&a.lineHeight===b.lineHeight&&a.textDecoration===b.textDecoration}},{property:"PopupFont",prefix:undefined},{property:"Fonts",prefix:undefined},{property:"VerticalAlignment",prefix:undefined},{property:"HorizontalAlignment",prefix:undefined},{property:"GridType",prefix:undefined},{property:"GridColor",prefix:undefined},{property:"BackgroundColor",prefix:undefined},{property:"BackgroundColor2",prefix:undefined},{property:"BackgroundColors",prefix:undefined},{property:"ForegroundColor",prefix:undefined},{property:"ForegroundColor2",prefix:undefined},{property:"ForegroundColors",prefix:undefined},{property:"Border",prefix:undefined},{property:"VScrollBarAllowed",prefix:undefined},{property:"HScrollBarAllowed",prefix:undefined},{property:"ScrollHeight",prefix:undefined},{property:"ScrollWidth",prefix:undefined},{property:"ScrollBarObjHori",prefix:undefined},{property:"ScrollBarObjVert",prefix:undefined},{property:"ScrollDeps",prefix:undefined},{property:"WasScrolled",prefix:undefined},{property:"ScrollX",prefix:undefined},{property:"ScrollY",prefix:undefined},{property:"ScrollElem",prefix:undefined},{property:"ScrollElemWidth",prefix:undefined},{property:"ScrollElemHeight",prefix:undefined},{property:"ScrollRefs",prefix:undefined},{property:"XSettingValue",prefix:undefined},{property:"YSettingValue",prefix:undefined},{property:"IScrollInstance",prefix:undefined},{property:"ScrollRequestId",prefix:undefined},{property:"ExtraScrollHeight",prefix:undefined},{property:"HotTrackingBackColor",prefix:undefined},{property:"HotTrackingFontColor",prefix:undefined},{property:"PopupGradientColorLeft",prefix:undefined},{property:"PopupGradientColorRight",prefix:undefined},{property:"HasDocActivateEvent",prefix:undefined},{property:"DocViews",prefix:undefined},{property:"DocCurrentView",prefix:undefined},{property:"DocInitialRect",prefix:undefined},{property:"DocLayoutManaged",prefix:"is"},{property:"DocLayoutObjectID",prefix:undefined},{property:"DocFixedSize",prefix:"has"},{property:"DocHeight",prefix:undefined},{property:"DocWidth",prefix:undefined},{property:"LayoutBehavior",prefix:undefined},{property:"XPos",prefix:undefined},{property:"YPos",prefix:undefined},{property:"Width",prefix:undefined},{property:"Height",prefix:undefined},{property:"NumRows",prefix:undefined},{property:"NumCols",prefix:undefined},{property:"RowHeight",prefix:undefined},{property:"ColumnWidth",prefix:undefined,equalsMethod:function(a,b){var c,d;if(typeof a!="object"||typeof b!="object")return!1;if(a.numCols!==b.numCols)return!1;if(a.Width!==b.Width)return!1;if(a.Elements||b.Elements){if(!a.Elements||!b.Elements)return!1;if(a.Elements.length!==b.Elements.length)return!1;c=a.Elements.length;for(d=0;d<c;d+=1)if(a.Elements[d].Width){if(!b.Elements[d].Width)return!1;if(a.Elements[d].Width!==b.Elements[d].Width)return!1}}return!0}},{property:"OrigXPos",prefix:undefined},{property:"OrigYPos",prefix:undefined},{property:"OrigWidth",prefix:undefined},{property:"OrigHeight",prefix:undefined},{property:"Resizeable",prefix:"is"},{property:"DocResizeLineMap",prefix:undefined},{property:"Content",prefix:undefined},{property:"BookmarkObject",prefix:"is"},{property:"LabelledByObjectID",prefix:undefined},{property:"HasClickEvent",prefix:undefined},{property:"HasInputEvent",prefix:undefined},{property:"IsEditable",prefix:undefined},{property:"IsPassword",prefix:undefined},{property:"ToolTip",prefix:undefined},{property:"ToolTipType",prefix:undefined},{property:"ShowTooltipMarker",prefix:undefined},{property:"SingleDropDownImageReference",prefix:undefined},{property:"MultiDropDownImageReference",prefix:undefined},{property:"DropDownSymbolWidth",prefix:undefined},{property:"DropDownSymbolHeight",prefix:undefined},{property:"WrapMode",prefix:undefined},{property:"MenuFilterEnabled",prefix:"is"},{property:"DisplayStyle",prefix:undefined},{property:"Organigram",prefix:"is"},{property:"AllowOpenClose",prefix:"is"},{property:"AvailableInView",prefix:"is"},{property:"FormattedTextInput",prefix:"is"},{property:"OrigSelectionPath",prefix:undefined},{property:"UseContentPaging",prefix:"is"},{property:"ContentWidth",prefix:undefined},{property:"VHTMLField",prefix:"is"},{property:"HtmlSource",prefix:undefined},{property:"LastSelectedItem",prefix:undefined},{property:"SelectedCell",prefix:undefined},{property:"DocSelectedObject",prefix:undefined}];return d.isSizeAdjustable=function(b){var c=parseInt(this.getLayoutBehavior(b),10);return c===a.EAdjustToLayoutObject?!0:c===a.EAdjustToContent?!0:c===a.EAdjustToAvailableSpace?!0:this.isResizeable(b)==="true"?!0:!1},d.isFixedSizeAndPosition=function(b){var c=parseInt(this.getLayoutBehavior(b),10);return c===a.EFixedSizeAndPosition?!0:!1},d.resetAllProperties=function(){e=[]},d.resetAllPropertiesForDocument=function(a){var b,d=new RegExp("Cont[0-9]*_"+c.encodeDocName(a)+"_[a-z|A-Z]*$");for(b in e)b.match(d)&&(e[b]=undefined)},b.buildProperties(f,d,p,q,r,s),d}),define("datavirtualizationhelper",["properties"],function(a){var b={};return b.getDatavirtualizationProperties=function(b){var c=a.getDatavirtualizationProperties(b);return typeof c!="object"&&(c={},a.setDatavirtualizationProperties(b,c)),c},b.isDatavirtualizationActiveForObject=function(b){return ARCPLAN.datavirtualization!==!1&&a.isVisible(b)===!0},b.convertScrollParams=function(a,b,c){a.height===c?(b.top=0,b.bottom=0):(b.top=(b.height-c)*a.top/(a.height-c),b.bottom=b.height-b.top-c)},b.validateScrollPos=function(b,c,d){var e;b.top>0&&b.top>b.height&&(e=a.getScrollElem(d),e&&(a.setScrollY(d,0),e[0].scrollTop=0),b.top=0,c.top=0)},b}),define("documentpositioner",["properties","stringtools"],function(a,b){function e(a,b){var c="<div class='arcOuterDocContainerForWidgetHosting'><div class='arcVerticalCenteredForWidgetHosting'><div class='arcInnerDocContainerForWidgetHosting'style='width: "+b.width+"px; "+"height: "+b.height+"px'>"+"</div>"+"</div>"+"</div>";a.wrap(c)}function f(a){return"arcContainerWrapper_"+a[0].id}function g(a,b,c){var d=f(a),e="<div class='arcDialogCenterOuter'> <div class='arcVerticalCentered'> <div id='"+d+"' class='arcHorizontalCentered'></div>"+"</div>"+"</div>",g,h={left:"0px",top:"0px",width:b+"px",height:c+"px"},i=$("#arcDialogCenter");i.length===0&&j(),$("#arcDialogCenter").append(e),g=$("#"+d),a.detach(),g.innerHtml="",g.append(a),g.css(h),$("#arcDialogCenter").css("display","block")}function h(a){var b=f(a),c=$("#arcDialogCenter"),d=$("#"+b,c),e=d.children(":last");e.length===1?(d.width(e.width()),d.height(e.height()),e.css("display","block"),c.css("display","block")):c.css("display","none")}function i(a){var b=$("#arcContainer");a.detach(),b.append(a),h(a)}function j(){var a="<div id='arcDialogCenter'></div>";$("#arcContainer").append(a)}var c={},d="3";return c.getDocContainer=function(a){var c=b.makeID(a,0);return $("#"+c)},c.createDocContainer=function(c){var d=b.makeID(c,0),e="#"+d,f=$(e);f.length===0&&($("#arcContainer").append("<div id='"+d+"' class='arcContainer'></div>"),f=$(e),a.setID(f,"0"),a.setDocName(f,c))},c.closeDocumentDialog=function(a){var c=$("#arcDialogCenter"),d=b.makeID(a,0),e="#arcContainerWrapper_"+d,f=$(e,c),g,h;h=f.closest(".arcDialogCenterOuter"),h.remove(),c.children(":last").length===0&&c.css("display","none")},c.setDocumentPositionAndSizeStylesInCssMap=function(a,b,c,e,f,g){if(f)e.position="absolute",e.left=-g.left+"px",e.top=-g.top+"px";else if(c){if(b.WorksheetType!=="Dialog"||c.CenterState!==d)c.PositionX>0&&(e.left=c.PositionX+"px"),c.PositionY>0&&(e.top=c.PositionY+"px");c.Width>0&&(e.width=c.Width+"px",e.overflow="auto"),c.Height>0&&(e.height=c.Height+"px",e.overflow="auto"),e.position="absolute"}},c.setDocumentPositionAndSizeInProperties=function(b,c,e,f,g,h,i){e?(a.setDocFixedSize(b,!0),a.setDocHeight(b,f.bottom-f.top),a.setDocWidth(b,f.right-f.left)):c&&(c.CenterState===d&&a.setDocAutoCenter(b,!0),c.Width>0?(a.setDocFixedSize(b,!0),a.setDocWidth(b,parseInt(c.Width,10))):a.setDocWidth(b,h-g.left),c.Height>0?(a.setDocFixedSize(b,!0),a.setDocHeight(b,parseInt(c.Height,10))):a.setDocHeight(b,i-g.top))},c.createDocumentDiv=function(a,b,f,h,i){var k;return c.createDocContainer(a),k=c.getDocContainer(a),f?e(k,b):h&&h.CenterState===d&&i==="Dialog"&&($("#arcDialogCenter").length===0&&j(k),g(k,h.Width,h.Height)),k},c.updateDocumentContainer=function(b,c){var e=f(b),h=b.parent()[0].id===e,j={left:"",top:"",width:"100%",height:"100%"};c.CenterState!==d&&h&&i(b),c.CenterState===d&&!h&&a.getDocType(b)==="Dialog"&&g(b,c.Width,c.Height),c.Width>0&&c.Height>0&&(c.PositionX>0&&(c.CenterState!==d||a.getDocType(b)!=="Dialog")&&(j.left=c.PositionX+"px"),c.PositionY>0&&(c.CenterState!==d||a.getDocType(b)!=="Dialog")&&(j.top=c.PositionY+"px"),j.width=c.Width+"px",j.height=c.Height+"px"),b.css(j)},c.getDocHeight=function(b){return a.getDocHeight(b)},c.getDocWidth=function(b){return a.getDocWidth(b)},c}),function(a){typeof define=="function"&&define.amd?define("jquery.simplemodal",["jquery"],a):a(jQuery)}(function(a){var b=[],c=a(document),d=a.browser.msie&&parseInt(a.browser.version)===6&&typeof window.XMLHttpRequest!="object",e=a.browser.msie&&parseInt(a.browser.version)===7,f=null,g=a(window),h=[];a.modal=function(b,c){return a.modal.impl.init(b,c)},a.modal.close=function(){a.modal.impl.close()},a.modal.focus=function(b){a.modal.impl.focus(b)},a.modal.setContainerDimensions=function(){a.modal.impl.setContainerDimensions()},a.modal.setPosition=function(){a.modal.impl.setPosition()},a.modal.update=function(b,c){a.modal.impl.update(b,c)},a.fn.modal=function(b){return a.modal.impl.init(this,b)},a.modal.defaults={appendTo:"body",focus:!0,opacity:15,overlayId:"simplemodal-overlay",overlayCss:{},containerId:"simplemodal-container",containerCss:{},dataId:"simplemodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:!1,autoPosition:!0,zIndex:1e3,close:!0,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"simplemodal-close",escClose:!0,overlayClose:!1,fixed:!0,position:null,persist:!1,modal:!0,onOpen:null,onShow:null,onClose:null,fadeInTime:600,fadeInDelay:0},a.modal.impl={d:{},init:function(b,c){var d=this;if(d.d.data)return!1;f=a.browser.msie&&!a.support.boxModel,d.o=a.extend({},a.modal.defaults,c),d.zIndex=d.o.zIndex,d.occb=!1;if(typeof b=="object")b=b instanceof a?b:a(b),d.d.placeholder=!1,b.parent().parent().size()>0&&(b.before(a("<span></span>").attr("id","simplemodal-placeholder").css({display:"none"})),d.d.placeholder=!0,d.display=b.css("display"),d.o.persist||(d.d.orig=b.clone(!0)));else if(typeof b=="string"||typeof b=="number")b=a("<div></div>").html(b);else return alert("SimpleModal Error: Unsupported data type: "+typeof b),d;return d.create(b),b=null,d.open(),a.isFunction(d.o.onShow)&&d.o.onShow.apply(d,[d.d]),d},create:function(b){var c=this;c.getDimensions(),c.o.modal&&d&&(c.d.iframe=a('<iframe src="javascript:false;"></iframe>').css(a.extend(c.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:h[0],width:h[1],zIndex:c.o.zIndex,top:0,left:0})).appendTo(c.o.appendTo)),c.d.overlay=a("<div></div>").attr("id",c.o.overlayId).addClass("simplemodal-overlay").css(a.extend(c.o.overlayCss,{display:"none",opacity:1e-4,height:c.o.modal?"100%":0,width:c.o.modal?"100%":0,position:"fixed",left:0,top:0,zIndex:c.o.zIndex+1})).appendTo(c.o.appendTo),c.d.container=a("<div></div>").attr("id",c.o.containerId).addClass("simplemodal-container").css(a.extend({position:c.o.fixed?"fixed":"absolute"},c.o.containerCss,{display:"none",zIndex:c.o.zIndex+2},{opacity:1e-4})).append(c.o.close&&c.o.closeHTML?a(c.o.closeHTML).addClass(c.o.closeClass):"").appendTo(c.o.appendTo),c.d.wrap=a("<div></div>").attr("tabIndex",-1).addClass("simplemodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(c.d.container),c.d.data=b.attr("id",b.attr("id")||c.o.dataId).addClass("simplemodal-data").css(a.extend(c.o.dataCss,{display:"none"})).appendTo("body"),b=null,c.setContainerDimensions(),c.d.data.appendTo(c.d.wrap),(d||f)&&c.fixIE(),setTimeout(function(){c&&c.d&&(c.d.container&&c.d.container.fadeTo(c.o.fadeInTime,1),c.d.overlay&&c.d.overlay.fadeTo(c.o.fadeInTime,c.o.opacity/100))},c.o.fadeInDelay)},bindEvents:function(){var b=this;a("."+b.o.closeClass).bind("click.simplemodal",function(a){a.preventDefault(),b.close()}),b.o.modal&&b.o.close&&b.o.overlayClose&&b.d.overlay.bind("click.simplemodal",function(a){a.preventDefault(),b.close()}),c.bind("keydown.simplemodal",function(a){b.o.modal&&a.keyCode===9?b.watchTab(a):b.o.close&&b.o.escClose&&a.keyCode===27&&(a.preventDefault(),b.close())}),g.bind("resize.simplemodal orientationchange.simplemodal",function(){b.getDimensions(),b.o.autoResize?b.setContainerDimensions():b.o.autoPosition&&b.setPosition(),d||f?b.fixIE():b.o.modal&&(b.d.iframe&&b.d.iframe.css({height:"100%",width:"100%"}),b.d.overlay.css({height:"100%",width:"100%"}))})},unbindEvents:function(){a("."+this.o.closeClass).unbind("click.simplemodal"),c.unbind("keydown.simplemodal"),g.unbind(".simplemodal"),this.d.overlay.unbind("click.simplemodal")},fixIE:function(){var b=this,c=b.o.position;a.each([b.d.iframe||null,b.o.modal?b.d.overlay:null,b.d.container.css("position")==="fixed"?b.d.container:null],function(a,b){if(b){var d="document.body.clientHeight",e="document.body.clientWidth",f="document.body.scrollHeight",g="document.body.scrollLeft",h="document.body.scrollTop",i="document.body.scrollWidth",j="document.documentElement.clientHeight",k="document.documentElement.clientWidth",l="document.documentElement.scrollLeft",m="document.documentElement.scrollTop",n=b[0].style;n.position="absolute";if(a<2)n.removeExpression("height"),n.removeExpression("width"),n.setExpression("height",""+f+" > "+d+" ? "+f+" : "+d+' + "px"'),n.setExpression("width",""+i+" > "+e+" ? "+i+" : "+e+' + "px"');else{var o,q;if(c&&c.constructor===Array){var r=c[0]?typeof c[0]=="number"?c[0].toString():c[0].replace(/px/,""):b.css("top").replace(/px/,"");o=r.indexOf("%")===-1?r+" + (t = "+m+" ? "+m+" : "+h+') + "px"':parseInt(r.replace(/%/,""))+" * (("+j+" || "+d+") / 100) + (t = "+m+" ? "+m+" : "+h+') + "px"';if(c[1]){var s=typeof c[1]=="number"?c[1].toString():c[1].replace(/px/,"");q=s.indexOf("%")===-1?s+" + (t = "+l+" ? "+l+" : "+g+') + "px"':parseInt(s.replace(/%/,""))+" * (("+k+" || "+e+") / 100) + (t = "+l+" ? "+l+" : "+g+') + "px"'}}else o="("+j+" || "+d+") / 2 - (this.offsetHeight / 2) + (t = "+m+" ? "+m+" : "+h+') + "px"',q="("+k+" || "+e+") / 2 - (this.offsetWidth / 2) + (t = "+l+" ? "+l+" : "+g+') + "px"';n.removeExpression("top"),n.removeExpression("left"),n.setExpression("top",o),n.setExpression("left",q)}}})},focus:function(b){var c=this,d=b&&a.inArray(b,["first","last"])!==-1?b:"first",e=a(":input:enabled:visible:"+d,c.d.wrap);setTimeout(function(){e.length>0?e.focus():c.d.wrap.focus()},10)},getDimensions:function(){var c=this,d=typeof window.innerHeight=="undefined"?g.height():window.innerHeight;b=[a(document).height(),a(document).width()],h=[a(window).height(),a(window).width()]},getVal:function(a,b){return a?typeof a=="number"?a:a==="auto"?0:a.indexOf("%")>0?parseInt(a.replace(/%/,""))/100*(b==="h"?h[0]:h[1]):parseInt(a.replace(/px/,"")):null},update:function(a,b){var c=this;if(!c.d.data)return!1;c.d.origHeight=c.getVal(a,"h"),c.d.origWidth=c.getVal(b,"w"),c.d.data.hide(),a&&c.d.container.css("height",a),b&&c.d.container.css("width",b),c.setContainerDimensions(),c.d.data.show(),c.o.focus&&c.focus(),c.unbindEvents(),c.bindEvents()},setContainerDimensions:function(){var b=this,c=d||e,f=b.d.origHeight?b.d.origHeight:a.browser.opera?b.d.container.height():b.getVal(c?b.d.container[0].currentStyle.height:b.d.container.css("height"),"h"),g=b.d.origWidth?b.d.origWidth:a.browser.opera?b.d.container.width():b.getVal(c?b.d.container[0].currentStyle.width:b.d.container.css("width"),"w"),i=b.d.data.outerHeight(!0),j=b.d.data.outerWidth(!0);b.d.origHeight=b.d.origHeight||f,b.d.origWidth=b.d.origWidth||g;var k=b.o.maxHeight?b.getVal(b.o.maxHeight,"h"):null,l=b.o.maxWidth?b.getVal(b.o.maxWidth,"w"):null,m=k&&k<h[0]?k:h[0],n=l&&l<h[1]?l:h[1],o=b.o.minHeight?b.getVal(b.o.minHeight,"h"):"auto";f?f=b.o.autoResize&&f>m?m:f<o?o:f:i?i>m?f=m:b.o.minHeight&&o!=="auto"&&i<o?f=o:f=i:f=o;var p=b.o.minWidth?b.getVal(b.o.minWidth,"w"):"auto";g?g=b.o.autoResize&&g>n?n:g<p?p:g:j?j>n?g=n:b.o.minWidth&&p!=="auto"&&j<p?g=p:g=j:g=p,b.d.container.css({height:f,width:"100%"}),b.d.wrap.css({overflow:i>f||j>g?"auto":"visible"}),b.o.autoPosition&&b.setPosition()},setPosition:function(){var a=this,b,c,d=h[0]/2-a.d.container.outerHeight(!0)/2,e=h[1]/2-a.d.container.outerWidth(!0)/2,f=a.d.container.css("position")!=="fixed"?g.scrollTop():0;a.o.position&&Object.prototype.toString.call(a.o.position)==="[object Array]"?(b=f+(a.o.position[0]||d),c=a.o.position[1]||e):(b=f+d,c=e),a.d.container.css({left:0,top:b})},watchTab:function(b){var c=this;if(a(b.target).parents(".simplemodal-container").length>0){c.inputs=a(":input:enabled:visible:first, :input:enabled:visible:last",c.d.data[0]);if(!b.shiftKey&&b.target===c.inputs[c.inputs.length-1]||b.shiftKey&&b.target===c.inputs[0]||c.inputs.length===0){b.preventDefault();var d=b.shiftKey?"last":"first";c.focus(d)}}else b.preventDefault(),c.focus()},open:function(){var b=this;b.d.iframe&&b.d.iframe.show(),a.isFunction(b.o.onOpen)?b.o.onOpen.apply(b,[b.d]):(b.d.overlay.show(),b.d.container.show(),b.d.data.show()),b.o.focus&&b.focus(),b.bindEvents()},close:function(){var b=this;if(!b.d.data)return!1;b.unbindEvents();if(a.isFunction(b.o.onClose)&&!b.occb)b.occb=!0,b.o.onClose.apply(b,[b.d]);else{if(b.d.placeholder){var c=a("#simplemodal-placeholder");b.o.persist?c.replaceWith(b.d.data.removeClass("simplemodal-data").css("display",b.display)):(b.d.data.hide().remove(),c.replaceWith(b.d.orig))}else b.d.data.hide().remove();b.d.container.hide().remove(),b.d.overlay.hide(),b.d.iframe&&b.d.iframe.hide().remove(),b.d.overlay.remove(),b.d={}}}}}),define("events/eventid",{EID_SWITCH:1,EID_CLICK:2,EID_OPENNODE:3,EID_CLOSENODE:4,EID_INPUT:5,EID_SWITCH_HIERPOPUP:6,EID_SELECTNODE:11,EID_MULTISELECTION:15,EID_OPENSTARTDOC:100,EID_SENDUSERPARAM:103,EID_SENDAPPLETPROPS:107,EID_DROP:115,EID_OPENBOOKMARK:117,EID_ONVIEWCHANGED:118,EID_DOCACTIVATE:104}),define("popupkeyeventhandler",["jquery","events/eventid","keycodes","properties"],function(a,b,c,d){function i(a,b){b.addClass(h),d.setLastSelectedItem(a,b)}function j(b){return a(".arcMenuItemSelected:first",b)}function k(a,b,c){b.removeClass(h),i(a,c)}function l(b,c){function o(a){return a+h<m.top?!0:!1}function p(a){return a>m.top+n?!0:!1}function q(){var b;return a("li",f).each(function(c){var d=a(this).offset().top-m.top;d<0&&(d*=-1);if(d<h/2)return b=a(this),!1}),b}function r(){var a=g.offset().top,b=g.next();if(o(a)||p(a))b=q();return b}function s(){var a=g.offset().top,b=g.prev();if(o(a)||p(a))b=q();return b}function t(){var a;g.length>0?(a=r(),a&&a.length>0&&(k(e,g,a),p(a.offset().top+h)&&f.scrollTop(l+h))):(a=q(),a&&i(e,a))}function u(){var a;g.length>0?(a=s(),a&&a.length>0&&(k(e,g,a),o(a.offset().top-h)&&f.scrollTop(l-h))):(a=q(),a&&i(e,a))}var e=b.data.ref,f=a(".arcPopupContent",e),g=j(f),h=d.getRowHeight(e),l=f.scrollTop(),m=f.offset(),n=f.height();b.preventDefault(),b.stopImmediatePropagation(),c?t():u()}function m(c){var e,h,i,k,l,m;c.data&&(e=c.data.ref,h=a(".arcPopupContent",e),i=j(h),i.length>0&&(k=parseInt(i.attr("value"),10),l=d.getDocName(e),m=d.getID(e),g(),f(l,m,b.EID_SWITCH,k)))}function n(a){switch(a.keyCode){case c.ESC:g();break;case c.UpArrow:l(a,!1);break;case c.DownArrow:l(a,!0);break;case c.Enter:m(a)}}var e={},f,g,h="arcMenuItemSelected";return e.setHideCurrentPopupCallback=function(a){g=a},e.setDoSendEventCallback=function(a){f=a},e.registerKeyEvents=function(b,c){a("body").on("keydown.popupkeyeventhandler",b,n)},e.unregisterKeyEvents=function(b){var c=a(".arcPopupContent",b);a("body").off("keydown.popupkeyeventhandler"),a(".arcMenuItem",c).removeClass(h),d.setLastSelectedItem(b,undefined)},e.resetSelectedItemInDOM=function(a){var b=d.getLastSelectedItem(a);b&&(b=a.find(".arcMenuItem[value='"+b.attr("value")+"']"),i(a,b))},e}),define("browserfeatures",[],function(){(function(){function a(a){return setTimeout(a,100)}var b=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||a;window.requestAnimationFrame=b})(),function(){function a(a){window.clearTimeout(a)}var b=window.cancelAnimationFrame||window.mozCancelAnimationFrame||a;window.cancelAnimationFrame=b}();var a={},b={svg:"http://www.w3.org/2000/svg"};return a.canUseInnerHTMLOnTable=function(){try{var a=$("<table><tbody></tbody></table>");return $("tbody",a)[0].innerHTML="<tr><td>funktioniert</td></tr>",$("tbody",a)[0].innerHTML==="<tr><td>funktioniert</td></tr>"?!0:!1}catch(b){return!1}}(),a.smil=!!document.createElementNS&&/SVGAnimate/.test(Object.prototype.toString.call(document.createElementNS(b.svg,"animate"))),a.touch="ontouchstart"in document.documentElement||window.navigator.msMaxTouchPoints>0,a.compatibilityMode=function(){if($.browser.msie){if(document.documentMode&&document.documentMode<9)return!0;if(parseInt($.browser.version,10)<9)return!0}return!1},a.clientLanguage=navigator.language||navigator.userLanguage,a.scrollbarWidth=window.orientation!==undefined?0:17,a.measureScrollbarWidth=function(){var a,b;return window.orientation!==undefined?b=0:(a=document.createElement("div"),a.style.width="100px",a.style.height="100px",a.style.overflow="scroll",a.style.position="absolute",a.style.top="-9999px",document.body.appendChild(a),b=a.offsetWidth-a.clientWidth,document.body.removeChild(a)),b},a.svg=function(){return!!document.createElementNS&&!!document.createElementNS(b.svg,"svg").createSVGRect}(),a.nativeTouchControls=a.touch&&window.orientation!==undefined,a.getDocumentScrollPosition=function(){return{left:$(document).scrollLeft(),top:$(document).scrollTop()}},a.getWindowSize=function(){return{width:$(window).width(),height:$(window).height()}},a.getDocumentSize=function(){return{width:$(document).width(),height:$(document).height()}},a.mobile=!0,navigator.userAgent.match(/iPhone/)?a.platformType="iPhone":navigator.userAgent.match(/iPad/)?a.platformType="iPad":navigator.userAgent.match(/Android/)?a.platformType="Android":navigator.userAgent.match(/Blackberry/)?a.platformType="Blackberry":navigator.userAgent.match(/PlayBook/)?a.platformType="PlayBook":navigator.userAgent.match(/Kindle/)?a.platformType="Kindle":navigator.userAgent.match(/Windows Phone/)?a.platformType="Windows Phone":(a.platformType="Desktop/Unknown",a.mobile=!1),a.c_DivSizeLimit=144e4,a}),define("ui",["nodetypes","properties","browserfeatures"],function(a,b,c){var d={};return d.getNodeInfo=function(a){var b,c,d={row:0,x:-1,y:-1};if(a){c=a.id||a.htmlFor;if(c){b=c.split("_");if(b.length>2)return d.row=parseInt(b[0],10),d.x=parseInt(b[1],10),d.y=parseInt(b[2],10),d}}return d},d.select=function(a){return a.select()},d.getCellPosition=function(a){var c=-1,e=-1,f=a,g=$(f),h=$(a).closest(".objContainer"),i=$(a).position(),j=b.getRowHeight(h),k,l=0;return a!==null&&a.tagName==="LI"&&a.childNodes?(f=d.getNodeInfo(f),{x:f.x,y:f.y}):(f!==null&&f.tagName==="TD"&&(c=g.index()),i!==null&&typeof i.top=="number"&&j&&(k=b.getDatavirtualizationProperties(h),k&&k.firstElementInDOM&&ARCPLAN.datavirtualization!==!1&&(l=k.firstElementInDOM),f!==null&&f.tagName==="TD"?e=g.closest("tr").index()+l:e=Math.round((i.top+.5)/j)+l),{x:c,y:e})},d.hasTargetObjectClickEvent=function(a){var d=!1,e,f,g=!1;if(a){e=$(a).closest(".objContainer"),f=b.getObjType(e);switch(f){case"Menu":case"RadioGroup":case"MenuHierarchie":c.nativeTouchControls||(g=!0);break;case"Switch":g=!0}if(b.getHasClickEvent(e)||g)d=!0}return d},d}),define("menufilter",["jquery","ui","keycodes","properties"],function(a,b,c,d){function g(a){var b=d.getDatavirtualizationProperties(a);b&&b.isFilterResult&&(b.isFilterResult=!1,b.allRows=b.prevAllRows,b.firstElementInDOM=b.prevFirstElementInDOM,b.lastElementInDOM=b.prevLastElementInDOM,d.setNumRows(a,b.oriNumRows),d.setDatavirtualizationProperties(a,b))}function h(b){var c=a(b.currentTarget).val();c===""&&g(b.data.ref),e.requestMenuFilterResult(b.data.ref,c)}function i(b,c){var d=a("<div></div>",{"class":"arcMenuFilterInputContainer"}),e=a("<input></input>",{type:"text",id:f.constants.menuFilterInputId,value:c,"class":"arcMenuFilterInput"});return d.append(e),b.append(d),e}var e,f={constants:{menuFilterInputId:"arcMenuFilterTextInput"}};return require(["datavirtualization"],function(a){e=a}),f.removeFilterInput=function(a){var b,c,d;a&&a.length>0&&(c=a.find(".arcHierPopupSelectionOverflowContainer").first(),d=c.find("#"+f.constants.menuFilterInputId),d.length>0&&(d.off("input.menufilter",h),d.parent().remove(),b=c.find(".arcHierPopupSelection").first(),b.show(),g(a)))},f.showMenuFilterInput=function(c){var g=c.ref,j=d.getDatavirtualizationProperties(g),k=g.find(".arcHierPopupSelectionOverflowContainer"),l=k.find(".arcHierPopupSelection").first(),m=k.find("#"+f.constants.menuFilterInputId),n,o=d.getNumRows(g);if(m.length>0||o===0)return;j.oriNumRows=o,j.prevAllRows=a.extend(!0,{},j.allRows),j.prevFirstElementInDOM=a.extend(!0,{},j.firstElementInDOM),j.prevLastElementInDOM=a.extend(!0,{},j.lastElementInDOM),l.hide(),e.updatePosition(g),m=i(k,l.text()),b.select(m),m.on("input.menufilter",c,h)},f}),define("popuppositioner",["browserfeatures"],function(a){function d(b,c){return b>c?a.scrollbarWidth:0}function e(b,c){return b>c?a.scrollbarWidth:0}var b={},c=10;return b.getPopupPosition=function(b,f,g,h,i){function s(){var a,d,e=b-l.left,f=e+g,h=j.width-m-c;f>h&&(b>g?o=b-(g+c):(a=h-e,d=h-a-c,a>=d?q=a:(o=b-d,q=d)))}function t(){var a,b,d=f-l.top,e=d+h,g=j.height-c-i.top;e>g&&(f>h?p=f-h:(b=g-d,a=g-b-c,b>=a?r=b:(p=f-a,r=a)))}var j=a.getWindowSize(),k=a.getDocumentSize(),l=a.getDocumentScrollPosition(),m=d(k.width,j.width),n=e(k.height,j.height),o=b,p=f,q=g,r=h;return s(),t(),{left:o,top:p,width:q,height:r}},b.getMenuPopupPosition=function(b,e,f,g,h,i){function z(){var a,d,f=n.top,g=y+b.top-f-p,h=y+g-c,i=x+g+e.height,j;o=w?o:0,j=u-o-c,i>j&&(h>e.height?q=y-e.height:(d=j-(g+x),a=j-d-x-c,d>=a?t=d:(t=a,q=y-t)))}function A(){function d(){return t<e.height}var g=b.left-n.left-i.left,h=d()?a.scrollbarWidth:0,j=w?a.scrollbarWidth:0,l=v-c*2+j,m;s+=h,s=Math.min(l,s),m=g+s+r,m>l?(r-=m-l,r<-g+c&&(r=-g+c)):!f&&g-c<0&&(r=r-g+c,r>k&&(r=k))}var j=b.height,k=b.width,l=a.getWindowSize(),m=a.getDocumentSize(),n=a.getDocumentScrollPosition(),o=d(m.width,l.width),p=n.top-i.top<0?i.top-n.top:0,q=j,r=0,s=e.width,t=e.height,u=Math.min(h.height,l.height-p),v=Math.min(h.width,l.width),w,x,y;return f?(q=f.top-b.top+g.top,r=f.left-b.left+g.left,x=0,y=q):(x=j,y=0),w=n.top>0&&h.height+g.top+o>=m.height,z(),A(),{left:r,top:q,width:s,height:t}},b}),define("popupcalculator",["properties","popuppositioner"],function(a,b){function e(b){return a.getSelectType(b)==="HierMultiSelect"?!1:!0}function f(b,c,e,f){var g,h=2,i=e-h,j=$("#"+b[0].id+" .arcHierPopupContent");return ARCPLAN.datavirtualization!==!1&&(!f||a.isUseContentPaging(b))?a.getDatavirtualizationProperties(b).menuContentWidth:(c<d?(f&&j.find(".arcHierPopupInnerDiv").css("min-width",""),j.css({"min-width":"",top:"-1000px",left:"-1000px",height:50,display:"inline-block"}),$("ul:first",j).css("position","static"),g=j.width(),g===null&&(g=i),g=Math.max(i,g)):g=i,g)}function g(c,d,e,f){var g=$("#arcContainer"),i=g.offset(),j=c.parent(),k={width:a.getDocWidth(j),height:a.getDocHeight(j)},l=h(g,j);return b.getMenuPopupPosition(d,e,f,i,k,l)}function h(a,b){var c=$(".arcInnerDocContainerForWidgetHosting",a);return c.length>0&&b.attr("id")!=="arcFilterPanel"?c.offset():b.offset()}function i(b){var c=Math.round(a.getRowHeight(b)),d=a.getNumRows(b),e=c*d+1,h=b.find(".dynaMenu").offset(),i=parseInt(a.getWidth(b),10),j,k;return j={left:h.left,top:h.top,width:parseInt(a.getWidth(b),10),height:parseInt(a.getHeight(b),10)},i=f(b,d,j.width,!1),k={width:i,height:e},g(b,j,k)}function j(b,c){var h=0,i,j,k,l,m,n,o,p,q,r;return a.isUseContentPaging(b)?m=a.getNumRows(b):(o=$("#"+b[0].id+" .arcHier"),m=$("li",o).length),e(b)||(h=34),n=Math.round(a.getRowHeight(b)),p=c?165:parseInt(a.getWidth(b),10),j=m*n+1+h,i=f(b,m,p,!0),b.find(".dynaHierMenu").length>0&&(l=b.find(".dynaHierMenu").offset()),q={left:l?l.left:0,top:l?l.top:0,width:p,height:parseInt(a.getHeight(b),10)},r={width:i,height:j},k=g(b,q,r,c),k.childrenHeight=k.height-h,m>d&&!a.isUseContentPaging(b)&&(k.width="auto"),k}function k(c){var d=$("#arcContainer").offset(),e=a.getNumRows(c),f=a.getRowHeight(c),g=a.getXPos(c),h=a.getYPos(c),i,j,k,l=$("#"+c[0].id+" .arcHierPopupContent");return i=e*f,j=l.outerWidth(),k=b.getPopupPosition(g,h,j,i,d),k}var c={},d=100;return c.getPopupRect=function(b){var c=a.getObjType(b),d;return c==="Menu"?d=i(b):c==="MenuHierarchie"?d=j(b):d=k(b),d},c.getPopupRectByPos=function(b,c){var d,e=a.getObjType(b);return e==="MenuHierarchie"&&(d=j(b,c)),d},c}),define("animationfactory",[],function(){var a={};return a.createAnimation=function(a,b,c,d){function i(a,b,c){return(c-b)*a+b}function j(a,b,c){var d,e,f,g,h,j,k;return g=parseFloat(b.split(",")[0]),h=parseFloat(c.split(",")[0]),e=i(a,g,h),j=parseFloat(b.split(",")[1]),k=parseFloat(c.split(",")[1]),f=i(a,j,k),d=e+","+f,d}function k(a,b,c){var d=b.split(" "),e=c.split(" "),f,g=d.length,h="",i=0,k=0,l=0,m=0,n,o,p;for(f=0;f<g;f+=1)n=d[f],o=e[f],p=j(a,n,o),h+=p+" ";return h.trim(" ")}function l(a,b){var c=Math.floor((a.length-1)*b),d=Math.min(a.length-1,c+1),e,f,g,h,i;return d!==c?(e=c/(a.length-1),f=d/(a.length-1),g=f-e,h=(b-e)/g,i=k(h,a[c].trim(" "),a[d].trim(" ")),i):a[c]}function m(a,b){var c=Math.floor((a.length-1)*b),d=Math.min(a.length-1,c+1),e,f,g,h;return d!==c?(e=c/(a.length-1),f=d/(a.length-1),g=f-e,h=(b-e)/g,i(h,parseFloat(a[c]),parseFloat(a[d]))):parseFloat(a[c])}function n(a,b){switch(f){case"transform":return;case"points":return l(a,b);default:return m(a,b)}}function o(a){var b,c=!1,d;return a>=1&&(a=1,c=!0),b=g.split(";"),d=n(b,a),f==="opacity"?$(e).css(f,d):e.setAttribute(f,d),c?!0:!1}var e=a,f=b,g=c,h=d;return{setAnimationToFractionOfDuration:o}},a}),define("stringsen",{UNKNOWN_ERROR_TITLE:"Unknown error",UNKNOWN_ERROR:"An unknown error occured",ARCPLAN_SERVER_NOT_AVAILABLE:"The arcplan server is not available.",ARCPLAN_SERVER_EXCEPTION:"An exception occured on the server. Please restart.",CGI_ERROR_TITLE:"CGI error",NETWORK_ERROR_TITLE:"Network error",NETWORK_ERROR:"An error occured while contacting the server",CONFIGURATION_ERROR_TITLE:"Configuration error",PROTOCOL_MISMATCH:"Protocol mismatch for the cgi url",INTERNAL_ERROR_TITLE:"Internal error",INTERNAL_ERROR:"An internal error occured",DATA_ERROR_TITLE:"Data error",READING_SERVER_ANSWER_ERROR:"An error occured while reading the server answer",NO_SESSIONID:"The server returned no Session ID",NOTHML5_USAGE:"The usage of the HTML5 client is not allowed by the current license.",NOHTML5_MOBILEUSAGE:"The usage of the HTML5 client on mobile devices is not allowed by the current license.",NOMOBILE_CLIENT_LICENSE:"The usage of mobile devices is not allowed by the current license.",LICENCE_EXCEEDED:"The number of licensed concurrent users has currently been exceeded. Please contact your system administrator.",LICENCE_EXPIRED:"The arcplan license is invalid or has expired.",SESSION_END:"The connection was not used for some time. It was therefore terminated by the server. Please refresh the page.",WIDGET_OPEN_ANOTHER_DOCUMENT_QUESTION:"The application tries to navigate to another document. Do you want to open that document in a new window?",LICENCE_ERROR_TITLE:"License error",NOT_IMPLEMENTED_TITLE:"Not yet implemented",INFORMATION_TITLE:"Information",INFORMATION_TEXT:"This is an informational text.",SERVER_ERROR_TITLE:"Server error",SERVER_MESSAGE_TITLE:"Server message",NOTIMPLEMENTED_UNSERINFOSTYPE:"The Server sent an answer of a not implemented type:<br> {0}, {1}",COMPATIBILITY_WARNING:"Internet Explorer 9 mode is needed",COMPATIBILITY_WARNING_TITLE:"Compatibility Warning",CLIENT:"Client",WINDOWS_USER:"Windows User",ARCPLAN_USER:"arcplan User",USERNAME:"User name",PASSWORD:"Password",KEEP_LOGGEDIN:"Keep me logged in",OK:"Ok",CANCEL:"Cancel",YES:"Yes",NO:"No",LANGUAGE:"Language",LOGIN:"Login",USER_LOGIN:"User Login",UPLOAD_TITLE:"Upload File",UPLOAD_SELECT_FILE:"Please select file to upload: ",UPLOAD_IN_PROGRESS:"Upload in progress... ",UPLOAD_BROWSE:"Browse...",OPENLINK_TITLE:"Do you want to open this link in a new window?",OPENLINK_ALL_TITLE:"Do you want to open all links in a separate new window?",OPEN:"Open",DATA_ERROR_NO_BODY:"Data Error. The request contains no Data.",FILE_UPLOAD_FAILED:"File upload failed",SHOW_DETAILS:"Show details",PASSWORDNOTSAVED:"The password could not be saved.",NOT_FOR_PR_USAGE:"NOT FOR PRODUCTION USAGE",LICENSEDFOR:"Licensed Products",LICENSEOWNER:"License Owner: ",EVALUATIONVERSION:"Evaluation License",PARTNERVERSION:"Partner License",TESTORBACKUPVERSION:"Test / Backup License",ARCPLAN_MEMORY_OVERLOAD:"The session was canceled because the memory consumption was too high.",EMPTY_STRING:["",""]}),define("stringsde",{UNKNOWN_ERROR_TITLE:"Unbekannter Fehler",UNKNOWN_ERROR:"Ein unbekannter Fehler ist aufgetreten",ARCPLAN_SERVER_NOT_AVAILABLE:"Der arplan Server konnte nicht erreicht werden.",ARCPLAN_SERVER_EXCEPTION:"Auf dem Server ist ein Fehler aufgetreten. Bitte starten Sie neu.",CGI_ERROR_TITLE:"CGI-Fehler",NETWORK_ERROR_TITLE:"Netzwerkfehler",NETWORK_ERROR:"Bei der Verbindung zum arcplan Server ist ein Fehler aufgetreten.",CONFIGURATION_ERROR_TITLE:"Konfigurationsfehler",PROTOCOL_MISMATCH:"Das Protokoll fr die Cgi Url ist falsch",INTERNAL_ERROR_TITLE:"Interner Fehler",INTERNAL_ERROR:"Ein interner Fehler ist auftreten",DATA_ERROR_TITLE:"Datenfehler",READING_SERVER_ANSWER_ERROR:"Beim Lesen der Server-Antwort ist ein Fehler aufgetreten.",NO_SESSIONID:"Der Server lieferte keine Session ID",NOTHML5_USAGE:"Die aktuell verwendete Lizenz erlaubt nicht die Benutzung des Html5 Clients",NOHTML5_MOBILEUSAGE:"Die aktuell verwendete Lizenz erlaubt nicht die Benutzung des Html5 Clients auf mobilen Gerten",NOMOBILE_CLIENT_LICENSE:"Die aktuell verwendete Lizenz erlaubt nicht die Benutzung von mobilen Gerten.",LICENCE_EXCEEDED:"Die Anzahl lizenzierter gleichzeitiger Nutzer ist gegenwrtig berschritten. Bitte benachrichtigen Sie Ihren Systemadministrator.",LICENCE_EXPIRED:"Die Version des arcplan Application Servers ist ungltig oder abgelaufen.",SESSION_END:"Die Verbindung wurde lngere Zeit nicht benutzt. Die Verbindung wurde daher beendet. Bitte starten Sie neu.",WIDGET_OPEN_ANOTHER_DOCUMENT_QUESTION:"Die Applikation mchte zu einem anderen Dokument navigieren. Wollen Sie dieses nun in einem neuen Fenster anzeigen?",LICENCE_ERROR_TITLE:"Lizenzfehler",NOT_IMPLEMENTED_TITLE:"Noch nicht implementiert",INFORMATION_TITLE:"Information",INFORMATION_TEXT:"Das ist ein Informationstext.",SERVER_ERROR_TITLE:"Serverfehler",SERVER_MESSAGE_TITLE:"Servermeldung",NOTIMPLEMENTED_UNSERINFOSTYPE:"Der Server schickte eine nicht implementierte Antwort vom Typ:<br> {0}, {1}",COMPATIBILITY_WARNING:"Internet Explorer 9 ist erforderlich",COMPATIBILITY_WARNING_TITLE:"Kompatibilittswarnung",CLIENT:"Client",WINDOWS_USER:"Windows Benutzer",ARCPLAN_USER:"arcplan Benutzer",USERNAME:"Benutzername",PASSWORD:"Passwort",KEEP_LOGGEDIN:"Angemeldet bleiben",OK:"Ok",CANCEL:"Abbrechen",YES:"Ja",NO:"Nein",LANGUAGE:"Sprache",LOGIN:"Login",USER_LOGIN:"Benutzeranmeldung",UPLOAD_TITLE:"Datei hochladen",UPLOAD_SELECT_FILE:"Whlen Sie bitte eine Datei aus: ",UPLOAD_IN_PROGRESS:"Datei wird hochgeladen... ",UPLOAD_BROWSE:"Durchsuchen...",OPENLINK_TITLE:"Mchten Sie diesen Link in einem neuen Fenster ffnen?",OPENLINK_ALL_TITLE:"Mchten Sie jeden Link in einem neuen Fenster ffnen?",OPEN:"ffnen",DATA_ERROR_NO_BODY:"Datenfehler. Die Anfrage enthlt keine Daten.",FILE_UPLOAD_FAILED:"Hochladen der Datei fehlgeschlagen",SHOW_DETAILS:"Details anzeigen",PASSWORDNOTSAVED:"Das Passwort konnte nicht gespeichert werden.",NOT_FOR_PR_USAGE:"NICHT FR DEN PRODUKTIVEN EINSATZ",LICENSEDFOR:"Lizenzierte Produkte",LICENSEOWNER:"Lizenznehmer: ",EVALUATIONVERSION:"Evaluationslizenz",PARTNERVERSION:"Partner Lizenz",TESTORBACKUPVERSION:"Test- / Backup- Lizenz",ARCPLAN_MEMORY_OVERLOAD:"Die Sitzung wurde abgebrochen weil der Speicherbedarf zu gro war.",EMPTY_STRING:["",""]}),define("stringsres",["browserfeatures","require","stringsen","stringsde","stringtools"],function(a,b,c,d,e){var f={},g,h=!1;return f.parseStringsResourceFileContent=function(a){var b,c,d,e=a.match(/[^\r\n]+/g),f={};for(b=0;b<e.length;b+=1)c=e[b],d=c.split("|"),f[d[0]]=d[1];return f},f.loadCustomStringResources=function(a){var c;h===!1&&(c=b.toUrl("../res/strings."+a+".txt"),$.ajax({url:c,async:!1,type:"GET",success:function(a){g=f.parseStringsResourceFileContent(a)},error:function(a,b,d){window.console&&window.console.warn('Custom resource file not found "'+c+" "+a)}}),h=!0)},f.getMessageById=function(b,h){var i,j,k=ARCPLAN.language;k==="client"&&(k=e.browserLangToArcplanLang(a.clientLanguage)),k==="server"&&(k="en"),k=k?k.toLowerCase():"en",k!=="en"&&k!=="de"&&(g?j=g[b]:f.loadCustomStringResources(k));if(!j){k&&k.toLowerCase()==="de"?j=d[b]:j=c[b];if(!j)throw"Message id "+b+" does not exists"}if(h&&typeof h.length=="number")for(i=0;i<h.length;i+=1)j=j.replace("{"+i+"}",h[i]);return j},f.resetCustomStringResources=function(){g=undefined,h=!1},f}),define("stringsid",{UNKNOWN_ERROR_TITLE:"UNKNOWN_ERROR_TITLE",UNKNOWN_ERROR:"UNKNOWN_ERROR",ARCPLAN_SERVER_NOT_AVAILABLE:"ARCPLAN_SERVER_NOT_AVAILABLE",ARCPLAN_SERVER_EXCEPTION:"ARCPLAN_SERVER_EXCEPTION",CGI_ERROR_TITLE:"CGI_ERROR_TITLE",NETWORK_ERROR_TITLE:"NETWORK_ERROR_TITLE",NETWORK_ERROR:"NETWORK_ERROR",CONFIGURATION_ERROR_TITLE:"CONFIGURATION_ERROR_TITLE",PROTOCOL_MISMATCH:"PROTOCOL_MISMATCH",INTERNAL_ERROR_TITLE:"INTERNAL_ERROR_TITLE",INTERNAL_ERROR:"INTERNAL_ERROR",DATA_ERROR_TITLE:"DATA_ERROR_TITLE",READING_SERVER_ANSWER_ERROR:"READING_SERVER_ANSWER_ERROR",NO_SESSIONID:"NO_SESSIONID",NOTHML5_USAGE:"NOTHML5_USAGE",NOHTML5_MOBILEUSAGE:"NOHTML5_MOBILEUSAGE",NOMOBILE_CLIENT_LICENSE:"NOMOBILE_CLIENT_LICENSE",LICENCE_EXCEEDED:"LICENCE_EXCEEDED",LICENCE_EXPIRED:"LICENCE_EXPIRED",SESSION_END:"SESSION_END",WIDGET_OPEN_ANOTHER_DOCUMENT_QUESTION:"WIDGET_OPEN_ANOTHER_DOCUMENT_QUESTION",LICENCE_ERROR_TITLE:"LICENCE_ERROR_TITLE",NOT_IMPLEMENTED_TITLE:"NOT_IMPLEMENTED_TITLE",INFORMATION_TITLE:"INFORMATION_TITLE",INFORMATION_TEXT:"INFORMATION_TEXT",SERVER_ERROR_TITLE:"SERVER_ERROR_TITLE",SERVER_MESSAGE_TITLE:"SERVER_MESSAGE_TITLE",NOTIMPLEMENTED_UNSERINFOSTYPE:"NOTIMPLEMENTED_UNSERINFOSTYPE",COMPATIBILITY_WARNING:"COMPATIBILITY_WARNING",COMPATIBILITY_WARNING_TITLE:"COMPATIBILITY_WARNING_TITLE",CLIENT:"CLIENT",WINDOWS_USER:"WINDOWS_USER",ARCPLAN_USER:"ARCPLAN_USER",USERNAME:"USERNAME",PASSWORD:"PASSWORD",KEEP_LOGGEDIN:"KEEP_LOGGEDIN",OK:"OK",CANCEL:"CANCEL",YES:"YES",NO:"NO",LANGUAGE:"LANGUAGE",LOGIN:"LOGIN",USER_LOGIN:"USER_LOGIN",UPLOAD_TITLE:"UPLOAD_TITLE",UPLOAD_SELECT_FILE:"UPLOAD_SELECT_FILE",UPLOAD_IN_PROGRESS:"UPLOAD_IN_PROGRESS",UPLOAD_BROWSE:"UPLOAD_BROWSE",OPENLINK_TITLE:"OPENLINK_TITLE",OPENLINK_ALL_TITLE:"OPENLINK_ALL_TITLE",OPEN:"OPEN",DATA_ERROR_NO_BODY:"DATA_ERROR_NO_BODY",FILE_UPLOAD_FAILED:"FILE_UPLOAD_FAILED",SHOW_DETAILS:"SHOW_DETAILS",PASSWORDNOTSAVED:"PASSWORDNOTSAVED",NOT_FOR_PR_USAGE:"NOT_FOR_PR_USAGE",LICENSEDFOR:"LICENSEDFOR",LICENSEOWNER:"LICENSEOWNER",EVALUATIONVERSION:"EVALUATIONVERSION",PARTNERVERSION:"PARTNERVERSION",TESTORBACKUPVERSION:"TESTORBACKUPVERSION",ARCPLAN_MEMORY_OVERLOAD:"ARCPLAN_MEMORY_OVERLOAD",EMPTY_STRING:["",""]}),define("tools",["jquery","stringsres","stringsid"],function(a,b,c){function e(b,c){a.each(c,function(a,c){b(a,c)})}var d={};return d.formatError=function(a){var d={caption:b.getMessageById(c.UNKNOWN_ERROR_TITLE),text:b.getMessageById(c.UNKNOWN_ERROR),type:"error"},e={1722:b.getMessageById(c.ARCPLAN_SERVER_NOT_AVAILABLE)},f={51410:b.getMessageById(c.ARCPLAN_SERVER_EXCEPTION),6e4:b.getMessageById(c.ARCPLAN_MEMORY_OVERLOAD)},g={51300:b.getMessageById(c.SESSION_END)};return a.Type==="CgiError"&&(d.caption=b.getMessageById(c.CGI_ERROR_TITLE)),typeof a.Text=="string"&&(d.text=a.Text),a.ID&&e[a.ID]&&(d.text=e[a.ID]),typeof a=="string"&&f[a]&&(d.caption=b.getMessageById(c.SERVER_ERROR_TITLE),d.text=f[a]),typeof a=="string"&&g[a]&&(d.caption=b.getMessageById(c.SERVER_MESSAGE_TITLE),d.text=g[a],d.type="info"),d},d.hasAllProperties=function(a,b){var c;if(typeof a!="object")return!1;for(c=0;c<b.length;c+=1)if(!a.hasOwnProperty(b[c]))return!1;return!0},d.each=a.each,d.iterateArcplanArray=function(b,c){a.each(b.Elements,function(a,b){return e(c,b)})},d.toCamelCase=function(a){return a.replace(/-([a-z])/gi,function(a,b){return b.toUpperCase()})},d.toHTMLFont=function(a){var b={},c;return typeof a=="object"&&(b.fontFamily="'"+a.FaceName+"'",b.fontSize=""+Math.round(Math.abs(a.Height)*72/96)+"pt",b.lineHeight=Math.abs(a.Height),a.Height<0&&(b.lineHeight=b.lineHeight+2),b.lineHeight=b.lineHeight+"px",c=parseInt(a.Weight,10),c===400?b.fontWeight="normal":c===700?b.fontWeight="bold":b.fontWeight=c,parseInt(a.Italic,10)>0?b.fontStyle="italic":b.fontStyle="normal",b.textDecoration="none",a.Underline==="1"&&(b.textDecoration="underline"),a.StrikeOut==="1"&&(a.Underline==="1"?b.textDecoration="underline line-through":b.textDecoration="line-through")),b},d.timeToString=function(a){return""+("0"+a.getHours()).slice(-2)+":"+("0"+a.getMinutes()).slice(-2)+":"+("0"+a.getSeconds()).slice(-2)+"."+("00"+a.getMilliseconds()).slice(-3)},d.makeNodeID=function(a,b,c,d,e,f){var g=a+"_"+b+"_"+c+"_"+d+"_"+e;return f&&(g=g+"_"+f),g},d.mergeObjects=function(a,b){var c,d,e=arguments.length,f;if(e>1)for(d=1;d<e;d+=1){f=arguments[d];for(c in f)a[c]=f[c]}return a},d.camelCaseToStyleAttribute=function(a){return typeof a=="string"?a.replace(/([A-Z])/g,function(a,b){return"-"+b.toLowerCase()}):""},d.styleAsStringFromObject=function(a){var b,c=[];if(typeof a=="object")for(b in a)c.push(d.camelCaseToStyleAttribute(b)+":"+a[b]+";");return c.join("")},d}),define("components/button/buttondatatranslator",["assert/assert","tools"],function(a,b){function c(c){var d=!1;return typeof c=="object"&&typeof c.Events=="object"&&(a(c.Events.Elements instanceof Array),b.iterateArcplanArray(c.Events,function(a,b){b.Type==="OnClick"&&(d=!0)})),d}function d(a,b,c,d){a.onClickCallback=function(a,e){d.onClick(b,c.ObjID,a,e)}}function e(a,b,e){var f={content:b.ObjectData.value};return c(b.ObjectProperties)&&d(f,a,b,e),h(b,f),f}function f(a,b){return typeof a.ObjectData=="object"&&a.ObjectData.value!==b.content?(b.content=a.ObjectData.value,!0):!1}function g(a,b,e,f){var g=c(b.ObjectProperties),h=typeof e.onClickCallback=="function";return g!==h?(g?d(e,a,b,f):delete e.onClickCallback,!0):!1}function h(b,c){var d;a(typeof b.ObjectProperties=="object");if(typeof b.ObjectProperties.ForegroundColor=="object"){b.ObjectProperties.ForegroundColor.Transparency==="true"?d="transparent":d=b.ObjectProperties.ForegroundColor.TrueColor1;if(d!==c.fontColor)return c.fontColor=d,!0}return!1}function i(a,b,c,d){var e=!1;return f(b,c)&&(e=!0),typeof b.ObjectProperties=="object"&&(g(a,b,c,d)&&(e=!0),h(b,c)&&(e=!0)),e}return{createTranslator:function(b,c,d){a(typeof b=="string","docName parameter must be a string"),a(typeof c=="object","objNode parameter must be an object"),a(typeof c.ObjectData=="object","objNode.ObjectData must be an object"),a(typeof c.ObjectProperties=="object","objNode.ObjectProperties must be an object"),a(typeof d=="object","buttonEventcallbacks must be an object"),a(typeof d.onClick=="function","buttonEventCallbacks.onClick must be a function");var f=e(b,c,d);return{viewModel:f,updateViewModel:function(a){return i(b,a,f,d)}}}}}),define("requesttools",["stringtools","tools","jquery"],function(a,b,c){function e(c){var d="";return b.each(c,function(b,c){d+="<"+b+">",c!==null&&c!==undefined&&(typeof c=="object"?c.serialize&&typeof c.serialize=="function"?d+=c.serialize():d+=e(c):d+=a.escapeForXml(c)),d+="</"+b+">"}),d}function f(a){return"<"+a+' xmlns="http://schemas.arcplan.com/arcplan/clientCommunication">'+"<"+a+"Param>"}function g(a){return"</"+a+"Param>"+"</"+a+">"}var d={};return d.wrapBody=function(a,b){var c='<?xml version="1.0" encoding="UTF-8" standalone="no" ?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">';return a&&(c+="<soap:Header><ServerName>"+a+"</ServerName>"+"</soap:Header>"),c+="<soap:Body>"+b+"</soap:Body>"+"</soap:Envelope>",c},d.createSoapRequest=function(a,b,c){var h=f(a);return h+=e(b),h+=g(a),d.wrapBody(c,h)},d.createGetRequest=function(a,c,d,e){var f,g=c+"?ISINIT=%22"+d+"%22"+"&DYN="+a;return e&&b.each(e,function(a,b){g+="&"+a+"=",b!==undefined&&(g+=b)}),g+="    ",g},d.addSessionIdAndTokenToParams=function(a,c,d){var e={SessionID:c,SessionToken:d};return b.each(a,function(a,b){e[a]=b}),e},d.ajax=function(a){return c.ajax(a)},d.makeSynchronousGetRequest=function(a){var b=new XMLHttpRequest;b.open("GET",a,!1),b.send(null)},d}),define("hiernode",["tools"],function(a){function c(a){var b=a.children.length,d;for(d=0;d<b;d+=1)a.children[d].isSelected=!1,c(a.children[d])}function d(a,b){var c=0,d=a.length;for(c=0;c<d;c+=1)if(a[c].row>b)break;return c}function e(a,b){var c=b.row,e=d(a,c);a.splice(e,0,b)}function f(a,b){var c=0,d=a.length;for(c=0;c<d;c+=1)if(a[c].id===b)break;return c>=d?!1:c}function g(a,c,d){var g,h,i,j;if(!d)return c;if(!c)return d;g=c.length,h=d.length;for(i=0;i<h;i+=1)j=f(c,d[i].id),j!==!1?b.mergeNodes(c[j],d[i]):(d[i].parent=a,e(c,d[i]));return c}function h(a,b){j(a,b)}function i(a,b){var c,d=a.length;for(c=0;c<d;c+=1)j(a[c],b)}function j(a,b){typeof a.row=="number"&&a.row>=0&&typeof b[a.row]!="object"&&(b[a.row]=a),a.nextDim&&h(a.nextDim,b),a.children&&i(a.children,b)}var b={};return b.HierNode=function(a){this.Value=a,this.children=[],this.nextDim=undefined,this.host=undefined,this.row=-1,this.hasInput=!1,this.isOpen=!0,this.isSelected=!1,this.parent=undefined,this.id=undefined,this.dim=undefined,this.level=undefined,this.isFirstLevelOfDimension=!1},b.mergeNodes=function(a,c){return c?a?(a.children=g(a,a.children,c.children),a.nextDim=b.mergeNodes(a.nextDim,c.nextDim),a):c:a},b.getRowIndex=function(a){var b=[];return a&&j(a,b),b},b.deSelectDescendantsOfNode=function(a,d){if(a.id===d)c(a);else{var e=a.children.length,f;for(f=0;f<e;f+=1)b.deSelectDescendantsOfNode(a.children[f],d)}},b.findNodeByDomNodeID=function(a,c){if(a.id===c)return a;var d=a.children.length,e,f;for(e=0;e<d;e+=1){f=b.findNodeByDomNodeID(a.children[e],c);if(f)return f}},b.findNodeByID=function(a,c){var d=a.id?a.id.split("_"):[],e=a.children.length,f,g;if(d.length>4&&d[3]===c)return a;for(f=0;f<e;f+=1){g=b.findNodeByID(a.children[f],c);if(g)return g}},b.getAncestors=function(a,c){a&&a.parent&&(a.parent.Value&&c.push(a.parent),b.getAncestors(a.parent,c))},b}),define("menuhierarchyviewmodel",["hiernode","properties","tools"],function(a,b,c){function e(b,c){var d=[],e=a.findNodeByDomNodeID(b,c),f,g;a.getAncestors(e,d),f=d.length;for(g=0;g<f;g+=1)d[g].isSelected=!1}function f(a,b){var c;for(c=0;c<b;c+=1)if(a.Elements[c].VValue&&(c===b-1||!a.Elements[c+1].VValue))return a.Elements[c].VValue.v;return"noSelection"}function g(a,c){var d=b.getSelectionPath(a),e=parseInt(d.NumRows,10),g=parseInt(d.NumRows,10),h=parseInt(d.NumCols,10),i,j,k=0,l=m(c);for(i=e-1;i>=0;i-=1)j=d.Elements[i].Row,f(j,h)===l&&(k+=1,d.Elements.splice(i,1));g-=k,d.NumRows=g.toString()}function h(c,d){var e=[],f=b.getDatavirtualizationProperties(c),h=a.findNodeByDomNodeID(f.allRows.Root,d),i,j;a.getAncestors(h,e),j=e.length;for(i=0;i<j;i+=1)g(c,e[i].id)}function i(a){var c=b.getSelectionPath(a),d=parseInt(c.NumRows,10),e=parseInt(c.NumCols,10),f,g;for(f=d-1;f>=0;f-=1){g=c.Elements[f].Row;while(g.Elements.length<e)g.Elements.push({VValue:null})}}function j(c,d){var e=b.getSelectionPath(c),f=parseInt(e.NumRows,10),g=parseInt(e.NumCols,10),h=[],j=b.getDatavirtualizationProperties(c),k=a.findNodeByDomNodeID(j.allRows.Root,d),l,n,o={Row:{Elements:[]}};if(k){a.getAncestors(k,h),n=h.length;for(l=n-1;l>=0;l-=1)o.Row.Elements.push({VValue:{Type:"1",v:m(h[l].id)}});o.Row.Elements.push({VValue:{Type:"1",v:m(d)}});for(l=0;l<g-(n+1);l+=1)o.Row.Elements.push({VValue:null});f+=1,n+1>g&&(g=n+1,e.NumCols=g.toString(),i(c)),e.Elements.push(o),e.NumRows=f.toString()}}function k(a,b,c){var d;for(d=0;d<c-1;d+=1)if(a.Elements[d].VValue&&a.Elements[d].VValue.v===b&&a.Elements[d+1].VValue)return!0;return!1}function l(a,c,d){var e=b.getSelectionPath(a),f=parseInt(e.NumRows,10),g=parseInt(e.NumRows,10),h=parseInt(e.NumCols,10),i,j,l=0;for(i=f-1;i>=0;i-=1){j=e.Elements[i].Row;if(k(j,c,h)||d)l+=1,e.Elements.splice(i,1)}g-=l,e.NumRows=g.toString()}function m(a){var b=a.split("_");return b[3]}function n(b,c){var d=b.Root;a.deSelectDescendantsOfNode(d,c)}function o(b,c){var d=parseInt(c.NumRows,10),e=parseInt(c.NumRows,10),f=parseInt(c.NumCols,10),g,h,i,j=0,k;for(g=d-1;g>=0;g-=1){i=c.Elements[g].Row;for(h=0;h<f;h+=1)i.Elements[h].VValue&&i.Elements[h].VValue.v&&(k=a.findNodeByID(b,i.Elements[h].VValue.v),k&&(!i.Elements[h+1]||!i.Elements[h+1].VValue?k.isSelected=!0:k.hasChildrenSelected=!0))}}function p(a){var b=a.split("_");return b[1]==="0"}var d={};return d.deselectAncestors=function(a,c){var d,f;a&&c&&(d=m(c),f=b.getDatavirtualizationProperties(a),e(f.allRows.Root,c),h(a,d))},d.deselectDescendants=function(a,c){var d,e;a&&c&&(d=m(c),e=b.getDatavirtualizationProperties(a),n(e.allRows,c),l(a,d,p(c)))},d.selectNode=function(c,e){var f,g=b.getDatavirtualizationProperties(c),i;if(c&&e){f=m(e),h(c,e),i=a.findNodeByDomNodeID(g.allRows.Root,e);if(i){i.isSelected=!0;while(i.parent)i.parent.isSelected=!1,i=i.parent}d.deselectDescendants(c,e),j(c,e)}},d.deselectNode=function(c,d){var e,f=b.getDatavirtualizationProperties(c),h;c&&d&&(e=m(d),g(c,d),h=a.findNodeByDomNodeID(f.allRows.Root,d),h&&(h.isSelected=!1))},d.applySelectionsToHierarchy=function(c){var d=b.getDatavirtualizationProperties(c),e=b.getSelectionPath(c);d&&d.allRows&&d.allRows.Root&&a.deSelectDescendantsOfNode(d.allRows.Root,d.allRows.Root.id),e&&o(d.allRows.Root,e)},d.serializeSelection=function(){var a="",b=this,d=parseInt(this.NumCols,10);return c.iterateArcplanArray(b,function(b,c){var e;for(e=d-1;e>=0;e-=1)if(c.Elements[e].VValue)break;a=a+"<Row><nodeid>"+c.Elements[e].VValue.v+"</nodeid></Row>"}),a},d.setPopupVisible=function(a){var c=b.getDatavirtualizationProperties(a);$(".arcHier",a)[0].innerHTML=c.innerHTML},d.setPopupInvisible=function(a){$(".arcHier",a)[0].innerHTML=""},d}),define("htmltohiernodeparser",["hiernode"],function(a){function c(d,e,f){var g,h,i,j,k,l,m,n,o,p,q;q=$(".arcHier",e).hasClass("arcVertBeside")||$(".arcHier",e).hasClass("arcHoriBeside"),o=d.children("label:first"),o[0]?(m=new a.HierNode(o[0].textContent),m.isSelected=d.hasClass("arcHier-selected"),p=d.children("input:first"),m.isOpen=p[0].checked,m.hasInput=!0,m.id=p.attr("id")):(o=d.children("a:first"),m=new a.HierNode(o[0].textContent),m.isSelected=d.hasClass("arcHier-selected"),m.isOpen=!0,m.hasInput=!1,m.id=o.attr("id")),m.row=parseInt(m.id.split("_")[0],10)-1,n=m.id.split("_"),m.dim=parseInt(n[2],10),m.level=parseInt(n[1],10),f[0]=m.row,g=d.children("ol:first"),h=d.children("ul:first"),g.length>0&&(i=$(g[0]),m.nextDim=b.buildHierarchyDimension(i,e,f),m.nextDim.host=m);if(h.length>0){j=h.children("li"),l=j.length;for(k=0;k<l;k+=1)m.children[k]=c($(j[k]),e,f),m.children[k].parent=m}return m}var b={};return b.buildHierarchyDimension=function(b,d,e){var f=b.children("li"),g=f.length,h=new a.HierNode(""),i,j;h.row=e[0];for(j=0;j<g;j+=1)i=$(f[j]),h.children[j]=c(i,d,e),h.children[j].parent=h,h.children[j].isFirstLevelOfDimension=!0;return h},b}),define("propertytools",["tools","properties"],function(a,b){var c={};return c.getColumnFromScrollPos=function(c,d){var e=0,f,g=0,h=b.getColumnWidth(d);return c!==0&&h&&(h.width?(f=b.getColumnWidth(d).width,e=Math.round(c/f)):a.iterateArcplanArray(h,function(a,b){if(a==="Width"){g+=b;if(g<c)e+=1;else return!1}})),e},c.getScrollPosFromColumn=function(c,d){var e=0,f=0,g=b.getColumnWidth(d);return c!==0&&a.iterateArcplanArray(g,function(a,b){if(a==="Width"){if(f<c)e+=b;else return!1;f+=1}}),e},c.setVerticalAlignment=function(a,c){var d=b.getVerticalAlignment(a);switch(d){case"101":c.verticalAlign="middle";break;case"301":c.verticalAlign="bottom";break;case"401":c.verticalAlign="top"}},c.setHorizontalAlignment=function(a,c){var d=b.getHorizontalAlignment(a);switch(d){case"-1":c.textAlign="left";break;case"0":c.textAlign="center";break;case"1":c.textAlign="right"}},c.getLevelFromRowProp=function(a,b){var c=parseInt(a,10),d=99;return c>d&&(c=d),c===d&&b===!0&&(c=0),c},c.getAdjustedRowHeight=function(a,c){var d=c==="Row"?b.getHeight(a)-1:c==="Field"?b.getHeight(a)-2:Math.round(b.getRowHeight(a));switch(b.getGridType(a)){case"both":case"horizontal":if(c!=="Row")return d-1}return d},c.hasRowHoriScrollbar=function(c){var d=0,e=b.getColumnWidth(c);if(e){a.iterateArcplanArray(e,function(a,b){a==="Width"&&(d+=b)});if(e.numCols>1&&b.getHScrollBarAllowed(c)&&d>b.getWidth(c))return!0}return!1},c.hasColumnVertScrollbar=function(a){var c=b.getNumRows(a),d=b.getRowHeight(a),e=c*d,f=b.getHeight(a);return c>1&&b.getVScrollBarAllowed(a)&&e>f?!0:!1},c.getHierFormatByDim=function(a,c){var d=b.getHierFormat(a);return d&&d.length>=c?d[c-1]:{}},c}),define("scrollobserver",["tools","properties","propertytools"],function(a,b,c){function f(a,b){var c=0,d;if(a.numCols>0){d=a.Elements[0].Width;while(b>=d&&c<a.numCols)c+=1,c<a.numCols&&(d+=a.Elements[c].Width);return Math.min(c+1,a.numCols)}return-1}var d={},e=[];return d.addScrolledObject=function(a){b.getWasScrolled(a)||(e.push(a),b.setWasScrolled(a,!0))},d.getScrolledObjects=function(){var c=[];return a.each(e,function(a,d){var e=b.getScrollX(d),g=b.getScrollY(d),h=b.getColumnWidth(d),i=b.getRowHeight(d),j=Math.round(e/h.width+1),k=Math.round(g/i+1),l=b.getXSettingValue(d),m=b.getYSettingValue(d);isNaN(j)&&(j=f(h,e)),j===l&&(j=-1),k===m&&(k=-1),(j!==-1||k!==-1)&&c.push({ID:b.getID(d),Worksheet:b.getDocName(d),XSetting:j,YSetting:k})}),{scrollInfo:c,serialize:function(){var b="",c=this;return a.each(this.scrollInfo,function(a,c){b=b+"<Setting>"+"<ID>"+c.ID+"</ID>"+"<Worksheet>"+c.Worksheet+"</Worksheet>"+"<XSetting>"+Math.round(c.XSetting)+"</XSetting>"+"<YSetting>"+Math.round(c.YSetting)+"</YSetting>"+"</Setting>"}),b}}},d.clearScrolledObjects=function(){a.each(e,function(a,d){var e=b.getScrollX(d),f=b.getScrollY(d),g=b.getRowHeight(d),h=c.getColumnFromScrollPos(e,d),i=Math.round(f/g+1);h&&b.setXSettingValue(d,h),i&&b.setYSettingValue(d,i),b.setWasScrolled(d,!1)}),e=[]},d}),define("hierdatatohiernodeparser",["hiernode","tools"],function(a,b){function d(b,d,f){var g=new a.HierNode(b.value),h;return g.row=parseInt(b.r,10),g.id=b.nodeid,h=g.id.split("_"),g.dim=parseInt(h[2],10),g.level=parseInt(h[1],10),g.hasInput=b.Input==="true",g.isOpen=b.IsOpen==="true",g.isSelected=b.Selected==="true",typeof f!="undefined"&&(g.isFirstLevelOfDimension=f),d&&(g.parent=d),b.a&&(g.children=e(b.a,g)),b.Dimension&&(g.nextDim=c.buildHierarchyDimension(b.Dimension,g)),g}function e(a,c,e){var f=[];return b.iterateArcplanArray(a,function(a,b){f.push(d(b,c,e))}),f}var c={};return c.buildHierarchyDimension=function(b,c){var f=null;return b&&typeof b=="object"&&(typeof b.a!="undefined"||typeof b.Node!="undefined")&&(f=new a.HierNode(""),c?(f.host=c,f.dim=f.host.dim+1):f.dim=1,typeof b.a!="undefined"&&(f.children=e(b.a,f,!0)),typeof b.Node!="undefined"&&f.children.push(d(b.Node,f,!0))),f},c}),define("buttonhtmlgenerator",["properties","dmfieldtypes","tools"],function(a,b,c){function e(c,d){var e="",f="",g="lang='dynaIMG:"+c.hash+"' ";if(c.ScaleToObject||c.Type===b.VEmfDib)f="arcImgScaleAllways";return c.Image&&c.ImageType!=="noimage"&&(e="src='data:image/"+c.ImageType+";base64,"+c.Image+"' ",g=""),"<img class='"+f+"' "+"name='OBJ' "+g+"align='top' "+"data-origSize='"+c.Width+","+c.Height+"' "+"height='"+a.getHeight(d)+"px' "+"width='"+a.getWidth(d)+"px' "+e+"></img>"}var d={};return d.generateStub=function(b){var d=$("<div></div>"),e=$("<div></div>"),f=$("<div></div>"),g=$("<button></button>"),h=a.getObjType(b)==="Button"?"dynaButton":"dynaSwitch",i=a.getZIndex(b),j=a.getForegroundColor(b),k=a.getBackgroundColor(b),l=a.getFont(b),m,n=a.getPattern(b),o=n&&n.ImageReference;f.append(g),e.append(f),d.append(e),$("div",d).addClass(h),d.addClass(h),d.css("z-index",i),e.css({"z-index":i}),f.css("z-index",i+1),m={color:j,"background-color":o?"rgba(255, 255, 255, 0)":k,padding:"0px",position:"absolute"},c.mergeObjects(m,l),g.css(m),b[0].innerHTML=d[0].outerHTML},d.generateContent=function(a,c){var d=$("button",a),f;switch(c.Type){case b.VRTF:case b.VEmfDib:case b.VImage:case b.VBlob:f=e(c,a);break;case b.VHTML:case b.VEmpty:f="&nbsp;";break;case b.VDouble:case b.VChar:case b.VTime:case b.VError:case b.VSAP:case b.VLink:case b.VEnterprise:case b.VMetadata:f="<span style='overflow: hidden;position: relative;padding: 0px;margin: 0px;top: 0px;left: 0px;word-wrap: break-word;'>"+c.value.replace(/</g,"&#x003c;")+"</span>"}d[0].innerHTML=f},d}),define("objectpropertysetter",["properties","tools","propertytools","browserfeatures","stringtools","tooltiptypes"],function(a,b,c,d,e,f){function h(b,c){var d,e,f;c&&c.Symbol&&(d=c.Symbol.DropDownSymbolSingleSelection,e=c.Symbol.DropDownSymbolMultiSelection,e&&(typeof e.Width!="undefined"&&a.setDropDownSymbolWidth(b,parseInt(e.Width,10)),typeof e.Height!="undefined"&&a.setDropDownSymbolHeight(b,parseInt(e.Height,10)),e.ImageReference&&a.setMultiDropDownImageReference(b,e.ImageReference)),d&&(typeof d.Width!="undefined"&&a.setDropDownSymbolWidth(b,parseInt(d.Width,10)),typeof d.Height!="undefined"&&a.setDropDownSymbolHeight(b,parseInt(d.Height,10)),d.ImageReference&&a.setSingleDropDownImageReference(b,d.ImageReference)))}function i(c,d){var e=b.toHTMLFont(d.Font),f=d.LineSpacing.v*parseInt(e.lineHeight,10);a.setPopupFont(c,e),a.setRowHeight(c,f),a.setHotTrackingBackColor(c,d.HotTrackingBackColor.TrueColor),a.setHotTrackingFontColor(c,d.HotTrackingFontColor.TrueColor),a.setPopupGradientColorLeft(c,d.GradientColorLeft.TrueColor),a.setPopupGradientColorRight(c,d.GradientColorRight.TrueColor)}function j(a){var c=[];return a.Elements&&b.iterateArcplanArray(a,function(a,b){a==="Width"&&c.push(b)}),c}function k(a,b,c,d){var e=0;for(e=0;e<d;e+=1){if(e>=b)break;a[e]=c[e]}}function l(a,b){var c=0,d=0,e;if(a.Elements)for(e in a.Elements)a.Elements[e].Width&&(a.Elements[e].Width=b[d],c+=a.Elements[e].Width,d+=1);return c}function m(b,c){var d=a.getColumnWidth(b),e,f,h=[],i=[],m,n;e=g.getUnifiedColumnWidths(c),e&&d&&d&&d.Elements&&(e.numCols===d.numCols?d=e:(h=j(d),i=j(e),m=i.length,f=d.accumulatedColumnWidth,h.length>0&&(n=h.length,k(h,n,i,m),f=l(d,h)),d.Width=e.Width,d.accumulatedColumnWidth=f)),a.setColumnWidth(b,d)}function n(a){return a.HierProperties&&a.HierProperties.HierFormat&&a.HierProperties.HierFormat.Dimensions&&a.HierProperties.HierFormat.Dimensions.Elements&&a.HierProperties.HierFormat.Dimensions.Elements[0]&&a.HierProperties.HierFormat.Dimensions.Elements[0].Dimension?!0:!1}function o(a,b,d){var e=!1;n(a)&&a.HierProperties.HierFormat.Dimensions.Elements[0].Dimension.ShowMother==="true"&&(e=!0),b.sort(function(a,b){var f=c.getLevelFromRowProp(a[d].Range.Start.Row,e),g=c.getLevelFromRowProp(b[d].Range.Start.Row,e),h=parseInt(a[d].Range.Start.Column,10),i=parseInt(b[d].Range.Start.Column,10);return h-i===0?f-g:h-i})}function p(c,d,e){var f=[],g=0,h=!1,i=!1,j=!1;e&&e.Dimensions&&(b.iterateArcplanArray(e.Dimensions,function(a,b){g=parseInt(b.DimensionWidth,10),h=d==="VerticalHierarchie"&&g>-1&&b.SumStyle!=="ORGANIGRAM"?!0:!1,i=b.SumStyle==="SUM_LAST",f.push({isSumKnotLast:i,showRootNode:b.ShowMother==="true",dimensionWidth:g,canApplyDimensionWidth:h}),i&&(j=!0)}),a.setHierFormat(c,f),a.setDimensionNumber(c,f.length),d!=="HorizontalHierarchie"&&a.setOneDimHasSumKnotLast(c,j))}function q(b,c){b.VScrollbarAllowed&&a.setVScrollBarAllowed(c,b.VScrollbarAllowed.Value==="true"),b.HScrollbarAllowed&&a.setHScrollBarAllowed(c,b.HScrollbarAllowed.Value==="true")}var g={};return g.getUnifiedColumnWidths=function(a){var c,d=[],e=1,f;return a&&(a.Elements?(c=-1,f=0,b.iterateArcplanArray(a,function(a,b){a==="Width"?(b/=100,d.push({Width:b}),f+=b,b!==c&&(c===-1?c=b:c=undefined)):a==="NumCols"&&(e=parseInt(b,10))}),d.push({NumCols:e})):(c=parseInt(a.Width,10),f=c,a.NumCols&&a.NumCols>1&&(e=a.NumCols,f=e*c)),f=Math.floor(f)),{width:c,Elements:d,accumulatedColumnWidth:f,numCols:e}},g.setPropertiesByView=function(a,b){var c=$("#"+b);q(a,c),m(c,a.ColumnWidth)},g.setProperties=function(c,d,j){var k,l,m,n,r,s,t={},u=$("#"+d),v,w,x,y,z,A=a.getObjType(u);c.Pattern&&a.setPattern(u,c.Pattern),c.Grid&&(c.Grid.Type&&a.setGridType(u,c.Grid.Type),c.Grid.GridColor&&a.setGridColor(u,c.Grid.GridColor.TrueColor1)),c.BackgroundColor&&(c.BackgroundColor.Transparency==="true"?(a.setBackgroundColor(u,"rgba(255,255,255,0.01)"),A==="Menu"||A==="MenuHierarchie"?a.setBackgroundColor2(u,c.BackgroundColor.TrueColor2):a.setBackgroundColor2(u,undefined)):(a.setBackgroundColor(u,c.BackgroundColor.TrueColor1),a.setBackgroundColor2(u,c.BackgroundColor.TrueColor2))),c.BackgroundColors&&(c.BackgroundColors.Elements.length>0&&o(c,c.BackgroundColors.Elements,"BackgroundColor"),a.setBackgroundColors(u,c.BackgroundColors)),c.EditEnabled&&a.setIsEditable(u,c.EditEnabled==="true"&&a.isActive(u)),c.ForegroundColor&&(c.ForegroundColor.Transparency==="true"?a.setForegroundColor(u,"transparent"):a.setForegroundColor(u,c.ForegroundColor.TrueColor1),a.setForegroundColor2(u,c.ForegroundColor.TrueColor2)),c.ForegroundColors&&(c.ForegroundColors.Elements.length>0&&o(c,c.ForegroundColors.Elements,"ForegroundColor"),a.setForegroundColors(u,c.ForegroundColors));if(c.Font){n=b.toHTMLFont(c.Font);if(A==="Button"||A==="Switch")n.lineHeight=undefined;a.setFont(u,n)}c.Fonts&&(c.Fonts.Elements.length>0&&o(c,c.Fonts.Elements,"Font"),a.setFonts(u,c.Fonts)),c.Frame&&(t.top=c.Frame.Top==="true"?!0:!1,t.left=c.Frame.Left==="true"?!0:!1,t.right=c.Frame.Right==="true"?!0:!1,t.bottom=c.Frame.Bottom==="true"?!0:!1,t.type=c.Frame.Type,c.Frame.FrameColor.Transparency==="true"?t.color="transparent":t.color=c.Frame.FrameColor.TrueColor1),a.setBorder(u,t),a.setIsPassword(u,c.Password==="true");if(c.RowHeight){switch(A){case"Field":a.setRowHeight(u,c.RowHeight.Height/100-1);break;case"Row":a.setRowHeight(u,c.RowHeight.Height/100);break;case"MenuHierarchie":case"Menu":c.PopupProperties&&c.PopupProperties.LineSpacing?i(u,c.PopupProperties):a.setRowHeight(u,22),h(u,c),a.setMenuFilterEnabled(u,c.TypeDownFilterEnabled&&c.TypeDownFilterEnabled==="true");break;default:a.setRowHeight(u,c.RowHeight.Height/100)}c.RowHeight.NumRows&&a.setNumRows(u,parseInt(c.RowHeight.NumRows,10))}a.setColumnWidth(u,g.getUnifiedColumnWidths(c.ColumnWidth)),a.setShowIcons(u,!0),c.HierProperties&&c.HierProperties.HierFormat&&(c.HierProperties.HierFormat.DisplayStyle==="TREE_STYLE"&&c.HierProperties.HierFormat.Dimensions&&c.HierProperties.HierFormat.Dimensions.Elements&&c.HierProperties.HierFormat.Dimensions.Elements[0]&&c.HierProperties.HierFormat.Dimensions.Elements[0].Dimension&&c.HierProperties.HierFormat.Dimensions.Elements[0].Dimension.HideIcons!=="true"?a.setShowIcons(u,!0):a.setShowIcons(u,!1)),c.XSetting&&a.setXSettingValue(u,parseInt(c.XSetting.Value,10)),c.YSetting&&a.setYSettingValue(u,parseInt(c.YSetting.Value,10)),q(c,u);switch(A){case"MenuHierarchie":c.HierProperties&&c.HierProperties.HierFormat&&c.HierProperties.HierFormat.Dimensions&&c.HierProperties.HierFormat.Dimensions.Elements&&c.HierProperties.HierFormat.Dimensions.Elements[0]&&c.HierProperties.HierFormat.Dimensions.Elements[0].Dimension&&a.setSelectType(u,c.HierProperties.HierFormat.Dimensions.Elements[0].Dimension.SelectType),c.YSetting&&(a.getSelectType(u)!=="HierMultiSelect"||!a.getOrigSelectionPath(u))&&a.setSelectionPath(u,c.YSetting.Selections);break;case"VerticalHierarchie":case"HorizontalHierarchie":c.HierSelState&&c.HierSelState.Type&&a.setSelectType(u,c.HierSelState.Type),c.YSetting&&a.setSelectionPath(u,c.YSetting.Selections);break;case"Text":c.FormattedTextInput&&a.setFormattedTextInput(u,c.FormattedTextInput==="true")}switch(A){case"MenuHierarchie":case"VerticalHierarchie":case"HorizontalHierarchie":a.setShowRootNode(u,!1),c.HierProperties&&c.HierProperties.HierFormat&&(y=c.HierProperties.HierFormat,p(u,A,y),y.Dimensions&&y.Dimensions.Elements&&y.Dimensions.Elements[0]&&y.Dimensions.Elements[0].Dimension&&(z=y.Dimensions.Elements[0].Dimension,z.ShowMother==="true"&&a.setShowRootNode(u,!0),z.HideLines==="true"?a.setGridType(u,"none"):a.setGridType(u,"both"),z.AllowOpenClose==="false"&&a.setAllowOpenClose(u,!1)),y.DisplayStyle&&a.setDisplayStyle(u,y.DisplayStyle),y.Organigram&&a.setOrganigram(u,y.Organigram==="true"))}c.Invisible==="true"?(a.setVisible(u,!1),u.html("")):a.setVisible(u,!0),c.IsBookmarkObject==="true"?a.setBookmarkObject(u,!0):a.setBookmarkObject(u,!1),c.Label&&(r=a.getDocName(u),s=e.makeID(r,c.Label),a.setLabelledByObjectID(u,s)),a.setToolTip(u,c.ToolTip),c.ToolTip&&c.ToolTip.Elements&&c.ToolTip.Elements[0]&&c.ToolTip.Elements[1]?(w=c.ToolTip.Elements[0].NumCols,x=c.ToolTip.Elements[1].NumRows,w>1&&x>1?a.setToolTipType(u,f.EachCell):w>1?a.setToolTipType(u,f.EachColumn):x>1?a.setToolTipType(u,f.EachRow):a.setToolTipType(u,f.WholeObject)):a.setToolTipType(u,f.None),c.ShowTooltipMarker&&a.setShowTooltipMarker(u,c.ShowTooltipMarker.v==="true"),a.setWrapMode(u,c.WordWrap),c.HorizontalAlignment&&a.setHorizontalAlignment(u,c.HorizontalAlignment.Value),c.VerticalAlignment&&a.setVerticalAlignment(u,c.VerticalAlignment.Value)},g.setBaseProperties=function(c,d,e,f){var g=!1,h;if(typeof c!="object"||c===null)return;if(b.hasAllProperties(c,["Width","Height","Position","ViewAvailability"])&&c.Width.hasOwnProperty("Value")&&c.Height.hasOwnProperty("Value")&&b.hasAllProperties(c.Position,["XPos","YPos"])){a.setOrigWidth(d,Math.abs(c.Width.Value)),a.setOrigHeight(d,Math.abs(c.Height.Value));if(!e||!f)a.setWidth(d,Math.abs(c.Width.Value)),a.setHeight(d,Math.abs(c.Height.Value));if(c.Width.Value<0||c.Height.Value<0){a.setOrigXPos(d,Math.abs(c.Position.XPos)),a.setOrigYPos(d,Math.abs(c.Position.YPos));if(!e||!f)a.setXPos(d,Math.abs(c.Position.XPos)),a.setYPos(d,Math.abs(c.Position.YPos))}else{a.setOrigXPos(d,parseInt(c.Position.XPos,10)),a.setOrigYPos(d,parseInt(c.Position.YPos,10));if(!e||!f)a.setXPos(d,parseInt(c.Position.XPos,10)),a.setYPos(d,parseInt(c.Position.YPos,10))}a.setAvailableInView(d,c.ViewAvailability==="true")}return c.Layout!==undefined&&(e&&(h=a.getLayoutBehavior(d)),a.setLayoutBehavior(d,c.Layout),e&&(g=h!==a.getLayoutBehavior(d))),g},g.setScrollDependencies=function(c,d){var e={vert:[],hori:[]};c&&c.VertScrollDependencies&&b.iterateArcplanArray(c.VertScrollDependencies,function(a,b){b&&b.ID&&e.vert.push(b.ID)}),c&&c.HoriScrollDependencies&&b.iterateArcplanArray(c.HoriScrollDependencies,function(a,b){b&&b.ID&&e.hori.push(b.ID)}),e.vert.length>0||e.hori.length>0?a.setScrollDeps(d,e):a.setScrollDeps(d,undefined)},g}),define("logger",["tools"],function(a){var b={};return window.console?(b.log=function(b){window.console.log(a.timeToString(new Date)+"\t"+b)},b.error=function(b){window.console.error(a.timeToString(new Date)+"\t"+b)},b.info=function(b){window.console.info(a.timeToString(new Date)+"\t"+b)},b.warn=function(b){window.console.warn(a.timeToString(new Date)+"\t"+b)},b.debug=function(b){ARCPLAN.debug&&window.console.log(a.timeToString(new Date)+"\t"+b)}):(b.log=function(){},b.error=function(){},b.info=function(){},b.warn=function(){},b.debug=function(){}),b}),define("arcplanobjects/arcplanobjectsfactory",["components/containerbuilder/containerbuilder","tools","stringtools","logger"],function(a,b,c,d){function e(){function g(a,b){f[a]=b}function h(a,b,c){if(f.hasOwnProperty(b))return f[b].createArcplanObject(a,c)}function i(a,b){return a+b}function j(a,b){var c=i(a,b);return e.hasOwnProperty(c)}function k(c,d,f){b.iterateArcplanArray(f,function(b,f){var g,j,k;if(!f||!f.ObjID)return;g=h(c,b,f),typeof g=="object"&&(j=a.createContainer(f.BaseProperties),g.insertIntoContainer(j),j.appendTo(d),k=i(c,f.ObjID),e[k]=g)})}function l(a){b.iterateArcplanArray(a,function(a,b){var f,g,h;if(!b||!b.ObjID)return;g=c.removeExtension(b.Worksheet),h=i(g,b.ObjID),f=e[h],typeof f=="object"?f.update(b):d.info("arcplanobjects.updateArcplanObjects cannot update the object <"+h+">, because it has not been created.")})}var e={},f={};return{registerArcplanObjectBuilder:g,createNewArcplanObjects:k,isArcplanObjectAlreadyCreated:j,updateArcplanObjects:l}}return{createInstance:e}}),define("components/button/button",["logger"],function(a){function b(a){var b="";return typeof a.fontColor=="string"&&(b=b+"color: "+a.fontColor),typeof a.backgroundColor=="string"&&(b=b+" background-color: "+a.backgroundColor),"style = '"+b+"'"}function c(a,c){var d="&nbsp;",e;switch(typeof a.content){case"string":d=a.content.replace(/</g,"&#x003c;");break;case"undefined":break;default:throw new Error("Only string types are supported in the Button ViewModel Content property")}e=b(a),c.html("<div><div><div><button "+e+" class='arcButton'>"+d+"</button></div></div></div>"),typeof a.onClickCallback=="function"&&c.find("button").click(function(b){var c=b.shiftKey,d=b.ctrlKey;a.onClickCallback(c,d)})}function d(b){var d=b,e;return{insertIntoContainer:function(b){typeof e!="undefined"&&a.warn("button.insertIntoContainer called for a button wihch is already in another container. This is not supported."),e=b,c(d,e)},viewModelChanged:function(){typeof e!="undefined"&&c(d,e)}}}return{createButton:d}}),define("components/button/buttonbuilder",["components/button/buttondatatranslator","components/button/button"],function(a,b){function d(a){c.onClick=a}var c={};return{setOnButtonClickCallback:d,createArcplanObject:function(d,e){var f=a.createTranslator(d,e,c),g=b.createButton(f.viewModel);return{insertIntoContainer:g.insertIntoContainer,update:function(a){f.updateViewModel(a)===!0&&g.viewModelChanged()}}}}}),define("clientcredentials",["keychainstorage","replytypes","logger"],function(a,b,c){var d={};return d.getKeychain=function(d){var e,f,g,h="",i={UserInformation:{KeyChain:{Reply:b.getKeychain,KeyChain:"empty"}}};if(a.databaseSupported()){c.info("Schlssel fr Applikation: "+d),g=a.selectByApplication(d);for(e=0;e<g.rows.length;e+=1)f=g.rows.item(e),h+=f.user+"\t"+f.key+"\n";c.info("KeyChain: "+h),i.UserInformation.KeyChain.KeyChain=h}return i},d.dropClientCredentials=function(b){a.deleteEntriesByApplication(b)},d.storeKey=function(d,e,f){var g=-1;return c.info("storeKey: "+e+" "+f),g=a.createEntry(d,e,f),{UserInformation:{Reply:{Type:b.storeKey,Result:g>-1?1:0}}}},d}),define("popuphandler",["jquery","events/eventid","tools","properties","logger","menufilter","menuhierarchyviewmodel","popupkeyeventhandler","popupcalculator","jquery-outside-events-plugin"],function(a,b,c,d,e,f,g,h,i){function q(b){var c=a("input",b),d;if(c.length>0){d=c[0].id.split("_");if(d&&d.length>4)return d[4]}}function r(a){return d.getSelectType(a)==="HierMultiSelect"?!1:!0}function s(b){a("#"+b).attr("checked")==="checked"?(a("#"+b).removeAttr("checked"),a("#"+b).closest("li").removeClass("arcBoxHierSelected")):(a("#"+b).attr("checked","checked"),a("#"+b).closest("li").addClass("arcBoxHierSelected"))}function t(b){a("#"+b).closest("li").find(".arcHpCbox").not("#"+b).each(function(){a(this).removeAttr("checked"),a(this).closest("li").removeClass("arcBoxHierSelected")})}function u(b){a("#"+b).parents("li").children(".arcSelectable").each(function(){var c=a(this).children().first();c[0].id!==b&&(c.removeAttr("checked"),c.closest("li").removeClass("arcBoxHierSelected"))})}function v(c,d){var f=d.split("_");return a("#"+c[0].id+" .arcHiddenSelected").remove(),a("#"+c[0].id+" .arcHpCbox").removeClass("arcHiddenSubtreeSelected").removeAttr("checked"),a("#"+d).attr("checked","checked"),e.log("switchNode "+d+" "+a("#"+d).attr("checked")),{stopPropagation:!0,sendEvent:!0,value:f[0],eventType:b.EID_SWITCH_HIERPOPUP}}function w(b){var c=a("#"+b[0].id+" .arcHpCbox:checked");return c=c.not(a(".arcHiddenSubtreeSelected")),e.log("getSelectedNodes "+b[0].id+" num:"+c.length),c}function x(b){var c=w(b).length;c===0?a("#"+b[0].id+" input[name='ok']").attr("disabled","disabled"):a("#"+b[0].id+" input[name='ok']").removeAttr("disabled")}function y(a){e.log("restoreCurrentSelection "+a[0].id),d.isUseContentPaging(a)?j.setSelectionFromPath(d.getSelectionPath(a),a):j.setSelectionFromPath(p.selectionPaths,a)}function z(a){var b;e.log("undoSelection "+a[0].id),d.isUseContentPaging(a)?(b=d.getOrigSelectionPath(a),d.setSelectionPath(a,b),g.applySelectionsToHierarchy(a),j.setSelectionFromPath(b,a),d.setOrigSelectionPath(a,undefined)):j.setSelectionFromPath(d.getSelectionPath(a),a)}function A(b){var c=a("#"+b),e=a("#"+b+" .arcHierPopupContent"),g=d.getZIndex(c);c.children().css("z-index",g),e.css({visibility:"hidden",display:"none","z-index":"auto",height:"10px"}),f.removeFilterInput(c),h.unregisterKeyEvents(c)}function B(){o&&(o(0),j.setCallBack(undefined))}function C(b){b.data&&k&&k[0]&&(z(b.data),A(b.data[0].id),a("#"+b.data[0].id+" .arcHierPopupContent").off("clickoutside",C),G(),k=undefined,l=undefined,B(),j.showPendingPopupPos())}function D(a){var b=d.getObjType(a),c=d.isUseContentPaging(a);c&&b==="MenuHierarchie"&&g.setPopupInvisible(a),j.unregisterOutSideEvent(a),G(),k=undefined,l=undefined,B()}function E(a,b,c){var e,f,g,h=d.getObjType(a),i,j,k;if(h==="Menu")e=b.find("input:checked:first-child");else if(h==="MenuHierarchie"){e=b.find("input .arcHpCbox[type=checkbox]:checked:first-child"),b=b.children().first();if(c){g=d.getScrollY(a),g&&b.scrollTop(g);return}}e&&e.length>0?(e=e.parent(),f=e.offset().top-b.offset().top+b.scrollTop(),b.scrollTop(f)):e&&ARCPLAN.datavirtualization!==!1&&(i=d.getRowHeight(a),k=d.getDatavirtualizationProperties(a),k&&(j=d.getDatavirtualizationProperties(a).checkedElements),f=-1,j&&j.length>0?f=i*j[0]:f=(d.getYSettingValue(a)-1)*i,f!==-1&&(0===f&&b.scrollTop(1),b.scrollTop(f)))}function F(b){var c,d,e=b.parent();e.attr("id")==="arcFilterPanel"&&(d=b.children().first(),c=a(".arcInnerDocContainerForWidgetHosting",a("#arcContainer")),b.detach(),c.children().first().append(b),m={container:e,borderCss:d.css("border"),backgroundColorCss:d.css("background-color")},d.find(".arcHierPopup").css("display","none"),d.css({border:"none","background-color":"transparent"}))}function G(){var a;m&&(k.detach(),m.container.append(k),a=k.children().first(),a.css("border",m.borderCss),a.css("background-color",m.backgroundColorCss),a.find(".arcHierPopup").css("display","inline-block"),m=undefined)}function H(a){return a.hasClass("arcMenuSeparator")||a.parent().hasClass("arcMenuSeparator")||a.children().hasClass("arcMenuSeparator")||a.is("div")&&a.siblings().hasClass("arcMenuSeparator")}var j={},k,l,m,n=[],o,p={nodes:undefined,selectionPaths:{Elements:[]},getNodeGUID:function(a){var b;b=a.split("_");if(b&&b.length>4)return b[3]},setNodes:function(b){var f=this,g=d.isOneDimHasSumKnotLast(k);this.nodes=b,this.selectionPaths.Elements=[],e.log("setNodes start"),c.each(b,function(b,c){var d=[],e,h;d.push({VValue:{Type:"1",v:f.getNodeGUID(c.id)}}),e=a(c).closest("ul").closest("li");while(e[0])h=a(".arcHpCbox",e),h[0]&&(d.unshift({VValue:{Type:"1",v:f.getNodeGUID(h[0].id)}}),g?e=h.last().closest("ul").closest("li"):e=h.first().closest("ul").closest("li"));f.selectionPaths.Elements.push({Row:{Elements:d}})}),e.log("setNodes stop "+f.selectionPaths.Elements.length)},serialize:function(){var a="",b=this;return c.each(this.nodes,function(c,d){a=a+"<Row><nodeid>"+b.getNodeGUID(d.id)+"</nodeid></Row>"}),a}};return j.rememberSelection=function(a){p&&(e.log("rememberSelection"),p.setNodes(w(a)))},j.isCurrentPopup=function(a){return k&&k[0].id===a[0].id?!0:!1},j.setSelectionFromPath=function(b,f){function g(a){var b;if(a&&a.length>0){b=a.next();if(b.length>0)return b.prop("checked")}return!1}var h,i,j,k;b&&b.Elements&&(e.log("setSelectionFromPath "+f[0].id+" num: "+b.Elements.length),a(" .arcHiddenSelected",f).remove(),a(" .arcHpCbox",f).removeAttr("checked").removeClass("arcHiddenSubtreeSelected"),i=q(f),j=d.getShowRootNode(f),k=d.isOneDimHasSumKnotLast(f),c.iterateArcplanArray(b,function(b,d){var e=f,l,m=!1,n=!1,o=0,p;c.iterateArcplanArray(d,function(b,d){j||(o+=1),d&&d.v&&(h=c.makeNodeID("",o,1,d.v,i,"X"),e=a("li [id$='"+h+"']",e).parent().parent(),e.length>0?l=e:n=!0),j&&(o+=1)}),l&&(k?p=a("input.arcHpCbox",l).last():p=a("input",l).first(),m=g(p),n?n&&!m&&(p.attr("checked",!0),p.addClass("arcHiddenSubtreeSelected")):p.attr("checked",!0))}))},j.hideCurrentPopup=function(){k&&(z(k),D(k))},h.setHideCurrentPopupCallback(j.hideCurrentPopup),j.unregisterOutSideEvent=function(b){var c=b||k;c&&c[0]&&(A(c[0].id),a("#"+c[0].id+" .arcHierPopupContent").off("clickoutside",C))},j.setCallBack=function(a){o=a},j.showPendingPopupPos=function(){!k&&n.length>0&&j.showByPos(n)},j.show=function(a,b,c){var d;l?d=i.getPopupRectByPos(a,l):d=i.getPopupRect(a),j.showByRect(a,b,d,c)},j.showByPos=function(a){var b;n=a,n&&n.length>0&&(l={left:n[0].mousePos.x,top:n[0].mousePos.y},b=n[0].objRef,n.splice(0,1),F(b),j.showByRect(b,!1,i.getPopupRectByPos(b,l)))},j.showByRect=function(b,c,e,f){var i=b||k,j,l="",m="",n="auto",o,p="",q="",s=d.getObjType(b);k&&k[0]&&b[0]&&k[0].id!==b[0].id&&D(k);if(e.height===1)return;d.isUseContentPaging(b)&&s==="MenuHierarchie"&&g.setPopupVisible(b),j=a("#"+i[0].id+" .arcHierPopupContent"),l=e.left+"px",m=e.top+"px",e.width!=="auto"&&(n=e.width+"px"),o=e.height+"px",e.childrenHeight&&(q=e.childrenHeight+"px",j.children(":first").css("height",q)),j.off("clickoutside",C),j.on("clickoutside",b,C),b.children().css("z-index","1000000"),r(b)&&(a("#"+i[0].id+" .arcHierPopupDlg").css("visibility","hidden"),p="1px solid #ddd"),c?y(i):d.setOrigSelectionPath(b,a.extend(!0,{},d.getSelectionPath(b))),x(i),k=b,j.css({left:l,top:m,visibility:"visible",display:"inline-block",width:n,height:o,"border-bottom":p}),a(".arcHier .arcMenu",j).focus(),E(b,j,c),f&&h.registerKeyEvents(f,j)},j.onResize=function(){var b=k,c,d,e,f,g,h="";if(!b)return;c=a("#"+b[0].id+" .arcHierPopupContent"),l?d=i.getPopupRectByPos(b,l):d=i.getPopupRect(b);if(!d)return;e=d.left+"px",f=d.top+"px",g=d.height+"px",d.childrenHeight&&(h=d.childrenHeight+"px",c.children(":first").css("height",h)),c.css({left:e,top:f,height:g})},j.handlePopupFunctionEvent=function(b){var c=a(b),d=0;H(c)||(c.parent().hasClass("arcMenuItem")&&(c=c.parent()),c.is("li")&&(c.is("li")&&(d=c.attr("value")),d===0&&(d=c.text())),o(d),j.setCallBack(undefined),D(k))},j.handleMenuPopupEvent=function(c,e){var g=a("#"+c.data.id),h,i,l=d.isMenuFilterEnabled(g);return e.is("li")||e.parent().hasClass("arcMenuItem")?H(e)||(e.is("li")?h=parseInt(e.attr("value"),10):h=parseInt(e.parent().attr("value"),10),D(k),i={value:h,eventType:b.EID_SWITCH}):e.hasClass("arcHierPopupSelection")||e.hasClass("arcHierPopup")||j.isCurrentPopup(c.data.ref)?j.isCurrentPopup(g)?l||D(k):(k&&D(k),k=g,l&&f.showMenuFilterInput(c.data),j.show(k,!1,c.data)):D(k),i},j.handlePopupEvent=function(c,e){var f=a("#"+c.data.id),h,i={stopPropagation:!0,sendEvent:!1,value:undefined,eventType:b.EID_CLICK},l,m=d.isUseContentPaging(f),n;if(!j.isCurrentPopup(f))k&&(z(k),D(k)),k=f,j.show(k,!1);else if(e.hasClass("arcHierPopupSelection")||e.hasClass("arcHierPopup"))return r(f)||z(f),D(k),i;if(e.hasClass("arcHpCbox"))h=e[0].id,i.stopPropagation=!1;else if(e.hasClass("arcSelectable"))h=e.children(":first")[0].id,i.stopPropagation=!1;else if(e.is("LI"))h=e.attr("id"),h=h.replace(/_LI$/g,"_X"),s(h);else{n=e.is("SPAN");if(e.is("LABEL")||e.is("A")||n)n&&(e=e.parent()),h=e[0].id||e[0].htmlFor,h+="_X",s(h)}return h?r(f)?(i=v(f,h),p.setNodes(w(f)),d.setSelectionPath(f,p.selectionPaths),D(k)):(a("#"+h).attr("checked")==="checked"?(m&&g.selectNode(f,h.replace(/_X$/,"")),t(h),u(h)):a("#"+h).hasClass("arcHiddenSubtreeSelected")?(m&&g.deselectDescendants(f,h.replace(/_X$/,"")),t(h)):m&&g.deselectNode(f,h.replace(/_X$/,"")),m||p.setNodes(w(f)),x(f)):e.is("INPUT")&&!e.is(":disabled")&&e[0].type==="button"&&(e[0].name==="ok"?(m||(p.setNodes(w(f)),d.setSelectionPath(f,p.selectionPaths)),i.sendEvent=!0,m?(l=d.getSelectionPath(f),l.serialize=g.serializeSelection,i.value=l):i.value=p,i.eventType=b.EID_MULTISELECTION,D(f)):e[0].name==="cancel"&&(z(f),D(f))),i},window.jasmine&&(j.isSingleSelect=r,j.getNodeGUID=p.getNodeGUID,j.getObjID=q,j.toggleSelection=s,j.uncheckDescendants=t,j.uncheckAncestors=u,j.switchNode=v,j.getSelectedNodes=w,j.undoSelection=z),j}),define("showhiermenuaction",["properties","popuphandler","stringtools"],function(a,b,c){var d={};return d.executeShowHierMenu=function(a,d,e){var f,g,h,i,j=[];if(a&&a.length>0){for(i=0;i<a.length;i+=1)f=a[i].HierMenuObjID,g=$("#arcContainer"),h=$("#"+c.makeID(d,f),g),h&&h.length>0&&j.push({objRef:h,mousePos:e});j.length>0&&b.showByPos(j)}},d}),define("textinput",["jquery","logger","events/eventdatafactory","properties","stringtools","ui","keycodes","browserfeatures"],function(a,b,c,d,e,f,g,h){function o(a){i=f.hasTargetObjectClickEvent(a.target)}function p(b){b.shiftKey=m,b.ctrlKey=n,i?j.setPendingBlurEvent(b):(k(b),l.removeForm()),a(document).off("mousedown.textinput",o),i=!1,h.nativeTouchControls&&(a(document).off("touchstart.textinput",o),a(document).off("MSPointerDown.textinput",o))}function q(a){m=a.shiftKey,n=a.ctrlKey}function r(b){var c=a("#"+b.data.id);m=b.shiftKey,n=b.ctrlKey;switch(b.keyCode){case g.Tab:b.preventDefault(),p(b);break;case g.ESC:l.removeForm(),b.data&&(b.data.clickPos=undefined,d.getNumRows(c)===0&&a("tr:first",c).addClass("invisibleInitialInputRow"),c.find(".arcTextInputSizeTarget").removeClass("arcTextInputSizeTarget"))}}function s(b){b.preventDefault(),b.keyCode=g.Enter,b.target=a("#"+l.constants.inputId)[0],p(b)}function t(a,b){return parseInt(a,10)+b}function u(a,b,c){var d,e,f={};return d=-Math.min(0,b),e=Math.max(0,b+c-a),f.len=d+e,f.start=Math.min(0,b),f}function v(a,b,c,e,f,g){var h=d.getScrollElem(a),i,j,k;i=h.offset(),i.top-=f.top+g.top,i.left-=f.left+g.left,k=u(h.height(),c.top-i.top,c.height),j=u(h.width(),c.left-i.left,c.width),e.top=k.start,e.left=j.start,e.width=c.width-1,e.height=c.height-1,c.top-=k.start+1,c.left-=j.start+1,c.width=Math.max(0,c.width-j.len+1),c.height=Math.max(0,c.height-k.len+1)}function w(b){var d,e=b.data.id,f=a("#"+e);return d=c.createInstance(e,f),d.clickPos={x:-1,y:-1},b.data.clickPos&&(d.clickPos.x=typeof b.data.clickPos.x=="number"?b.data.clickPos.x:-1,d.clickPos.y=typeof b.data.clickPos.y=="number"?b.data.clickPos.y:-1),d}var i=!1,j,k,l={constants:{inputId:"arcTextInput",formId:"arcTextInputForm",scrollWrapperID:"arcTextInputScrollWrapper"}},m=!1,n=!1;return l.setEventSetter=function(a){j=a},l.setOnInputCallback=function(a){k=a},l.removeForm=function(){a("#"+l.constants.inputId).off("keydown.textinput",r),a("#"+l.constants.inputId).off("keyup.textinput",q),a("#"+l.constants.inputId).off("blur",p),a("#"+l.constants.formId).off("submit",s),a("#"+l.constants.scrollWrapperID).remove()},l.recalcInputPosition=function(b){var c,f,g,h,i,j,k,m,n,o;f={},j=e.makeID(d.getDocName(b),0),k=a("#"+j),m=k.parent().offset(),n=k.offset(),n.top-=m.top,n.left-=m.left,d.getObjType(b)==="Field"||d.getObjType(b)==="Text"?(c={left:t(d.getXPos(b),0),top:t(d.getYPos(b),0),width:t(d.getWidth(b),0),height:t(d.getHeight(b),0)},f={left:0,top:0,width:c.width-2,height:c.height-2}):(g=b.find(".arcTextInputSizeTarget"),g[0]&&(o=g.offset(),o.top-=m.top,o.left-=m.left,c={top:o.top-n.top,left:o.left-n.left,width:g.width(),height:g.height()},v(b,g,c,f,m,n))),c&&(i=a("#"+l.constants.scrollWrapperID),i.css(c),h=a("#"+l.constants.inputId),h.css(f))},l.show=function(c){var g,i="text",j,k,t,u,v,x,y;u=c.data.target,m=c.shiftKey,n=c.ctrlKey,y=u.find("input:first"),y.length>0&&y.attr("type")==="password"?(c.data.initialValue=y.attr("pass"),i="password"):c.data.isPassword===!0&&(i="password",u=a(c.currentTarget).children().first()),j={"font-size":u.css("font-size"),"font-style":u.css("font-style"),"font-weight":u.css("font-weight"),"font-family":u.css("font-family"),"font-variant":u.css("font-variant")},k=a("#"+c.data.id).addClass("arcTextInputActive"),x=d.getDocName(k),d.getObjType(c.data.ref)==="Text"?v="<textarea></textarea>":v="<input></input>",g=a(v,{type:i,id:l.constants.inputId,value:c.data.initialValue}).css(j).css({width:"100%",height:"100%",position:"absolute"}).on("blur",w(c),p),c.data.readonly&&g.attr("readonly","readonly"),a("#"+l.constants.formId).length!==0&&(b.warn("text input form already exists"),l.removeForm()),a('<div id="'+l.constants.scrollWrapperID+'"></div>').css({overflow:"hidden",position:"absolute"}).appendTo("#"+e.makeID(x,0)),a("<form id="+l.constants.formId+"></form>").append(g).appendTo("#"+l.constants.scrollWrapperID).on("submit",w(c),s),l.recalcInputPosition(k),f.select(g),a(g).on("keydown.textinput",w(c),r),a(g).on("keyup.textinput",q),a(document).on("mousedown.textinput",w(c),o),h.nativeTouchControls&&(a(document).on("touchstart.textinput",w(c),o),a(document).on("MSPointerDown.textinput",w(c),o)),g.trigger("focus")},l}),define("textinputeventhandlerfactory",["properties","ui","textinput","events/eventdatafactory"],function(a,b,c,d){function e(){function g(b){var d=a.getObjType(b.data.ref);j(b)&&c.show(b)}function h(b){var c,d=a.getObjType(b.data.ref),e,f;if(j(b)){c=$(b.data.target);switch(d){case"Field":case"Table":case"Column":case"Row":e=c.find(".arcTdInnerDiv"),e.length===1&&(f=e[0])}i(f),b.data.clickPos=undefined}}function i(a){var b,c;a&&(document.selection&&document.selection.createRange?(b=document.selection.createRange(),b.moveToElementText(a),b.select()):document.createRange&&window.getSelection&&(b=document.createRange(),b.selectNode(a),c=window.getSelection(),c.removeAllRanges(),c.addRange(b)))}function j(c){var d=$("#"+c.data.id),e=a.getObjType(d),g=$(c.target),h,i=!0;if(e==="Text")c.data=f.createExtendedEventDataForInput(d,c.data.id);else{c.data.clickPos&&(g=l(d,c.data.id,c.data.clickPos.y,c.data.clickPos.x)),g.is("INPUT")&&g.attr("type")==="password"&&(g=g.parent());if(!g.is("TD")&&!g.hasClass("arcTdInnerDiv"))i=!1;else{if(!g.is("TD")){h=g.parent();while(!h.is("TD"))h=h.parent()}else h=g;$(".arcTextInputSizeTarget",d).removeClass("arcTextInputSizeTarget"),h.addClass("arcTextInputSizeTarget"),c.data.initialValue=g.attr("data-unformatted")||g.text(),c.data.target=g,c.data.clickPos=b.getCellPosition(h[0])}}return i}function k(a){var b=$('<input type="password" />');b.css({"font-size":a.css("font-size"),"font-style":a.css("font-style"),"font-weight":a.css("font-weight"),"font-family":a.css("font-family"),"font-variant":a.css("font-variant")}),a.append(b)}function l(b,c,d,e){var f,g,h,i=a.getDatavirtualizationProperties(b),j=0;return i&&i.firstElementInDOM&&ARCPLAN.datavirtualization!==!1&&(j=i.firstElementInDOM),d-=j,f=b.find("table").first(),g=$("tr:nth-child("+(d+1)+")",f),h=$("td:nth-child("+(e+1)+")",g),h}var e,f={};return f.selectCell=function(b,c,d,e){var h=a.getIsPassword(b),i=l(b,c,d,e),j=i,m=f.createExtendedEventDataForInput(b,c);a.setDocSelectedObject(b.closest(".arcContainer"),c),a.setSelectedCell(b,{x:e,y:d}),h&&(j.find("input").length>0?j=j.find("input").first():k(i)),g({target:j,data:m})},f.createExtendedEventDataForInput=function(b,c){var e=d.createInstance(c,b);return e.hasClickEvent=a.getHasClickEvent(b),e.isPassword=a.getIsPassword(b),a.getIsEditable(b)||(e.readonly=!0),a.getObjType(b)==="Field"?(e.initialValue=$("td",b).text(),e.target=$(".arcTdInnerDiv",b),e.clickPos={x:0,y:0}):a.getObjType(b)==="Text"&&(e.initialValue=$("textarea",b).text(),e.target=$("textarea",b)),e},f.selectTextField=function(a,b){var d=f.createExtendedEventDataForInput(a,b),e=a.find("textarea");c.show({target:e,data:d})},f.showPendingEditCell=function(b,c){var d=e,f,g,h;e=null,d&&d.event&&d.event.data&&(!b&&!c&&typeof d.event.data.clickPos!="undefined"&&(f=$.contains(document.documentElement,d.event.data.ref[0]),f&&d.callback(d.event)),d.event.data.clickPos&&(d.event.data.clickPos=undefined),c&&(g=d.event.data.ref.closest(".arcContainer"),a.setDocSelectedObject(g,undefined),a.setSelectedCell(d.event.data.ref,{x:-1,y:-1}),h=$(".selected",d.event.data.ref),h.length>0&&h.removeClass("selected")))},f.onClickEditableObj=function(b){var c=$("#"+b.data.id),d=a.getNumRows(c),f=c.closest(".arcContainer");j(b),d===0?(b.data.clickPos={x:0,y:0},$(".invisibleInitialInputRow",c).removeClass("invisibleInitialInputRow")):b.data.clickPos&&(a.setSelectedCell(c,{x:b.data.clickPos.x,y:b.data.clickPos.y}),a.setDocSelectedObject(f,b.data.id)),b.data.hasClickEvent===!0?e={event:b,callback:g}:g(b)},f.onClickNonEditableObj=function(a){j(a),a.data.hasClickEvent===!0?e={event:a,callback:h}:h(a)},f}return{createInstance:e}}),define("colortools",["logger"],function(a){function c(b){return $.each(b,function(c,d){d>255&&(b[c]=255),d<0&&(b[c]=0),isNaN(d)&&(a.error("Invalid Color Value "+c+" = "+d),b[c]=0)}),b.A>1&&(b.A=1),b}function d(a,b){var d={},e=Math.round(2.55*b);return d.R=a.R+e,d.G=a.G+e,d.B=a.B+e,d.A=a.A,c(d)}var b={};return b.toRGBAString=function(a,b){var d,e=c(a);return d="rgba("+e.R+","+e.G+","+e.B+",",b?d+=b:d+=e.A,d+=")",d},b.fromHexColor=function(a){var b=a,d={R:0,G:0,B:0,A:0};return b&&(b.indexOf("#")===0&&(b=b.slice(1)),b.length>=6&&(d.A=1,d.R=parseInt(b.substring(0,2),16),d.G=parseInt(b.substring(2,4),16),d.B=parseInt(b.substring(4,6),16),b.length>6&&(d.A=parseInt(b.substring(6),16)/255))),c(d)},b.toLighterColor=function(a){return d(a,50)},b.toDarkerColor=function(a){return d(a,-30)},b}),define("stylesheethandler",["jquery","tools","logger"],function(a,b,c){function f(a){return a.ownerNode||a.owningElement}function g(a){var b=null,c=document.styleSheets,d;for(d=0;d<c.length;d+=1)if(a===f(c[d])){b=c[d];break}return b}function h(a){var b=document.createElement("style"),c=document.head||document.getElementsByTagName("head")[0];return b.type="text/css",b.rel="stylesheet",typeof a=="string"&&(b.title=a),c.appendChild(b),g(b)}function i(){return e===undefined&&(e=h("sessionSheet")),e}function j(a,b){var d=a.cssRules||a.rules,e=d.length;return b.indexOf(",")>=0&&c.error("invalid ',' in CSS Selector: "+b),a.insertRule?a.insertRule(b+" { }",e):a.addRule&&a.addRule(b,null,e),{sheet:a,index:e,style:d[e].style,selector:b}}function k(a,b,d){var e=[],f,g,h,i=!1,j=!1,l=!1,m=!1;c.debug("get matching Rules for: "+b),b.indexOf("nth-child(even")>-1?i=!0:b.indexOf("nth-child(odd")>-1?j=!0:b.indexOf("::before")>-1?l=!0:b.indexOf(":checked")>-1&&(m=!0);for(g=0;g<a.length;g+=1)if(a[g].styleSheet)f=a[g].styleSheet.cssRules||a[g].styleSheet.rules,f&&(e=e.concat(k(f,b,a[g].styleSheet)));else{h=a[g].selectorText;if(h)if(h===b||i&&h===b.replace("nth-child(even","nth-child(2n")||j&&h===b.replace("nth-child(odd","nth-child(2n+1")||l&&h===b.replace("::before",":before")||m&&h===b.replace(".arcHpCbox:not(:checked)",":not(:checked).arcHpCbox").replace("input.arcHpCbox:checked","input:checked.arcHpCbox")){e.push({sheet:d,index:g,style:a[g].style,selector:b});break}}return c.debug("num matching rules found: "+e.length),e}function l(a,b){a.removeRule?a.removeRule(b):a.deleteRule&&a.deleteRule(b)}function m(a,b){var c,d,e,f=a.cssRules||a.rules;for(c=f.length-1;c>=0;c-=1)f[c].selectorText&&(d=f[c].selectorText.indexOf(".arcCont"),d>=0&&(e=f[c].selectorText,e=e.substring(e.indexOf(".")),d=e.indexOf(" "),d>0&&(e=e.substring(0,d)),d=e.indexOf("_"),d>0&&(e=e.substring(d+1),e===b&&l(a,c))))}function n(a,b){var c=[],d;return d=a.cssRules||a.rules,d&&(c=c.concat(k(d,b,a))),c}function o(a){var b=[],c;return a&&e&&(b=n(e,a)),b}function p(a,b,c){a[b]=c}var d={},e;return d.removeClassesForDocument=function(a){var b=i(),c;a=a.replace(/\s/g,""),m(b,a)},d.removeStyle=function(a,b){var c,d,e,f=i();c=n(f,a),c[0]&&(d=c[0],e=d.style,e[b]!==""&&(e.length===1?l(f,d.index):e[b]=""))},d.setStyle=function(a,c,e,f){var g,h,k,l,m=i();if(e===undefined){if(c&&typeof c=="object"){h=o(a),h.length===0&&(k=j(m,a),h.push(k));for(g in c){if(!c.hasOwnProperty(g))continue;d.setStyle(a,g,c[g],h)}}}else{f?h=f:h=o(a),h.length===0&&(k=j(m,a),h.push(k)),l=b.toCamelCase(c);for(g=0;g<h.length;g+=1)p(h[g].style,l,e)}},d.getStyle=function(a,c){var d,e=o(a),f,g,h;if(c!==undefined){f=b.toCamelCase(c);for(g=e.length-1;g>=0;g-=1)if(e[g].style[f]!==null&&e[g].style[f]!==""){d=e[g].style[f];break}}else{d={};for(g=0;g<e.length;g+=1)for(h=0;h<e[g].style.length;h+=1)f=e[g].style[h],d[f]=e[g].style[b.toCamelCase(f)]}return d},d.removeAllClasses=function(){var a,b;e!==undefined&&(a=f(e),b=a.parentNode,b.removeChild(a),e=undefined)},d}),define("styleborderprops",["jquery","logger","properties","colortools","stylesheethandler"],function(a,b,c,d,e){function g(a,b,c){var e={TopLeftStyle:"solid",bottomRightStyle:"solid",topLeftColor:c,bottomRightColor:c},f;switch(a){case"3D3":e.topLeftStyle="groove",e.bottomRightStyle="groove",e.topLeftColor="rgba(255, 255, 255, 0.4)",e.bottomRightColor="rgba(220, 220, 220, 0.4)";break;case"3D1":e.topLeftStyle="inset",e.bottomRightStyle="inset",e.topLeftColor="rgba(160, 160, 160, 0.75)",e.bottomRightColor="rgba(230, 230, 230, 0.75)";break;case"3D2":e.topLeftStyle="outset",e.bottomRightStyle="outset",e.topLeftColor="rgba(230, 230, 230, 0.75)",e.bottomRightColor="rgba(160, 160, 160, 0.75)";break;case"Button2":e.topLeftStyle="outset",e.bottomRightStyle="outset",e.topLeftColor="rgba(230, 230, 230, 0.75)",e.bottomRightColor="rgba(130, 130, 130, 0.75)";if(b==="1Point"||b==="2Point")f=d.fromHexColor(c),e.topLeftColor=d.toRGBAString(d.toLighterColor(f),.75),e.bottomRightColor=d.toRGBAString(d.toDarkerColor(f),.75);break;case"3D4":e.topLeftColor="rgba(160, 160, 160, 0.75)",e.bottomRightColor="rgba(160, 160, 160, 0.75)",e.bottomRightStyle="solid";break;default:e.topLeftStyle="solid",e.bottomRightStyle="solid"}return e}function h(a,b){if(b==="3D4"){if(a.right&&a.bottom)return"3px 3px 6px 0px rgba(0,0,0,0.5)";if(a.right)return"8px 0px 6px -6px rgba(0,0,0,0.5)";if(a.bottom)return"0 8px 6px -6px rgba(0,0,0,0.5)"}}function i(a,b,c,d){var e;if(b==="Button"||b==="Switch")if(a.top||a.left||a.right||a.bottom)e={top:"none",left:"none",right:"none",bottom:"none"},a.top&&(e.top=c.topLeft+"px "+"inset"+" "+d.bottomRightColor),a.left&&(e.left=c.topLeft+"px "+"inset"+" "+d.bottomRightColor),a.right&&(e.right=c.bottomRight+"px "+"inset"+" "+d.topLeftColor),a.bottom&&(e.bottom=c.bottomRight+"px "+"inset"+" "+d.topLeftColor);return e}function j(a,b){return a+"px "+b.topLeftStyle+" "+b.topLeftColor}function k(a,b){return a+"px "+b.bottomRightStyle+" "+b.bottomRightColor}function l(a,b){var c={},d=a.type,e,l={TopLeftStyle:"solid",bottomRightStyle:"solid",topLeftColor:a.color,bottomRightColor:a.color},m;if(b==="Button"||b==="Switch")d="Button2";e=f.getBorderWidth(d,a.type),l=g(d,a.type,a.color),c.boxShadow=h(a,a.type),c.active=i(a,b,e,l);if(a.top||a.left||a.bottom||a.right)c.border={},a.top&&(c.border["border-top"]=j(e.topLeft,l)),a.left&&(c.border["border-left"]=j(e.topLeft,l)),a.right&&(c.border["border-right"]=k(e.bottomRight,l)),a.bottom&&(c.border["border-bottom"]=k(e.bottomRight,l));return c}var f={};return f.getBorderWidth=function(a,b){var c={};switch(a){case"3D4":c.topLeft=0,c.bottomRight=1;break;case"2Point":case"3D1":case"3D2":case"3D3":case"Button":c.topLeft=2,c.bottomRight=2;break;case"Button2":b==="1Point"?(c.topLeft=1,c.bottomRight=1):(c.topLeft=2,c.bottomRight=2);break;default:c.topLeft=1,c.bottomRight=1}return c},f.setBorderStyle=function(b,d,f){var g,h="."+b,i=c.getBorder(d),j=l(i,f),k;j.boxShadow&&d.children().css("box-shadow",j.boxShadow),f==="Button"||f==="Switch"?(g="button",j.active?(e.setStyle(g+h,j.border),f==="Button"&&(k="button:active"),f==="Switch"&&(k="button.arcChecked"),e.setStyle(k+h,{"border-top":j.active.top,"border-left":j.active.left,"border-right":j.active.right,"border-bottom":j.active.bottom})):j.border&&d.children().css(j.border),j.active&&a(g,d).addClass(b)):j.border&&d.children().css(j.border)},f.getTablePadding=function(a){var b={},d=c.getBorder(a);return d&&(d.top||(b.paddingTop="1px"),d.left||(b.paddingLeft="1px")),b},f.getBorderStyleObject=function(a){var b=c.getObjType(a),d=c.getBorder(a);return l(d,b).border},window.jasmine&&(f.toHTMLBorder=l),f}),define("objectresizer",["jquery","browserfeatures","logger","properties","styleborderprops","textinput"],function(a,b,c,d,e,f){function j(a,b){var c=d.getObjType(a);if(d.isUseContentPaging(a)){if(c==="VerticalHierarchie")return d.getContentWidth(a);switch(c){case"Row":case"Table":return Math.max(d.getWidth(a),d.getColumnWidth(a).accumulatedColumnWidth);case"Field":case"Column":return d.getWidth(a)}}return b.children().width()}function k(a,b){var c=d.getObjType(a);if(d.isUseContentPaging(a)){if(c==="VerticalHierarchie")return d.getNumRows(a)*d.getRowHeight(a);switch(c){case"Column":case"Table":return Math.max(d.getHeight(a),d.getNumRows(a)*d.getRowHeight(a));case"Field":case"Row":return d.getHeight(a)}}return b.children().height()}function l(a,b){var c,f=0,g=d.getObjType(a),h=b?b.type:null;if(h){if(g==="Button"||g==="Switch")h="Button2";c=e.getBorderWidth(h,b.type),b.left&&(f+=c.topLeft)}return f}function m(a){var b=g.getScrollableElement(a);b&&b[0]&&(d.setScrollElemWidth(b,null),d.setScrollElemHeight(b,null),g.adjustScrollDependentContentSize(a))}function n(b,c,d,e,f){var g=a("img",b),h,i,j;g.length>0&&(g.hasClass("arcImgScaleAllways")?g.css(e):f==="dynaCell"&&(h=g.attr("data-origSize"),typeof h=="string"&&(i=parseFloat(h.split(",")[0]),j=parseFloat(h.split(",")[1]),j>d&&i>c?g.css(e):(j>=d&&g.height(d),i>=c&&g.width(c),j<d&&g.height(j),i<c&&g.width(i)))))}function o(a){var b=d.getDropDownSymbolWidth(a);return b||(b=16),b}function p(a,c){var e=d.getScrollElem(a);e&&e.is(".arcHideYScrollbar")&&e.css("width",c+b.scrollbarWidth+"px")}function q(b,c,e,f,g,h){var i=d.getContent(b);typeof i=="object"||d.isFormattedTextInput(b)&&a("div[contenteditable]",b).length>0?(c.css(f),a("div[contenteditable]",b).parent().parent().css({"overflow-y":"auto"}),a("div[contenteditable]",b).parent().css({"min-height":f.height}),a("div[contenteditable]",b).css({height:f.height,"padding-left":h+"px","overflow-y":"auto"}),a("div:first",b).css(e)):(a("img",b).length>0?a("div",b).css(g):a("div",b).css(f),a("textarea",b).css(f),a("div:first",b).css(e))}function r(b,c,d,e,f,g,h){var i=g===0?1:0,j=h===0?1:0;a("div",b).filter(":first").css(d),c.css({width:e+"px",height:f+"px"}),a("table",b).parent().parent().css({width:e+i+"px",height:f+j+"px"})}function s(b,c,e,f,g,h,j){var k=d.getWrapMode(b),l=k&&k.Value==="SingleLine"?g:parseInt(d.getFont(b).lineHeight,10),m=2,n={width:Math.max(f-(o(b,h)+m),0)+"px",height:g+"px"},p=a("div:first",b),q=a(".arcHierPopupSelectionOverflowContainer",p),r=a(".arcHierPopupContent",p);p.css({left:c,top:e,lineHeight:l+"px","max-height":g+"px","min-height":g+"px",width:f+"px",height:g+"px"}).children("div:first").css(j),q.css(n),r.css("min-width",Math.max(f,i)+"px"),a("select",b).css(j)}function t(c,e,i,j,k,l){var m=d.getBorder(c),o=g.getHorizontalAdjustment(m,c),t=g.getVerticalAdjustment(m,c),u,v,w,x,y,z,A={left:k,top:l},B=i,C=!0;C=d.hasXPosChanged(c)||d.hasYPosChanged(c)||d.hasWidthChanged(c)||d.hasHeightChanged(c);if(C){x={width:i+"px",height:j+"px"},i-=o,j-=t,w={width:i+"px",height:j+"px"},u=a("div:first",c),u=a.merge(u,u.children(":first")),c.hasClass("arcTextInputActive")&&(v=a("#arcTextInput"),v.length===1&&f.recalcInputPosition(c));switch(e){case"dynaTable":case"dynaRadio":u.css(w),a("div",c).filter(":first").css(A);break;case"dynaCheckbox":r(c,u,A,i,j,o,t);break;case"dynaText":q(c,u,A,w,x,t);break;case"dynaColumn":u.css(w),a("table",c).width(i+"px"),a("div:first",c).css(A);break;case"dynaRow":u.css(w),h.applyTableRowHeight(c,"Row"),y=d.getWidth(c),z=d.getColumnWidth(c),d.getHScrollBarAllowed(c)&&z.accumulatedColumnWidth>y&&(j-=b.scrollbarWidth),a("table",c).height(j+"px"),a("table",c).parent().height(j+"px"),a("div:first",c).css(A);break;case"dynaCell":n(c,i,j,w,e),u.css(w),a("tr,td",c).css(w),h.applyTableRowHeight(c,"Field"),a("div:first",c).css(A);break;case"dynaMenu":case"dynaHierMenu":s(c,k,l,i,j,m,w);break;case"dynaSwitch":case"dynaButton":a("div,button",c).css(x).first().css(A),a("button > span",c).css(w).css("display","table-cell"),a("button > img",c).attr(w);break;case"dynaChart":a("div",c).css(w).first().css(A);break;case"dynaImage":a("div",c).css(w).first().css(A),a("img",c).css(w);break;case"dynaVertHier":case"dynaHoriHier":u.css(w).first().css(A),p(c,i)}h.applyScrollBarAllowed(c),d.setXPosChanged(c,!1),d.setYPosChanged(c,!1),d.setWidthChanged(c,!1),d.setHeightChanged(c,!1)}}function u(a){var b=["dynaColumn","dynaRow","dynaTable","dynaCell","dynaMenu","dynaButton","dynaChart","dynaVertHier","dynaHoriHier","dynaHierMenu","dynaRadio","dynaCheckbox","dynaText","dynaImage","dynaSwitch"],c;for(c in b)if(a.hasClass(b[c]))return b[c];return"unknown"}var g={},h,i=165;return require(["objectpropertyapplier"],function(a){h=a}),g.getHorizontalAdjustment=function(a,b){var c,f=0,g=d.getObjType(b),h=a?a.type:null,i=d.getPattern(b),j=i&&i.ImageReference;if(h){if(g==="Button"||g==="Switch")h="Button2";c=e.getBorderWidth(h,a.type),a.left?f+=c.topLeft:(g==="Table"||g==="Column")&&!j&&(f+=1),a.right?f+=c.bottomRight:(g==="Table"||g==="Column")&&!j&&(f+=1)}return f},g.getVerticalAdjustment=function(a,b){var c,f=0,g=0,h=d.getObjType(b),i=a?a.type:null,j=d.getPattern(b),k=j&&j.ImageReference;if(i){if(h==="Button"||h==="Switch")i="Button2";c=e.getBorderWidth(i,a.type),a.top?f+=c.topLeft:g+=1,a.bottom?f+=c.bottomRight:g+=1;if(g>0&&!k)switch(h){case"Table":case"Column":case"CheckboxGroup":f+=g}}return f},g.isScrollableObject=function(a){switch(a){case"Column":case"Row":case"Table":case"CheckboxGroup":case"VerticalHierarchie":case"HorizontalHierarchie":case"MenuHierarchie":return!0}return!1},g.getScrollableElement=function(a){var b,c=d.getObjType(a);return g.isScrollableObject(c)&&(b=a.children("div"),b&&(c==="MenuHierarchie"?b=b.children(".arcHierPopupContent").children("div").first():b=b.children("div"))),b},g.adjustScrollDependentContentSize=function(a){var c=g.getScrollableElement(a),e,f,h,i,l=!1,m=d.getBorder(a),n=g.getHorizontalAdjustment(m,a),o=g.getVerticalAdjustment(m,a),p=n===0?1:0,q=o===0?1:0;c&&c[0]&&(d.setScrollElem(a,c),d.getObjType(a)!=="MenuHierarchie"&&(f=d.getWidth(a),l=c.is(".arcHideYScrollbar"),l&&(f+=b.scrollbarWidth),e=j(a,c),e>f&&d.setScrollWidth(a,e),e=d.getScrollElemWidth(c),!e&&l&&(e=f,c.css("width",e+p+"px"),d.setScrollElemWidth(c,e)),i=d.getHeight(a),h=k(a,c),h>i?d.setScrollHeight(a,h):d.setScrollHeight(a,undefined),h=d.getScrollElemHeight(c),h||(h=i-o,c.css("height",h+q+"px"),d.setScrollElemHeight(c,h))))},g.applyObjectDimensionsWithoutScrollDepConUpdate=function(a){var b,c,e,f,g;a&&(b=parseInt(d.getXPos(a),10),c=parseInt(d.getYPos(a),10),e=d.getWidth(a),f=d.getHeight(a),a.children&&a.children(0)&&(g=u(a.children(0)),t(a,g,e,f,b,c)))},g.applyObjectDimensions=function(a){g.applyObjectDimensionsWithoutScrollDepConUpdate(a),a&&a.children&&a.children(0)&&m(a)},g}),define("radiobuttonhtmlgenerator",["properties","tools","propertytools","objectresizer","htmltemplates","tooltip","tooltiptypes","stringtools"],function(a,b,c,d,e,f,g,h){function j(b,c,d){var e=a.getYSettingValue(b),f=e===d?" checked":"",g=h.makeClassName(b[0].id),i="radio_"+d+"_"+g;return"<span><input type='radio' id='"+i+"' name='radio"+g+"' value='"+d+"'"+f+"></input>"+"<label for='"+i+"'>"+(c.value?c.value.replace(/</g,"&#x003c;"):"")+"</label>"+"</span>"}function k(a,c){var d=[],e=0;return b.iterateArcplanArray(c.Rows,function(c,f){b.iterateArcplanArray(f,function(b,c){c.value&&(d[e]="<td>"+j(a,c,e+1)+"</td>",e+=1)})}),d}function l(a){return"<tr class='arcRadioSingleLine'>"+a.join("")+"</tr>"}function m(a,b){var c=[],d=0,e=n(a);for(;d<b.length;d+=1)c[d%e]===undefined&&(c[d%e]="<tr>"),c[d%e]+=b[d];return c.join("</tr>")+"</tr>"}function n(b){var c=2,e=1.5,f=.2,g=a.getFont(b),h=a.getBorder(b),i=a.getHeight(b)-d.getVerticalAdjustment(h,b),j=p(g.fontSize),k=Math.round(j*e+c),l=Math.floor(i/k+f);return l<=0?1:l}function o(b,c){var e,f,g="radioMeasure",h,i,j=a.getBorder(b),k=a.getWidth(b)-d.getVerticalAdjustment(j,b),l=a.getFont(b);return i="<table class='dynaRadio'><tbody></tbody></table>",e=$("<span id='"+g+"'></span>").append(i).css({zIndex:-1e3,display:"none"}).css(l),$("tbody",e).append(c),$("body").append(e),f=$("#"+g).width(),$("#"+g).remove(),h=f<k,h}function p(a){var b,c="radioMeasure",d;return b=$("<span id='"+c+"'></span>").css({fontSize:parseInt(a,10)+"pt",zIndex:-1e3,display:"none"}),$("body").append(b),d=parseInt($("#"+c).css("fontSize"),10),$("#"+c).remove(),d}var i={};return i.generateStub=function(b){var c,d=a.getZIndex(b),i=a.getToolTipType(b),j=a.getToolTip(b),k=h.makeClassName(b[0].id);c=e.getHtmlTemplate("radioButton"),i===g.WholeObject?c=c.replace(/\{title\}/g,'title="'+f.toolTipStringForObject(j)+'"'):c=c.replace(/\{title\}/g,""),c=c.replace(/\{z-index\}/g,d),c=c.replace(/\{tableClass\}/g,k),b[0].innerHTML=c},i.buildHtmlContent=function(b,c){var d=[],e=-1,f=parseInt(a.getHorizontalAlignment(b),10)===e,g,h=!1,i;return c.Rows&&(d=k(b,c),f&&(i=l(d),h=o(b,i),h&&(g=i)),h||(g=m(b,d))),g},i}),define("filterpanelpositioner-preserve-label-positions",["properties","objectresizer"],function(a,b){function h(b){function c(a){if(typeof a=="number")return a;if(typeof a=="string")return parseInt(a,10);throw"filterpanelpositioner - Property type '"+typeof a+"' not supported"}this.x=c(a.getXPos(b)),this.y=c(a.getYPos(b)),this.width=c(a.getWidth(b)),this.height=c(a.getHeight(b))}function i(a,b,c){this.filterObject=a,this.labelObject=b,this.xPosInDoc=c,this.yPosInDoc=c,this.labelXPosInDoc=c,this.labelYPosInDoc=c,this.boundingBoxInDoc=c,this.xPosInFilterPanel=c,this.yPosInFilterPanel=c,this.labelXPosInFilterPanel=c,this.labelYPosInFilterPanel=c}function j(a,b){var c,d,e,f;return c=Math.min(a.x,b.x),d=Math.max(a.x+a.width,b.x+b.width),e=Math.min(a.y,b.y),f=Math.max(a.y+a.height,b.y+b.height),{x:c,y:e,width:d-c,height:f-e}}function k(){var a,b,c,e,f;for(a=0;a<d.length;a+=1)b=d[a].filterObject,c=d[a].labelObject,e=new h(b),c===undefined?d[a].boundingBoxInDoc=e:(f=new h(c),d[a].boundingBoxInDoc=j(e,f))}function l(){d.sort(function(b,c){return b.boundingBoxInDoc.y<c.boundingBoxInDoc.y?-1:b.boundingBoxInDoc.y>c.boundingBoxInDoc.y?1:b.boundingBoxInDoc.x<c.boundingBoxInDoc.x?-1:b.boundingBoxInDoc.x>c.boundingBoxInDoc.x?1:0})}function m(){var a,b,c,i,j,k,l,m=f;e=0;for(a=0;a<d.length;a+=1)b=d[a].filterObject,c=d[a].labelObject,i=new h(b),d[a].xPosInDoc=i.x,d[a].yPosInDoc=i.y,c===undefined?(d[a].xPosInFilterPanel=f,d[a].yPosInFilterPanel=m,m+=i.height+f):(j=new h(c),d[a].labelXPosInDoc=j.x,d[a].labelYPosInDoc=j.y,k=f-d[a].boundingBoxInDoc.x,l=m-d[a].boundingBoxInDoc.y,d[a].xPosInFilterPanel=i.x+k,d[a].yPosInFilterPanel=i.y+l,d[a].labelXPosInFilterPanel=j.x+k,d[a].labelYPosInFilterPanel=j.y+l,m+=d[a].boundingBoxInDoc.height+f),e=Math.max(e,d[a].boundingBoxInDoc.width);e>0&&(e+=f+f,g>0&&(e+=g+f))}function n(a){k(),l(),m()}function o(a){var b,c;for(b=0;b<d.length;b+=1){if(a[0]===d[b].filterObject[0])return{x:d[b].xPosInFilterPanel,y:d[b].yPosInFilterPanel};c=d[b].labelObject;if(typeof c=="object"&&a[0]===d[b].labelObject[0])return{x:d[b].labelXPosInFilterPanel,y:d[b].labelYPosInFilterPanel}}}var c={},d,e,f=10,g=0;return c.clear=function(){d=[],e=0},c.addToolbar=function(a){g=a},c.addFilterObject=function(a){d.push(new i(a)),e=-1},c.addLabelledFilterObject=function(a,b){d.push(new i(a,b)),e=-1},c.panelWidth=function(){return e<0&&n(),e},c.moveObjectsIntoFilterPanel=function(c){var f,g,h;e<0&&n();for(f=0;f<d.length;f+=1)g=d[f].filterObject,h=d[f].labelObject,g.appendTo("#arcFilterPanel"),a.setXPos(g,d[f].xPosInFilterPanel),a.setYPos(g,d[f].yPosInFilterPanel),b.applyObjectDimensions(g),h!==c&&(h.appendTo("#arcFilterPanel"),a.setXPos(h,d[f].labelXPosInFilterPanel),a.setYPos(h,d[f].labelYPosInFilterPanel),b.applyObjectDimensions(h))},c.moveObjectsBackIntoDocument=function(c){var e,f,g;for(e=0;e<d.length;e+=1)f=d[e].filterObject,g=d[e].labelObject,a.setXPos(f,d[e].xPosInDoc),a.setYPos(f,d[e].yPosInDoc),f.appendTo(c),b.applyObjectDimensions(f),typeof g=="object"&&(a.setXPos(g,d[e].labelXPosInDoc),a.setYPos(g,d[e].labelYPosInDoc),g.appendTo(c),b.applyObjectDimensions(g))},c.updateAfterLoadingObject=function(c){var d=o(c);typeof d=="object"&&(a.setXPos(c,d.x),a.setYPos(c,d.y),b.applyObjectDimensions(c))},c}),define("filterpanel",["filterpanelpositioner-preserve-label-positions","objectresizer","properties"],function(a,b,c){function m(a){var b,c,e,f;f=$("<div class='arcFilterPanel-toolbar'></div> "),b=$("<button class='arcFilterPanel-button arcClickable arcFilterPanel-closeImage'></button>"),b.click(d.toggleFilterPanel),f.append(b),c=$("<button id='arcFilterPanel-pinButton' class='arcFilterPanel-button arcClickable arcFilterPanel-pinImage'></button>"),c.click(y),f.append(c),e=$("<button id='arcFilterPanel-saveButton' class='arcFilterPanel-button arcFilterPanel-saveImage disabled-image' disabled='true'></button>"),e.click(B),f.append(e),a.append(f)}function n(){var b=a.panelWidth(),c=parseInt(e.css("z-index"),10),d=$("<div id='arcFilterPanel'></div>");d.css("margin-left","-"+b+"px"),d.css("width",b+"px"),d.css("z-index",c+1),m(d),$("#arcContainer").append(d)}function o(a){var b=c.getObjType(a);if(b==="Menu"||b==="MenuHierarchie"||b==="RadioGroup")if(c.isBookmarkObject(a)===!0)return!0;return!1}function p(a){var b=c.getLabelledByObjectID(a),d;if(b!==undefined){d=$("#"+b+".objContainer");if(d.length===1)return d}return undefined}function q(){var b,c,d=!1;e.children().each(function(){b=$(this),o(b)&&(d=!0,c=p(b),c!==undefined?a.addLabelledFilterObject(b,c):a.addFilterObject(b))}),typeof g=="object"&&typeof g.hasFiltersChanged=="function"&&g.hasFiltersChanged(d)}function r(){var b=a.panelWidth(),c,d,g,h;return c=f.outerWidth(),d=e.outerWidth(),g=(c-d)/2,h=b-g,h>0&&h>b&&(h=b),Math.max(0,h)}function s(){var a=$("#arcFilterPanel");a.get(0).scrollHeight>a.height()?a.find(".arcFilterPanel-toolbar:first").css("margin-right","2px"):a.find(".arcFilterPanel-toolbar:first").css("margin-right","10px")}function t(){f!==undefined&&i===!0&&(f.css("margin-left",r()+"px"),s())}function u(){f===undefined?e.css("margin-left",a.panelWidth()+"px"):f.css("margin-left",r()+"px")}function v(){f===undefined?e.css("margin-left","0px"):f.css("margin-left","0px")}function w(){$("#arcFilterPanel").on("click.hideFilterPanel",function(a){a.target===$("#arcFilterPanel")[0]&&A()})}function x(){$("#arcFilterPanel").off("click.hideFilterPanel")}function y(){k===!1?(u(),$("#arcFilterPanel").removeClass("arcFilterPanelNotPinned"),x(),k=!0):(v(),i&&$("#arcFilterPanel").addClass("arcFilterPanelNotPinned"),w(),k=!1),typeof g=="object"&&typeof g.changeDefaultIsPinned=="function"&&g.changeDefaultIsPinned(k)}function z(){a.moveObjectsIntoFilterPanel(),$("#arcFilterPanel").css("margin-left","0px"),s(),i=!0,k===!1&&$("#arcFilterPanel").addClass("arcFilterPanelNotPinned"),w()}function A(){var b=a.panelWidth();$("#arcFilterPanel").css("margin-left","-"+b+"px"),a.moveObjectsBackIntoDocument(e),i=!1,k===!0?y():$("#arcFilterPanel").removeClass("arcFilterPanelNotPinned"),x()}function B(){typeof g=="object"&&typeof g.changeDefaultBookmark=="function"&&h(function(b){g.changeDefaultBookmark(b.bookmark),$("#arcFilterPanel-saveButton").attr("disabled",!0),$("#arcFilterPanel-saveButton").addClass("disabled-image"),$("#arcFilterPanel-saveButton").removeClass("arcClickable")})}var d={},e,f,g,h,i=!1,j=!1,k=!1,l=30;return d.notifyDocumentLoaded=function(b){var c;if(typeof g!="object")return;i===!0&&A(),$("#arcFilterPanel").remove(),e=b,c=b.closest($(".arcOuterDocContainerForWidgetHosting")),c.length===1?(f=c,f.addClass("arcFilterPanel-slidingLeftMargin")):(f=undefined,e.addClass("arcFilterPanel-slidingLeftMargin")),a.clear(),q(),n(),j===!0&&(z(),setTimeout(function(){y()},0))},d.setCreateBookmarkFunction=function(a){h=a},d.updateAfterLoadingObject=function(b){i===!0&&a.updateAfterLoadingObject(b)},d.toggleFilterPanel=function(){i===!1?z():A()},d.notifyFilterHasChanged=function(a){o($("#"+a))&&($("#arcFilterPanel-saveButton").attr("disabled",!1),$("#arcFilterPanel-saveButton").removeClass("disabled-image"),$("#arcFilterPanel-saveButton").addClass("arcClickable")),typeof g=="object"&&typeof g.filterChanged=="function"&&o($("#"+a))&&g.filterChanged(),i===!0&&k===!1&&A()},d.setEventListener=function(a){g=a},d.setIsInitiallyPinned=function(a){j=a},$(window).resize(t),a.addToolbar(l),d}),define("checkboxhtmlgenerator",["properties","htmltemplates","styleborderprops","dmfieldtypes","tools","tooltiptypes","tooltip"],function(a,b,c,d,e,f,g){function i(a){var b,c;return a.Type===d.VChar&&a.value===""?b="&nbsp;":(a.Type!==d.VEmpty&&parseInt(a.value,10)!==0?c="checked ":c="",b="<input type='checkbox' "+c+"/>"),b}function j(a){var b={};return a.BackgroundColor&&(b.backgroundColor=a.BackgroundColor),b}function k(a,b,c){var f,g=j(b);switch(b.Type){case d.VEmpty:case d.VDouble:case d.VChar:case d.VEnterprise:case d.VTime:case d.VSAP:case d.VMetadata:case d.VError:case d.VHTML:case d.VLink:case d.VRTF:case d.VBlob:f=i(b);break;case d.VEmfDib:case d.VImage:f="<input type='checkbox' />"}return g=g?" style='"+e.styleAsStringFromObject(g)+"'":"",c=c?" title='"+c+"'":"","<td"+c+" tabindex='-1'"+g+">"+f+"</td>"}function l(a,b){var c=b?" title='"+b+"' ":"";return"<tr"+c+">"+a.join("")+"</tr>"}var h={};return h.generateStub=function(d){var h=a.getZIndex(d),i=a.getForegroundColor(d),j=a.getFont(d),k=c.getBorderStyleObject(d),l=c.getTablePadding(d),m=a.getToolTipType(d),n=a.getToolTip(d),o,p={color:i};o=b.getHtmlTemplate("checkBox"),m===f.WholeObject?o=o.replace(/\{title\}/g,'title="'+g.toolTipStringForObject(n)+'"'):o=o.replace(/\{title\}/g,""),o=o.replace(/\{z-index\}/g,h),e.mergeObjects(p,k),o=o.replace(/\{borderDivStyle\}/g,e.styleAsStringFromObject(p)),e.mergeObjects(l,j),o=o.replace(/\{tableStyle\}/g,e.styleAsStringFromObject(l)),d[0].innerHTML=o},h.buildHtmlForRows=function(b,c,h,i){var j=0,m=!1,n=a.getWidth(b),o=a.getColumnWidth(b),p=a.getNumCols(b),q=a.getObjType(b),r=a.getToolTip(b),s=a.getToolTipType(b),t="";o&&(e.iterateArcplanArray(o,function(a,b){a==="Width"&&(j+=b)}),j===0&&o.Width&&(j=p*parseInt(o.Width,10)),m=n>j),c.Rows&&e.iterateArcplanArray(c.Rows,function(a,c){var j=0,n,o,p=[];e.iterateArcplanArray(c,function(a,c){var d;t="",s===f.EachColumn?t=g.toolTipStringForColumn(r,j):s===f.EachCell&&(t=g.toolTipStringForCell(r,i,j)),d=k(b,c,t),j+=1,p.push(d)}),m&&(n={value:"",Type:d.VChar},o=k(b,n),p.push(o)),t=s!==f.EachRow?"":g.toolTipStringForRow(r,i),h[i]=l(p,t),i+=1})},h}),define("patternapplier",["jquery","logger","properties"],function(a,b,c){var d={};return d.applyDropdownSymbol=function(a,b){var d={},e,f,g,h=c.getDropDownSymbolWidth(a),i=c.getDropDownSymbolHeight(a),j=c.getHeight(a);c.getSelectType(a)==="HierMultiSelect"?g=c.getMultiDropDownImageReference(a):g=c.getSingleDropDownImageReference(a),g&&c.getBackgroundColor(a)!=="rgba(255,255,255,0.01)"&&(f=a.find(".arcHierPopup:first"),e=b.buildObjectPictRequest(g),b.downloadPictToBrowserCache(e,function(){i>j&&(d.backgroundSize=h+"px "+j+"px"),d.backgroundImage="url('"+e+"')",f.css(d)}))},d.loadPattern=function(a,b,d){var e={},f,g;f=c.getPattern(a);if(f&&f.PatternFormat){e.backgroundRepeat="no-repeat no-repeat";switch(f.PatternFormat.Format){case"Zoom":e.backgroundSize="100% 100%";break;case"Center":e.backgroundPosition="50% 50%";break;default:e.backgroundRepeat="repeat repeat"}g=d.buildObjectPictRequest(f.ImageReference),d.downloadPictToBrowserCache(g,function(){e.backgroundImage="url('"+g+"')",e.webkitAppearance="none",b.css(e)})}},d}),define("tablehtmlgenerator",["properties","logger","tools","objectresizer","styleborderprops","patternapplier","tooltiptypes","tooltip","dmfieldtypes","propertytools","browserfeatures"],function(a,b,c,d,e,f,g,h,i,j,k){function m(a){switch(a){case"Field":return"dynaCell";case"Column":case"Row":case"Table":return"dyna"+a}}function n(a,b,c,d){var e=$("<table></table>"),f,g,h=!1;return f=$('<tr><td style="width:'+c+';" >'+'<div class="arcTdWrapOuter"><div class="arcTdWrapInner">'+'<div class="arcTdInnerDiv"></div></div></div></td></tr>'),f.appendTo(e),g=$(".arcTdInnerDiv",e),b&&typeof b=="object"&&g.css(b),g[0].textContent=a,e.css({visibility:"hidden",height:d,position:"absolute",left:0,top:0,width:c}),e.appendTo("body"),h=g.height()<=d-1,e.remove(),h}function o(a,b,d){var e,f={},g=a.Font,h=g?c.toHTMLFont(g):"",i;f.textAlign="right",d&&(f.position="relative");if(a.Justification)switch(a.Justification){case"-1":f.textAlign="left";break;case"0":f.textAlign="center"}if(a.VerticalAlignment)switch(a.VerticalAlignment){case"401":f.vertcalAlign="top";break;case"301":f.verticalAlign="bottom"}a.BackgroundColor&&(f.backgroundColor=a.BackgroundColor),a.ForegroundColor&&(f.color=a.ForegroundColor);if(h&&typeof h=="object")for(e in h)e!=="length"&&(i=h[e],typeof i=="string"&&(i=i.replace(/'/g,"")),f[e]=i);return b&&b.Value==="SingleLine"&&(f.whiteSpace="nowrap"),f}function p(a,b,d){var e={textDecoration:d,color:b};return"<div class='arcTdWrapOuter'><div class='arcTdWrapInner'><div class='arcTdInnerDiv'><a style='"+c.styleAsStringFromObject(e)+"' "+" target='_blank' "+" href='"+a.URL.replace(/'/g,"&#x0027;")+"'>"+a.value.replace(/</g,"&#x003c;")+"</a></div></div></div>"}function q(a,b,c){var d="",e="lang='dynaIMG:"+a.hash+"' ";return a.Image&&a.ImageType!=="noimage"&&(d="src='data:image/"+a.ImageType+";base64,"+a.Image+"' ",e=""),"<a target='_blank'  href='"+a.URL.replace(/'/g,"&#x0027;")+"'>"+"<img "+"class='arcLinkImage' "+"name='OBJ' "+e+"align='top' "+"data-origSize='"+a.Width+","+a.Height+"' "+"height='"+c+"px' "+"width='"+b+"px' "+d+"></img></a>"}function r(a,b,c,d){var e="",f="lang='dynaIMG:"+a.hash+"' ",g;return g="style='width:"+d+"px;"+"height:"+c+"px;' ",a.Image&&a.ImageType!=="noimage"&&(e="src='data:image/"+a.ImageType+";base64,"+a.Image+"' ",f=""),"<img class='"+b+"' "+"name='OBJ' "+f+"align='top' "+"data-origSize='"+a.Width+","+a.Height+"' "+g+e+"></img>"}function s(a,b,d){var e=a.length>0?"########":"";if(!b||b.Value!=="SingleLine")a=a.replace(/\r\n/g,"<br />");return"<div class='arcTdWrapOuter'><div class='arcTdWrapInner'><div class='arcTdInnerDiv' style='"+c.styleAsStringFromObject(d)+"' "+">"+"<input type='password' "+"class='arcPassword' "+"value='"+e+"' "+"pass='"+a.replace(/'/g,"&#x0027;")+"' "+"></input>"+"</div></div></div>"}function t(a,b,d){var e="",f=a.value;while(f.indexOf(" ")===0)e+="&nbsp;",f=f.substr(1);f=f.replace(/</g,"&#x003c;");if(!b||b.Value!=="SingleLine")f=f.replace(/\r\n/g,"<br />");return"<div class='arcTdWrapOuter'><div class='arcTdWrapInner'"+(a.Justification?"":" style='float:right;'")+">"+"<div class='arcTdInnerDiv' style='"+c.styleAsStringFromObject(d)+"' "+">"+e+f+"</div></div></div>"}function u(a,b){var d=a.HtmlSource;return"<div class='arcTdWrapOuter'><div class='arcTdWrapInner' ><div class='arcTdInnerDiv' style='"+c.styleAsStringFromObject(b)+"' "+">"+d+"</div></div></div>"}function v(a,b){b=b||{};if(a.VerticalAlignment)switch(a.VerticalAlignment){case"301":b.verticalAlign="bottom";break;case"401":b.verticalAlign="top"}}function w(b,d,e,f,g,h,l,m){var n,w=o(d,h,m),x="arcImgScaleIfLarger",y,z,A,B,C="",D=d.ForegroundColor||a.getForegroundColor(b),E=a.getFont(b),F,G,H,I=a.getObjType(b),J;d.Font?G=c.toHTMLFont(d.Font):G=E,F=G.textDecoration;switch(d.Type){case i.VLink:typeof d.value=="string"?n=p(d,D,F):(I==="Row"?y=Math.min(a.getRowHeight(b),d.Height):y=Math.min(a.getRowHeight(b)-1,d.Height),z=Math.min(e-2,d.Width),n=q(d,z,y));break;case i.VEmfDib:case i.VImage:case i.VRTF:case i.VBlob:d.Type!==i.VBlob&&d.Type!==i.VRTF||!d.value?(J=j.getAdjustedRowHeight(b,I),I==="Row"?j.hasRowHoriScrollbar(b)&&(J-=k.scrollbarWidth):I==="Column"&&j.hasColumnVertScrollbar(b)&&(e-=k.scrollbarWidth),d.ScaleToObject||d.Type===i.VEmfDib?(x="arcImgScaleAllways",y=J,z=e):(y=Math.min(J,d.Height),z=Math.min(e-2,d.Width)),n=r(d,x,y,z),w.textAlign="center"):a.getIsPassword(b)?n=s(d,h,{textDecoration:F}):n=t(d,h,{textDecoration:F});break;case i.VEmpty:case i.VDouble:case i.VChar:case i.VEnterprise:case i.VTime:case i.VSAP:case i.VMetadata:case i.VError:H={textDecoration:F},v(d,H),a.getIsPassword(b)?n=s(d.value,h,H):(d.value.indexOf(" ")===0&&!d.Data&&(d.Data=d.value),n=t(d,h,H)),B=d.Data;break;case i.VHTML:d.HtmlSource&&(I==="Field"&&d.FilterHtml==="true"&&(a.setVHTMLField(b,!0),a.setHtmlSource(b,d.HtmlSource)),n=u(d,{textDecoration:F}))}if(B){d.DecimalSeparator&&d.DecimalSeparator!=="."&&d.Type===i.VDouble&&(B=B.replace(".",d.DecimalSeparator)),B=B.replace(/'/g,"&#x0027;");if(!h||h.Value!=="SingleLine")B=B.replace(/\r\n/g,"<br />");C="data-unformatted='"+B+"'"}return A="<td tabindex='-1'"+(l?" title='"+l+"'":"")+" "+C+" style='"+c.styleAsStringFromObject(w)+"' >"+n+""+(m?"<span class='arcCellTooltipMarker'></span>":"")+"</td>",A}function x(a,b){var c=b?" title='"+b+"' ":"";return"<tr"+c+">"+a.join("")+"</tr>"}function y(b,c,d,e){var f=a.getToolTip(b),i=a.getToolTipType(b),j=a.getObjType(b),k=e;return k===""&&(i===g.EachRow?k=h.toolTipStringForRow(f,c):i===g.WholeObject&&j==="Field"?k=h.toolTipStringForObject(f):i===g.EachColumn?k=h.toolTipStringForColumn(f,d):i===g.EachCell&&(k=h.toolTipStringForCell(f,c,d))),a.getShowTooltipMarker(b)&&k!==""?!0:!1}var l={};return l.generateTableStub=function(b,d){var i=$("<div tabindex='-1' ></div>"),j=$("<div></div>"),k=$("<div></div>"),l=$("<table tabindex='-1' ></table>"),n=$("<tbody></tbody>"),o=a.getZIndex(b),p={left:"0px",top:"0px",position:"relative"},q=a.getForegroundColor(b),r=a.getBackgroundColor(b),s=a.getPattern(b),t={},u=a.getFont(b),v={borderCollapse:"separate"},w=e.getBorderStyleObject(b),x=e.getTablePadding(b),y,z=a.getObjType(b),A=a.getToolTipType(b),B=a.getToolTip(b);return y=m(z),l.append(n),k.append(l),j.append(k),i.append(j),$("div",i).addClass(y).css(p),i.addClass("arcDraggable "+y),w||(w={}),i.css(w).css({color:q}),i.css("z-index",o),j.css({"z-index":o}),s&&s.ImageReference?i.css({backgroundColor:r}):j.css({backgroundColor:r}),k.css("z-index",o+1),c.mergeObjects(t,p,x,u,v),$("table",i).attr("cellspacing",0).css("z-index",o+1).css(t).addClass("dynaTable"),a.getObjType(b)==="Field"&&$("table",i).attr("cellpadding",0),A===g.WholeObject&&i.attr("title",h.toolTipStringForObject(B)),b[0].innerHTML=i[0].outerHTML,f.loadPattern(b,b.children(),d),null},l.buildHtmlForRows=function(b,d,e,f){var j=[],k=0,l=!1,m,n=a.getWidth(b),o=a.getColumnWidth(b),p=a.getWrapMode(b),q=a.getNumCols(b),r=a.getNumRows(b),u=a.getObjType(b),v=a.getToolTip(b),z=a.getToolTipType(b),A="";o&&(c.iterateArcplanArray(o,function(a,b){a==="Width"&&(j.push(Math.max(0,b-1)),k+=b)}),k===0&&o.Width&&(k=q*parseInt(o.Width,10)),l=q>0&&u==="Table"||u==="Row",m=n-k),d.Rows?c.iterateArcplanArray(d.Rows,function(a,d){var k=0,n,o,s=[],t=!1;c.iterateArcplanArray(d,function(a,c){var d;A="",z===g.EachColumn?A=h.toolTipStringForColumn(v,k):z===g.EachCell&&(A=h.toolTipStringForCell(v,f,k)),t=y(b,f,k,A),d=w(b,c,j[k],q,r,p,A,t),k+=1,s.push(d)}),l&&(n={value:"",Type:i.VChar},A="",o=w(b,n,m,q,r,p,A),s.push(o)),A=z!==g.EachRow?"":h.toolTipStringForRow(v,f),e[f]=x(s,A),f+=1}):a.getIsPassword(b)?e[f]='<tr class="invisibleInitialInputRow"><td>'+s("")+"</td></tr>":e[f]='<tr class="invisibleInitialInputRow"><td>'+t({value:""})+"</td></tr>"},l}),define("menuhtmlgenerator",["properties","propertytools","logger","tools","objectresizer","styleborderprops","patternapplier","browserfeatures","htmltemplates"],function(a,b,c,d,e,f,g,h,i){function k(a,b){var c=parseInt(a.r,10);return h.nativeTouchControls?a.Type==="0"?"<option disabled></option>":'<option value="'+c+'" '+(b===c?"selected>":">")+a.value.replace(/</g,"&#x003c;")+"</option>":a.Type==="0"?'<li class="arcMenuItem arcMenuSeparator"><div class="arcMenuSelectionDiv"><span></span></div><div class="arcMenuSeparator"></div></li>':'<li class="arcMenuItem" value="'+c+'" >'+'<div class="arcMenuSelectionDiv">'+(b===c?'<input type="checkbox" checked="checked">':"<span></span>")+'</div><div class="arcMenuItemText">'+a.value.replace(/</g,"&#x003c;")+"</div></li>"}function l(b){return a.getObjType(b)==="MenuHierarchie"?i.getHtmlTemplate("hierMenu"):h.nativeTouchControls?i.getHtmlTemplate("flatMenuNative"):i.getHtmlTemplate("flatMenu")}function m(a,b){var c=a.Rows.Elements.length,d,e;for(d=0;d<c;d+=1){e=parseInt(a.Rows.Elements[d].Row.Elements[0].Cell.r,10);if(e===b)return a.Rows.Elements[d].Row.Elements[0].Cell.value}return""}function n(a,b){var c=b.Selection;return c}function o(b,c){var d=a.getYSettingValue(b),e=m(c,d);return e}var j={};return j.setCurrentSelection=function(b,c){if(typeof b!="object")return;var d,e=a.getWrapMode(b);a.getObjType(b)==="Menu"?d=o(b,c,e):d=n(b,c,e),d=d.replace(/</g,"&#x003c;");if(!e||e.Value!=="SingleLine")d=d.replace(/\r\n/g,"<br />");$(".arcHierPopupSelection",b).html(d),e&&e.Value==="SingleLine"&&$(".arcHierPopupSelection",b).css("white-space","nowrap")},j.clearCurrentSelection=function(a){$(".arcHierPopupSelection",a).html("")},j.generateMenuStub=function(c,f){if(typeof c!="object")return;var h=l(c),i=$(h),j=a.getZIndex(c),k={left:"0px",top:"0px",position:"relative"},m=a.getForegroundColor(c),n=a.getBackgroundColor(c),o=a.getBackgroundColor2(c)||{},p=a.getForegroundColor2(c)||{},q={color:m?m:"transparent",backgroundColor:n},r={overflow:"visible","z-index":j},s=a.getFont(c),t=a.getPopupFont(c)||{},u={},v={color:p,backgroundColor:o},w={};d.mergeObjects(r,q,k,s),i.css(r),b.setVerticalAlignment(c,u),b.setHorizontalAlignment(c,u),a.getSelectType(c)==="HierMultiSelect"&&($(".arcHierPopup",i).addClass("arcHierPopupMultisel"),$(".arcHierPopupDlg",i).css({visibility:"visible","background-color":o})),$(".arcHierPopupSelection",i).css(u),d.mergeObjects(w,t,v),$(".arcHierPopupContent",i).css(w),a.isOneDimHasSumKnotLast(c)&&$(".arcHier",i).addClass("arcSumKnotLast"),c[0].innerHTML=i[0].outerHTML,g.loadPattern(c,c.children(),f),g.applyDropdownSymbol(c,f),e.applyObjectDimensionsWithoutScrollDepConUpdate(c)},j.buildHtmlForRows=function(b,c,e){if(typeof b!="object")return;var f=a.getYSettingValue(b);c&&c.Rows&&typeof e=="object"&&d.iterateArcplanArray(c.Rows,function(a,b){var c;c=k(b.Elements[0].Cell,f),e[parseInt(b.Elements[0].Cell.r,10)-1]=c})},j.buildHtmlForRowsWithFilter=function(b,c,e,f){if(typeof b!="object")return;var g=a.getYSettingValue(b),h=0;c&&c.Rows&&typeof e=="object"&&d.iterateArcplanArray(c.Rows,function(a,b){e[f+h]=k(b.Elements[0].Cell,g),h+=1})},j.buildHtmlForStringsArray=function(a){var b="";return a&&a.Elements&&d.iterateArcplanArray(a,function(a,c){var d,e={},f=-1;e.r=a,e.value=c,d=k(e,f),b+=d}),b},j}),define("hierarchyhtmlgenerator",["properties","propertytools","logger","tools","objectresizer","styleborderprops","patternapplier","browserfeatures"],function(a,b,c,d,e,f,g,h){function j(a,b){var c,d;return a.nextDim&&b.canApplyDimensionWidth?(d=b.showRootNode?a.level:a.level-1,c=b.dimensionWidth-i.c_textPadding-d*i.c_openCloseSymbolWidth,c<0&&(c=0)," class='arcTextOverflowEllipsis' style='width:"+c+"px'"):""}function k(a,c,d,e){var f="",g=j(a,c);return d&&(f="<div class='arcLabelContainer ",f+=a.nextDim&&b.getHierFormatByDim(e,a.nextDim.dim).isSumKnotLast?" arcTableCellBottom'>":" arcTableCellTop'>"),f+="<input type='checkbox' id='",f+=a.id,f+="' ",f+=a.isOpen?"checked>":">",f+="<label for='"+a.id+"'"+g+">",f+="<span class='SPAN_"+a.dim+"_"+a.level+"'></span>",f+=a.Value.replace(/</g,"&#x003c;"),f+="</label>",d&&(f+="</div>"),f}function l(c,d,e,f){var g="",h=j(c,d),i=e&&a.getDimensionNumber(f)>1;return i&&(g="<div class='arcLabelContainer ",g+=c.nextDim&&b.getHierFormatByDim(f,c.nextDim.dim).isSumKnotLast?" arcTableCellBottom'>":" arcTableCellTop'>"),g+="<a id='",g+=c.id,g+="' "+h+">",g+="<span class='SPAN_"+c.dim+"_"+c.level+"'></span>",g+=c.Value.replace(/</g,"&#x003c;"),g+="</a>",i&&(g+="</div>"),g}function m(a){var b,d=a.hasChildrenSelected&&!a.isOpen,e=d?" arcHiddenSubtreeSelected":"";return d===!0&&c.log("hasHiddenChildrenSelected fr Node= "+a.Value),b="<label class='arcSelectable'>",b+="<input type='checkbox' id='"+a.id+"_X"+"' class='arcHpCbox"+e+"'",b+=a.isSelected||d?' checked="checked">':" >",b+="</label>",b}function n(c,d,e,f,g,h){var i=!1,j=f.length,q=!1,r=g?a.isAllowOpenClose(g):!1,s=g?a.getObjType(g)==="MenuHierarchie":!1,t=g?a.getSelectType(g)!=="HierNoSelect":!0,u,v,w,x=!1,y=!1,z=!1,A=!1,B=b.getHierFormatByDim(g,c.dim),C=B.isSumKnotLast,D=a.isOneDimHasSumKnotLast(g)&&a.getDimensionNumber(g)>1;typeof h!="object"&&(h={value:!1});if(c.row>d)if(!C||!(c.children.length>0||c.nextDim))return e;if(j>0){if(c!==f[j-1])return e;f.pop(),f.length===0&&(q=!0)}return e||(e=""),c.parent||(i=!0),i&&(e+="<ol",c.isFirstLevelOfDimension&&!c.parent.host?e+=" style='margin-left: 1px;margin-right: -1px;'":D&&c.dim>1&&(e+=" style='display:table-cell'"),B.canApplyDimensionWidth&&(e+=" class='arcDimensionWidth'"),e+=">"),typeof c.Value=="string"&&c.id?(e+="<li",e+=" id='"+c.id+"_LI'",v=o(g,c,C,h,s),e+=v?" style='"+v+"'":"",u=c.isSelected&&!s&&t?"arcHier-selected ":"",u+=q?"firstVisible":"",u+=u?" ":"",u+="LI_"+c.dim+"_"+c.level,e+=u?" class='"+u+"' >":">",s&&(C&&c.hasInput&&r?z=!0:e+=m(c)),c.hasInput&&r?C?x=!0:e+=k(c,B,D,g):C?y=!0:e+=l(c,B,D,g),c.nextDim&&(C?A=!0:e=n(c.nextDim,d,e,f,g)),c.children.length>0&&(e+="<ul>",e=p(c,d,e,f,g),e+="</ul>"),y&&(e+=l(c,B,D,g)),z&&(e+=m(c)),x&&(e+=k(c,B,D,g)),A&&(e=n(c.nextDim,d,e,f,g)),e+="</li>"):i&&(e=p(c,d,e,f,g)),i&&(e+="</ol>"),h.value=!1,e}function o(b,c,d,e,f){var g=a.getForegroundColors(b),h,i="";return c.isFirstLevelOfDimension&&(c.parent.host&&e.value?i="border-top-width:0px;border-left-width:1px;":d&&a.getDisplayStyle(b)==="BOX_STYLE"?i="border-left-width:1px;":i="border-top-width:1px;border-left-width:1px;"),g&&g.Elements.length>0?i:(f?h=a.getForegroundColor2(b):h=a.getForegroundColor(b),h?i+"color:"+h+";":i)}function p(a,b,c,d,e){if(typeof a.children=="object"){var f,g=a.children.length,h={value:!0};for(f=0;f<g;f+=1)c=n(a.children[f],b,c,d,e,h)}return c}var i={};return i.c_textPadding=4,i.c_openCloseSymbolWidth=13,i.writeToHtmlStartingHere=function(a,b,c,d,e){return d||(d=[]),a&&typeof a=="object"&&typeof a.row=="number"&&(d.push(a),a.parent?c=this.writeToHtmlStartingHere(a.parent,b,c,d,e):a.host?c=this.writeToHtmlStartingHere(a.host,b,c,d,e):c=n(a,b,c,d,e)),c},i.generateHierarchyStub=function(b,c,h){var i=$("<div></div>"),j=$("<div></div>"),k=$("<div></div>"),l=$("<div></div>"),m=$("<ol></ol>"),n=a.getZIndex(b),o={left:"0px",top:"0px",position:"relative"},p=a.getForegroundColor(b),q=a.getBackgroundColor(b),r={color:p,backgroundColor:q},s={},t={},u=a.getFont(b),v=f.getBorderStyleObject(b),w,x=a.getObjType(b),y=a.getDisplayStyle(b),z=y==="BOX_STYLE"?"arcBox":"arcTree",A=a.isOrganigram(b)?"arcVertBeside":"",B=a.isAllowOpenClose(b)===!1?"arcVertNoExp":"",C=a.getGridType(b),D=y==="BOX_STYLE"&&C==="both"?"arcLine":"",E,F=e.getHorizontalAdjustment(a.getBorder(b),b),G,H=a.isOneDimHasSumKnotLast(b)?"arcSumKnotLast":"";return w="dynaVertHier",l.append(m),k.append(l),j.append(k),i.append(j),j.css(o),c&&(G=a.getWidth(b)-F,E=Math.max(G,c),t.width=E+"px"),d.mergeObjects(t,o,{overflow:"hidden"}),k.css(t),i.addClass("arcDraggable "+w),v||(v={}),d.mergeObjects(s,o,u,v,r,{zIndex:n}),i.css(s),j.css(o),l.addClass("arcHier arcVert "+z+" "+A+" "+B+" "+D+" "+H),b[0].innerHTML=i[0].outerHTML,g.loadPattern(b,b.children(),h),e.applyObjectDimensionsWithoutScrollDepConUpdate(b),null},i}),define("hierarchydatavirtualization",["properties","logger","tools","browserfeatures","datavirtualizationhelper","hierarchyhtmlgenerator","htmltohiernodeparser","hierdatatohiernodeparser","hiernode","menuhtmlgenerator","popupcalculator","menuhierarchyviewmodel","popuphandler"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function u(a,b){var c,d,e;if(b){if(b.row===a)return b;if(b.nextDim&&typeof b.nextDim.row=="number"){c=u(a,b.nextDim);if(c)return c}if(b.children.length>0){d=b.children.length;for(e=0;e<d;e+=1){c=u(a,b.children[e]);if(c)return c}}}return c}function v(b,c,d,f,g,h,i){var j=Math.round(a.getRowHeight(b)),k,l,m,o,p,q=e.getDatavirtualizationProperties(b),r=$(".arcHier",b),s=a.getBorder(b),t=a.getGridType(b),u={};return k=q.pageSize||n,l=Math.floor(k*j),m=f*l,g.height!==d&&(m-=(h.height-g.height)*g.top/(g.height-d),m=Math.max(m,0)),p=$(".firstVisible",c).position(),o=p?p.top:0,r.hasClass("arcBox")&&t==="both"&&o>0&&(o-=1),u={position:"relative",top:Math.max(Math.floor(m)-o,0)+"px",height:i*j+o+"px"},$("ol:first",b).css(u),u}function w(a,b,c,d,e){var g,h,i,j,k,l,m="";if(b.rowIndex){for(h=c;h<d;h+=1)i=b.rowIndex[h],typeof i=="object"?j||(j=i):(k=k!==undefined?k:h,l=h);typeof j=="object"&&(m=f.writeToHtmlStartingHere(j,d,m,null,a)),e.Start=k,e.End=l}else g=u(c,b.allRows.Root),typeof g=="object"&&(m=f.writeToHtmlStartingHere(g,d,m,null,a));return m}function x(b,c,d){var f=e.getDatavirtualizationProperties(b);d&&(f.allRows.Root=i.mergeNodes(f.allRows.Root,h.buildHierarchyDimension(d.ObjectData)),f.rowIndex=i.getRowIndex(f.allRows.Root),a.getObjType(b)==="MenuHierarchie"&&l.applySelectionsToHierarchy(b),c>0&&(r.updatePages(b,$(".arcHier",b),a.getScrollElem(b)),s.applyHierProperties(b,!0)))}function y(a,b,c){var d,e,f;typeof c.End!="undefined"&&typeof c.Start!="undefined"&&(f=c.End-c.Start+1,d=Math.floor(c.Start/o),e=Math.floor(c.End/o),b.requestProcessor&&b.requestProcessor.requestHierData(a,b.objectDataHash,c.Start,f,x))}function z(b,d,e,f,g,h){var i,j,k,l,o,p,q=Math.round(a.getRowHeight(b)),r,s=g.NumHierRows,t,u,x,z={},A=0,B=g.pageSize||n,C;j=B*q,t=Math.floor(h.top/j),u=Math.floor((h.top+f)/j),k=t*B,l=Math.min(s,(u+1)*B);if(k!==g.firstElementInDOM||l!==g.lastElementInDOM){i=w(b,g,k,l,z);if(a.getObjType(b)!=="MenuHierarchie"||m.isCurrentPopup(b))d[0].innerHTML=i;g.firstElementInDOM=k,g.lastElementInDOM=z.End!==undefined?z.End:l,y(b,g,z),A=z.End-z.Start+1,x=l-k-(A||0),C=v(b,d,f,t,e,h,x),g.innerHTML=i.replace(/^<ol>/,"<ol style='"+c.styleAsStringFromObject(C)+"'>")}}function A(a,b,c,d){a.checkedElements=[],a.allRows=[],a.firstElementInDOM=-1,a.lastElementInDOM=-1,a.rowIndex=null,a.requestProcessor=b,a.pageSize=d,b&&typeof b=="object"&&typeof b.removeHashFromObjectDataRequestList=="function"&&(b.objectDataHash?b.removeHashFromObjectDataRequestList(b.objectDataHash):b.removeHashFromObjectDataRequestList(c)),a.objectDataHash=c}function B(a,b,c,d){var e=document.createElement("div"),f,h=[0];e.innerHTML=d,f=$(e.getElementsByTagName("ol")[0]),b.Root=g.buildHierarchyDimension(f,a,h),h[0]+=1,c.allRows=b,c.NumHierRows=h[0]}function C(b,c,d,e){var f;c.Root=h.buildHierarchyDimension(e.ObjectData?e.ObjectData:e),d.allRows=c,d.NumHierRows=a.getNumRows(b),d.rowIndex=i.getRowIndex(c.Root),e.ObjectData&&e.ObjectData.Width?f=parseInt(e.ObjectData.Width,10):f=parseInt(e.Width,10),a.setContentWidth(b,f)}function D(b,c,d,e){var f;c.Root=h.buildHierarchyDimension(e.ObjectData?e.ObjectData:e),d.allRows=c,d.NumHierRows=a.getNumRows(b),d.rowIndex=i.getRowIndex(c.Root),e.ObjectData&&e.ObjectData.Width?f=parseInt(e.ObjectData.Width,10):f=parseInt(e.Width,10),d.menuContentWidth=Math.max(f+q,t)}function E(b,c){var d=a.getHeight(c)-1;return a.getObjType(c)==="MenuHierarchie"&&(d=k.getPopupRect(c).height),d}var n=100,o=100,p=5,q=17,r={},s,t=165;return require(["objectpropertyapplier"],function(a){s=a}),r.updatePages=function(b,c,f){var g=e.getDatavirtualizationProperties(b),h=g.NumHierRows,i=Math.round(a.getRowHeight(b)),j=g.pageSize||n,k=j*i,l,m,o=c.hasClass("arcLine")?1:0,p={height:h*i+o},q,r;m=E(f,b),l={top:a.getScrollY(b)||0,height:Math.min(d.c_DivSizeLimit,p.height)},e.validateScrollPos(l,p,b),l.bottom=l.height-m-l.top,c.parent().height(l.height),e.convertScrollParams(l,p,m),k>0&&z(b,c,l,m,g,p)},r.init=function(c,d,g,h,i){var j,k={},l,m,n;return l=e.getDatavirtualizationProperties(c),A(l,h,g,i),a.isAllowOpenClose(c)!==!1&&a.setAllowOpenClose(c,!0),typeof d=="string"?B(c,k,l,d):typeof d=="object"&&(C(c,k,l,d),f.generateHierarchyStub(c,n,h),d=null),m=Math.floor(a.getHeight(c)/a.getRowHeight(c)),m>=l.NumHierRows&&(a.setYSettingValue(c,0),a.setScrollY(c,0)),b.log("Initialized data virtualization (Hierarchy) for obj "+a.getID(c)),d},r.update=function(c,d,f,g,h){var i={},j,k;return j=e.getDatavirtualizationProperties(c),A(j,g,f,h),a.isAllowOpenClose(c)!==!1&&a.setAllowOpenClose(c,!0),typeof d=="string"?B(c,i,j,d):typeof d=="object"&&(C(c,i,j,d),d=null),k=Math.floor(a.getHeight(c)/a.getRowHeight(c)),k>=j.NumHierRows&&(a.setYSettingValue(c,0),a.setScrollY(c,0)),b.log("Initialized data virtualization (Hierarchy) for obj "+a.getID(c)),d},r.initForHierarchyMenu=function(c,f,g,h,i){var l=e.getDatavirtualizationProperties(c),m,n={};return typeof f!="object"?f:(A(l,h,g,i),a.isAllowOpenClose(c)!==!1&&a.setAllowOpenClose(c,!0),j.generateMenuStub(c,h),j.setCurrentSelection(c,f),d.nativeTouchControls||(m=k.getPopupRect(c).height,$(".arcPopupContent",c).height(m)),D(c,n,l,f),b.log("Initialized data virtualization (menuhierarchy) for obj "+a.getID(c)+" with "+l.rowIndex.length+" entries"),null)},r.updateHierarchyMenu=function(c,f,g,h,i){var l=e.getDatavirtualizationProperties(c),m,n={};return typeof f!="object"?f:(A(l,h,g,i),a.isAllowOpenClose(c)!==!1&&a.setAllowOpenClose(c,!0),j.setCurrentSelection(c,f),m=k.getPopupRect(c).height,d.nativeTouchControls||$(".arcPopupContent",c).height(m),D(c,n,l,f),b.log("Initialized data virtualization (menuhierarchy) for obj "+a.getID(c)+" with "+l.rowIndex.length+" entries"),null)},r}),define("datavirtualization",["properties","logger","tools","tablehtmlgenerator","menuhtmlgenerator","browserfeatures","hierarchydatavirtualization","datavirtualizationhelper","popupcalculator","popupkeyeventhandler","menuhierarchyviewmodel","buttonhtmlgenerator","checkboxhtmlgenerator","radiobuttonhtmlgenerator"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function s(a,b,c,d){var e,f,g,h,i="";for(f=b;f<c;f+=1)e=a.allRows[f],typeof e=="string"?i+=a.allRows[f]:(g=g!==undefined?g:f,h=f);return d.Start=g,d.End=h,i}function t(b,c,d){var e,f,g;typeof d.End!="undefined"&&typeof d.Start!="undefined"&&(g=d.End-d.Start+1,e=Math.floor(d.Start/p),f=Math.floor(d.End/p),c.requestProcessor&&(a.getObjType(b)==="Menu"?c.isFilterResult||c.requestProcessor.requestObjectData(b,c.objectDataHash,d.Start,g,O):c.requestProcessor.requestObjectData(b,c.objectDataHash,d.Start,g,N)))}function u(b,c,d,e,f,g,i){var j=Math.round(a.getRowHeight(b)),k=h.getDatavirtualizationProperties(b),l=k.pageSize||o,m=Math.floor(l*j),n=c*m;e.height!==g&&(n-=(d.height-e.height)*e.top/(e.height-g),n=Math.max(n,0)),f.css({top:n+"px",height:Math.floor(i*j)+"px"})}function v(a,b,c){if(a.length>0){var d=$("tbody",c);d.length>0?f.canUseInnerHTMLOnTable?d[0].innerHTML=b:c[0].replaceChild($("<tbody>"+b+"</tbody>")[0],a[0]):a[0].innerHTML=b}}function w(b,c){var d=a.getHeight(c)-1;return a.getObjType(c)==="Menu"&&(d=i.getPopupRect(c).height),d}function x(b){return a.getObjType(b)==="Row"?a.getHeight(b)-1:Math.round(a.getRowHeight(b))}function y(b,c,d,e,g){var i,j,k,l,m={},n=0,p,q=a.getNumRows(b)||d.allRows.length,r,y,z,A,B=w(g,b),C,D=d.pageSize||o,E=a.getPattern(b),F=E&&E.ImageReference;p=x(b),j=Math.floor(D*p),z={height:Math.floor(q*p)+(a.getExtraScrollHeight(b)||0)},A={top:a.getScrollY(b)||0,height:z.height<f.c_DivSizeLimit?z.height:g.children(":first").height()||z.height},h.validateScrollPos(A,z,b),A.bottom=A.height-B-A.top,h.convertScrollParams(A,z,B),c.parent().height(z.height+(F?1:0)),r=Math.floor(z.top/j),y=Math.floor((z.top+B)/j),k=r*D,l=Math.min(q,(y+1)*D),i="";if(k!==d.firstElementInDOM||l!==d.lastElementInDOM)i=s(d,k,l,m),v(e,i,c),d.firstElementInDOM=k,d.lastElementInDOM=m.End!==undefined?m.End:l,t(b,d,m),n=m.End-m.Start+1;C=l-k-(n||0),u(b,r,z,A,c,B,C)}function z(b,c){var d,e,f=a.getDatavirtualizationProperties(b),g;d=$("tr:nth-child("+(c.y+1-f.firstElementInDOM)+")",b),$("td.selected",b).removeClass("selected"),b[0].id===a.getDocSelectedObject(b.closest(".arcContainer"))&&(g=$("#arcTextInput").length===1,g||b.children(":first").focus(),d.length>0&&(e=$("td:nth-child("+(c.x+1)+")",d),e.length>0&&e.addClass("selected")))}function A(b,c,d,e){var f,g,i,j,k=a.getSelectedCell(b);f=h.getDatavirtualizationProperties(b),g=Math.round(a.getRowHeight(b)),j=f.pageSize||o,i=Math.floor(j*g),i>0?(y(b,d,f,c,e),k&&z(b,k)):(f.firstElementInDOM=-1,f.lastElementInDOM=-1,c.html(""))}function B(b,c,d){var e,f,g="",h,i,j=a.getSelectedCell(b);N(b,0,d,c.requestProcessor),i=c.allRows.length;for(e=0;e<i;e+=1)g+=c.allRows[e];v($("tbody",b),g,$("table",b)),i>0&&(c.firstElementInDOM=0,c.lastElementInDOM=i-1),j&&z(b,j)}function C(b,c,e){var f,g=a.getObjType(b);return g==="CheckboxGroup"?f=m.generateStub(b,c.requestProcessor):f=d.generateTableStub(b,c.requestProcessor),B(b,c,e),f}function D(a,b,c,d){a.allRows=[],a.firstElementInDOM=-1,a.lastElementInDOM=-1,a.checkedElements=[],b&&typeof b=="object"&&typeof b.removeHashFromObjectDataRequestList=="function"&&(b.objectDataHash?b.removeHashFromObjectDataRequestList(b.objectDataHash):b.removeHashFromObjectDataRequestList(c)),a.objectDataHash=c,a.requestProcessor=b,a.pageSize=d}function E(c,d,e,f,g){function k(a){i.allRows.push(a.outerHTML)}var i,j;i=h.getDatavirtualizationProperties(c),D(i,f,e,g);if(typeof d=="object")j=C(c,i,d);else{j=L(d,"tbody","tr",k);if(j===null)return d}return b.log("Initialized data virtualization (table) for obj "+a.getID(c)+" with "+i.allRows.length+" rows"),j}function F(c,d,e,f,g){function k(a){i.allRows.push(a.outerHTML)}var i,j=null;return i=h.getDatavirtualizationProperties(c),D(i,f,e,g),typeof d=="object"&&B(c,i,d),b.log("Initialized data virtualization (table) for obj "+a.getID(c)+" with "+i.allRows.length+" rows"),j}function G(b,c){var d=b.clone(),f=e.buildHtmlForStringsArray(c),g,h=$("ul",d);return h.length>0&&c&&c.Elements&&c.Elements.length>0?(d.appendTo("body").css("visibility","hidden"),$(".arcPopupContent",d).css("display","inline-block"),$(".arcPopupContent",d).removeClass("arcMenu"),$(".arcPopupContent > div",d).removeClass("arcMenu"),h[0].innerHTML=f,g=h.width(),d.remove()):g=a.getWidth(b),g}function H(b,c,d){var g,h="",j,k,l=d.a,m,n=a.getNumRows(b);c.menuContentWidth=G(b,l),m=i.getPopupRect(b).height,f.nativeTouchControls||$(".arcPopupContent",b).height(m);if(d.Rows&&d.Rows.Elements&&d.Rows.Elements.length>0){e.setCurrentSelection(b,d),k=parseInt(d.Rows.Elements[0].Row.Elements[0].Cell.r,10)-1,O(b,k,d,c.requestProcessor,!0),j=d.Rows.Elements.length;for(g=k;g<k+j;g+=1)h+=c.allRows[g];f.nativeTouchControls?$("select",b)[0].innerHTML=h:$("ul",b)[0].innerHTML=h,j>0&&(c.firstElementInDOM=k,c.lastElementInDOM=k+j-1),f.nativeTouchControls&&(c.firstElementInDOM!==0||c.lastElementInDOM!==n-1)&&t(b,c,{Start:0,End:n})}else e.clearCurrentSelection(b)}function I(a,b,c){var d=e.generateMenuStub(a,b.requestProcessor);return H(a,b,c),d}function J(c,d,e,f){function k(a,b){var c,d;c=a.getElementsByClassName("arcMenuItemText")[0];if(!c)return;d=c.innerHTML.length,(i.length<100||d>i[0].textLength)&&i.push({textLength:d,html:b}),i.length>99&&d>i[0].textLength&&(i.sort(function(a,b){return a.textLength-b.textLength}),i.splice(0,1))}function l(){var a,b,c,d;c="";for(b in i)c+=i[b].html;return a=$(g),a.appendTo("body").css("visibility","hidden"),$(".arcPopupContent",a).css("display","inline-block"),$("ul",a).html(c),d=$("ul",a).width(),a.remove(),d}function m(a,b){var c,d;c=a.outerHTML,j.allRows.push(c),d=a.getElementsByTagName("input")[0],d&&d.checked&&j.checkedElements.push(b),k(a,c)}var g,i,j;i=[],j=h.getDatavirtualizationProperties(c),D(j,f,e);if(typeof d=="object")g=I(c,j,d);else{g=L(d,"ul","li",m);if(g===null)return d;j.menuContentWidth=l()}return a.setScrollY(c,0),b.log("Initialized data virtualization (menu) for obj "+a.getID(c)+" with "+j.allRows.length+" entries"),g}function K(a,b,c,d){var e;e=h.getDatavirtualizationProperties(a),D(e,d,c),typeof b=="object"&&H(a,e,b)}function L(a,b,c,d){var e,f,g,h,i;e=document.createElement("div"),e.innerHTML=a,f=e.getElementsByTagName(b)[0];if(typeof f=="undefined")return null;g=f.getElementsByTagName(c),h=g.length;for(i=0;i<h;i+=1)d(g[i],i);return f.innerHTML="",e.innerHTML}function M(b){b.find(".arcPopupContent").css({"background-color":a.getBackgroundColor2(b)}),f.nativeTouchControls||b.find(".arcMenu").css({height:Math.round(a.getRowHeight(b))*a.getNumRows(b)+"px"}),b.find(".arcMenu > ul").css({position:"absolute"})}function N(b,c,e){var f=h.getDatavirtualizationProperties(b),g=f.allRows,i=c,j=a.getObjType(b);e&&(j==="CheckboxGroup"?m.buildHtmlForRows(b,e,g,i):d.buildHtmlForRows(b,e,g,i),c>0&&r.updatePosition(b))}function O(a,b,c,d,f){var g=h.getDatavirtualizationProperties(a),i=g.allRows,j=b;c&&(e.buildHtmlForRows(a,c,i,j),f||r.updatePosition(a))}function P(a){$(".arcMenuFilterInputContainer",a).addClass("loadingFilterResult")}function Q(a){$(".arcMenuFilterInputContainer",a).removeClass("loadingFilterResult")}function R(b){var c=$(".arcHierPopupContent",b),d=i.getPopupRect(b),e={height:d.height+"px",top:d.top+"px"};d.height===1?(e.visibility="hidden",c.css(e)):(e.visibility="visible",c.css(e),a.setLastSelectedItem(b,undefined),c.scrollTop()>0?c.scrollTop(0):r.updatePosition(b),$(".arcMenuItem:first",c).addClass("arcMenuItemSelected"))}function S(b,c,d,f,g){var i=h.getDatavirtualizationProperties(b),j=c;i.filterToken===""?R(b):d&&(i.isFilterResult=!0,i.allRows=[],i.checkedElements=[],i.firstElementInDOM=-1,i.lastElementInDOM=-1,d.NumCols="1",d.NumRows=0,d.Rows&&d.Rows.Elements&&(d.NumRows=d.Rows.Elements.length),a.setNumRows(b,d.NumRows),e.buildHtmlForRowsWithFilter(b,d,i.allRows,j),R(b)),Q(b)}var o=100,p=100,q,r={};return require(["objectpropertyapplier"],function(a){q=a}),r.requestMenuFilterResult=function(a,b){var c=0,d=100,e=h.getDatavirtualizationProperties(a),f;d=1e5,e.filterToken=b,f=e.requestProcessor.requestObjectDataWithFilter(a,e.objectDataHash,c,d,b,S),f&&P(a)},r.updatePosition=function(b){if(!h.isDatavirtualizationActiveForObject(b))return;var c=a.getObjType(b),d=h.getDatavirtualizationProperties(b),e=d.requestProcessor;switch(c){case"Table":case"Row":case"Column":case"CheckboxGroup":A(b,$("tbody",b),$("table",b),a.getScrollElem(b)),q.adjustTableSize(b,c),q.applyTableColumnWidth(b,c),q.updateImageRefs(e,b);break;case"Menu":A(b,$("ul",b),$("ul",b),$(".arcPopupContent",b)),M(b),j.resetSelectedItemInDOM(b);break;case"MenuHierarchie":case"VerticalHierarchie":if(c!=="MenuHierarchie"||d.allRows)a.getObjType(b)==="MenuHierarchie"&&k.applySelectionsToHierarchy(b),g.updatePages(b,$(".arcHier",b),a.getScrollElem(b)),q.applyHierProperties(b,!0);break;default:}},r.init=function(b,c,d,e,f){if(!h.isDatavirtualizationActiveForObject(b))return c;var i=a.getObjType(b),j,k;switch(i){case"Field":case"Table":case"Row":case"Column":case"CheckboxGroup":if(i==="Field"&&typeof c=="string")return c;return typeof c=="object"&&a.setUseContentPaging(b,!0),j=E(b,c,d,e,f),j;case"Menu":return j=J(b,c,d,e,f),j;case"MenuHierarchie":if(typeof c=="string")return c;return a.setUseContentPaging(b,!0),j=g.initForHierarchyMenu(b,c,d,e,f),j;case"VerticalHierarchie":return typeof c=="object"&&a.setUseContentPaging(b,!0),j=g.init(b,c,d,e,f),j;case"Switch":case"Button":if(typeof c=="string")return c;return l.generateStub(b),l.generateContent(b,c),null;case"RadioGroup":if(typeof c=="string")return c;return n.generateStub(b),k=n.buildHtmlContent(b,c),v($("tbody",b),k,$("table",b)),null;default:return c}},r.update=function(b,c,d,e,f){if(!h.isDatavirtualizationActiveForObject(b))return c;var i=a.getObjType(b),j,k;switch(i){case"Field":case"Table":case"Row":case"Column":case"CheckboxGroup":if(i==="Field"&&typeof c=="string")return c;return typeof c=="object"&&a.setUseContentPaging(b,!0),j=F(b,c,d,e,f),j;case"Menu":return j=K(b,c,d,e,f),j;case"MenuHierarchie":if(typeof c=="string")return c;return a.setUseContentPaging(b,!0),j=g.updateHierarchyMenu(b,c,d,e,f),j;case"VerticalHierarchie":return typeof c=="object"&&a.setUseContentPaging(b,!0),j=g.update(b,c,d,e,f),j;case"Switch":case"Button":if(typeof c=="string")return c;return l.generateContent(b,c),null;case"RadioGroup":if(typeof c=="string")return c;return k=n.buildHtmlContent(b,c),v($("tbody",b),k,$("table",b)),null;default:return c}},r}),define("scroll",["jquery","tools","stringtools","logger","properties","browserfeatures","textinput","objectresizer","scrollobserver","datavirtualization"],function(a,b,c,d,e,f,g,h,i,j){function o(b,c,d){var e,f,g,h=null,i;i=a("embed",d).get();if(i.length>0){e=i[0].getSVGDocument();if(e){f=e.getElementsByTagName("g");if(f){b||(b="0"),c||(c="0");for(g=0;g<f.length;g+=1)if(f[g]){switch(f[g].getAttribute("Scroll")){case"vert":h="translate(0,-"+c+")";break;case"hor":h="translate(-"+b+",0)";break;case"both":h="translate(-"+b+",-"+c+")";break;default:h=null}h&&f[g].setAttribute("transform",h)}}}}}function p(a,b){var c,f=!b.hasClass("arcHide-scrollbar-hori"),g=!b.hasClass("arcHide-scrollbar-vert"),h=e.getScrollHeight(a),n=e.getScrollWidth(a),o=b.height(),p=b.width();d.log("adding Touch event handler to "+e.getDocName(a)+":"+e.getID(a)),b.addClass("wrapper"),b.children("div").not(".arcIETransparentBackgroundFix").addClass("scroller"),c=e.getIScrollInstance(a),c&&c.destroy(),c=new window.iScroll(b[0],{bounce:!1,hideScrollbar:!0,hScrollbar:f,vScrollbar:g,onBeforeScrollStart:function(a){a.changedTouches&&a.changedTouches.length>1&&a.preventDefault()},onScrollStart:function(){l||i.addScrolledObject(a),this.isEventObj=!0,this.lastPos===undefined&&(this.lastPos={left:0,top:0},this.scrollBarObj={vert:null,hori:null},this.scrollRefs={vert:null,hori:null}),this.scrollBarObj.vert=e.getScrollBarObjVert(a)||a,this.scrollBarObj.hori=e.getScrollBarObjHori(a)||a,e.getScrollRefs(this.scrollBarObj.vert)&&(this.scrollRefs.vert=e.getScrollRefs(this.scrollBarObj.vert).vert),e.getScrollRefs(this.scrollBarObj.hori)&&(this.scrollRefs.hori=e.getScrollRefs(this.scrollBarObj.hori).hori)},onScrollEnd:function(){this.isEventObj=!1,e.setScrollX(a,-this.x),e.setScrollY(a,-this.y),j.updatePosition(a),m=!1},onScrollMove:function(b,c,d){var f,g={left:0-(c||0),top:0-(d||0)},i,l=d===0,m=0-d+o>=h,q=c===0,r=0-c+p>=n,s;b&&(h&&!l&&!m||n&&!q&&!r)&&b.preventDefault(),e.setScrollX(a,g.left),e.setScrollY(a,g.top),this.lastPos.top!==g.top?(i=this.scrollRefs.vert,this.scrollBarObj.vert&&(s=e.getIScrollInstance(this.scrollBarObj.vert))):this.lastPos.left!==g.left&&(i=this.scrollRefs.hori,this.scrollBarObj.hori&&(s=e.getIScrollInstance(this.scrollBarObj.hori))),this.lastPos=g,s&&s.isEventObj===!1&&s.scrollTo(c,d);if(i)for(f=0;f<i.length;f+=1)s=e.getIScrollInstance(i[f]),s&&s.isEventObj===!1?s.scrollTo(c,d):e.getObjType(i[f])==="SVGContainer"&&k.scrollTo(i[f],undefined,-c,-d);j.updatePosition(a)}}),e.setIScrollInstance(a,c)}function q(a,b,c){var d;for(d=0;d<a.length;d+=1)k.scrollTo(a[d],undefined,b,c)}function r(b){var c=function(){var c,d,h,o,p;b.data.ref&&(l||i.addScrolledObject(b.data.ref),c=e.getScrollRefs(b.data.ref),d=e.getScrollElem(b.data.ref),d&&d[0]&&(f.mobile&&b.originalEvent.preventDefault(),o=d[0].scrollLeft,p=d[0].scrollTop,e.setScrollX(b.data.ref,o),e.setScrollY(b.data.ref,p),c&&(q(c.vert,undefined,p),q(c.hori,o,undefined),c.vert.length===0&&(h=e.getScrollBarObjVert(b.data.ref),h&&k.scrollTo(h,undefined,undefined,p)),c.hori.length===0&&(h=e.getScrollBarObjHori(b.data.ref),h&&k.scrollTo(h,undefined,o,undefined))),a("#arcTextInput").length===1&&g.recalcInputPosition(b.data.ref),m||n.onScroll(),j.updatePosition(b.data.ref))),m=!1},d=!1;d=typeof e.getScrollRequestId(b.data.ref)!="undefined"?e.getScrollRequestId(b.data.ref):!1,ARCPLAN.scrollDirectly?c():(d&&window.cancelAnimationFrame(d),d=window.requestAnimationFrame(c),e.setScrollRequestId(b.data.ref,d))}function s(b){var c;ARCPLAN.datavirtualization!==!1&&(e.getObjType(b)==="Menu"||e.isUseContentPaging(b))&&(e.getObjType(b)==="Menu"?c=a(".arcPopupContent",b):c=a(".arcHierPopupInnerDiv",b),c.off("scroll.menuscroll"),c.on("scroll.menuscroll",function(){e.setScrollY(b,a(this).scrollTop()),j.updatePosition(b)}))}function t(a){var b=e.getObjType(a);return b==="MenuHierarchie"||b==="Menu"}function u(a){var b;b=e.getScrollElem(a),t(a)?s(a):b&&b[0]&&e.getObjType(a)!=="SVGContainer"&&(e.getScrollHeight(a)||e.getScrollWidth(a))&&(f.mobile&&window.iScroll?p(a,b):(b.off("scroll",r),b.on("scroll",{ref:a},r)))}function v(b,d,f){var g=e.getDocName(b),h=e.getScrollDeps(b),i,j,k;if(h)for(i=0;i<h[f].length;i+=1)j=c.makeID(g,h[f][i]),k=a("#"+j),k.length!==0&&d.indexOf(k)===-1&&(z(k)&&d.push(k),v(k,d,f))}function w(a,b){v(a,b,"vert")}function x(a,b){v(a,b,"hori")}function y(a,c){function d(a){var b=e.getScrollElem(a),c=!1,d=e.getObjType(a),f=e.getColumnWidth(a),g=e.getWidth(a),h=e.getHScrollBarAllowed(a);if(!h)return!1;switch(d){case"Table":case"Row":if(f.accumulatedColumnWidth>g)return!0;return!1;case"Field":return!1;default:return b&&(c=b.css("overflow-x")==="auto"),c&&b[0].clientWidth<b[0].scrollWidth}}function g(a,b){var c=e.getScrollElem(a),d,g,h=e.getObjType(a);if(!c)return;d=e.getExtraScrollHeight(a)>0;switch(h){case"Table":case"Column":g=e.getNumRows(a)*e.getRowHeight(a),g>144e4&&(g=c.find(":first").height());break;default:g=c.find(":first").height()}!d&&b?(g+=f.scrollbarWidth,c.find(":first").height(g)):d&&!b&&(g-=f.scrollbarWidth,c.find(":first").height(g)),e.setScrollHeight(a,g),b?e.setExtraScrollHeight(a,f.scrollbarWidth):e.setExtraScrollHeight(a,0)}if(c.length>0){var h=d(a),i=!1,j={};b.each(c,function(a,b){j[a]=d(b),i=i||j[a]}),i?g(a,!h):g(a,!1),b.each(c,function(a,b){g(b,(i||h)&&!j[a])})}}function z(a){return typeof a!="undefined"&&e.isVisible(a)===!0&&e.isAvailableInView(a)===!0}var k={},l=!1,m=!1,n;return require(["draganddrop"],function(a){n=a}),window.iScroll&&(window.iScroll.prototype.isEventObj=!1,window.iScroll.prototype.scrollBarObj={vert:null,hori:null},window.iScroll.prototype.scrollRefs={vert:null,hori:null},window.iScroll.prototype.lastPos={left:0,top:0}),k.scrollTo=function(a,b,c,f){var g=e.getIScrollInstance(a),h=!1;if(g){c===undefined&&(c=e.getScrollX(a)),f===undefined&&(f=e.getScrollY(a));if(!b||c!==b[0].scrollLeft||f!==b[0].scrollTop)g.options.onScrollStart(),g.options.onScrollMove(undefined,0-c,0-f),g.options.onScrollEnd()}else b=b||e.getScrollElem(a),b&&b[0]?(c!==undefined&&c!==b[0].scrollLeft&&(m=!0,h=!0,b.scrollLeft(c)),f!==undefined&&f!==b[0].scrollTop&&(m=!0,h=!0,b.scrollTop(f)),h&&j.updatePosition(a)):a.children().first().hasClass("dynaChart")?o(c,f,a):d.log("No scrollElem in "+e.getObjType(a)+" "+e.getID(a))},k.updateScrollReferences=function(a){var b,c={vert:[],hori:[]},d=e.getDocName(a),f=e.getScrollDeps(a),g,h;if(e.isVisible(a)){u(a);if(f){w(a,c.vert),x(a,c.hori),g=e.getScrollBarObjVert(a),h=e.getScrollBarObjHori(a),z(g)||(g=a),z(h)||(h=a);for(b=0;b<c.vert.length;b+=1)e.setScrollBarObjVert(c.vert[b],g),c.vert[b].addClass("arcHide-scrollbar-vert"),u(c.vert[b]);for(b=0;b<c.hori.length;b+=1)e.setScrollBarObjHori(c.hori[b],h),c.hori[b].addClass("arcHide-scrollbar-hori"),u(c.hori[b]);y(a,c.vert)}e.setScrollRefs(a,c)}},k.setIgnoreJavaScriptEvents=function(a){l=a},k.getScrollableElement=function(a){return h.getScrollableElement(a)},window.jasmine&&(k.onScroll=r),k.getScrolledObjects=i.getScrolledObjects,k.clearScrolledObjects=i.clearScrolledObjects,k}),define("tablekeyboardhandler",["properties","keycodes","scroll","textinput","browserfeatures"],function(a,b,c,d,e){function g(b,d){c.scrollTo(b,null,undefined,a.getRowHeight(b)*d.y)}function h(b,d){c.scrollTo(b,null,undefined,a.getRowHeight(b)*(d.y+1)-a.getHeight(b))}function i(b,c){var d,e,f,g,i,j=a.getDatavirtualizationProperties(b),k=a.getNumRows(b),l=a.getSelectedCell(b);c.length>0&&(e=c.closest("tr")[0],i=c.closest("tr").index(),f=c.index(),e&&(d=e.nextSibling,d?(c.removeClass("selected"),c=$("td:nth-child("+(f+1)+")",d).addClass("selected").focus(),f=c.index(),g=c.closest("tr").index(),l.y+=1,g===i&&typeof l=="object"&&l.y<k&&h(b,l)):typeof l=="object"&&l.y<k-1&&(l.y+=1,h(b,l))))}function j(b,c){var d,e,f,h,i,j=a.getDatavirtualizationProperties(b),k=a.getSelectedCell(b);c.length>0&&(e=c.closest("tr")[0],i=c.closest("tr").index(),f=c.index(),e&&(d=e.previousSibling,d?(c.removeClass("selected"),c=$("td:nth-child("+(f+1)+")",d).addClass("selected").focus(),f=c.index(),h=c.closest("tr").index(),k.y-=1,h===i&&typeof k=="object"&&k.y>0&&g(b,k)):typeof k=="object"&&k.y>0&&(k.y-=1,g(b,k))))}function k(b,c){var d,e,f=a.getDatavirtualizationProperties(b),g=a.getSelectedCell(b),h=a.getNumCols(b);c.length>0&&(e=c[0],e&&(d=$(e.nextSibling),d.length>0&&d.index()<h&&(c.removeClass("selected"),d.addClass("selected").focus(),g.x+=1)))}function l(b,c){var d,e,f=a.getDatavirtualizationProperties(b),g=a.getSelectedCell(b);c.length>0&&(e=c[0],e&&(d=$(e.previousSibling),d.length>0&&d.index()>=0&&(c.removeClass("selected"),d.addClass("selected").focus(),g.x-=1)))}function m(b){var c=a.getScrollElem(b),d=a.getExtraScrollHeight(b)>0,f=a.getColumnWidth(b),g=a.getWidth(b),h=a.getHeight(b),i=a.getRowHeight(b),j=a.getNumRows(b),k=a.getHScrollBarAllowed(b),l=a.getVScrollBarAllowed(b)&&j*i>h,m=k&&f.accumulatedColumnWidth>g-(l?e.scrollbarWidth:0),n=a.getHeight(b)-(d||m?e.scrollbarWidth:0);return n}function n(b,c){var d,e=a.getSelectedCell(b),f=a.getNumCols(b);c.length>0&&(d=$("td:nth-child("+f+")",c.closest("tr")),d.length>0&&d.index()<f&&(c.removeClass("selected"),d.addClass("selected").focus(),e.x=f-1))}function o(b,c){var d,e=a.getSelectedCell(b),f=a.getNumCols(b);c.length>0&&(d=$("td:nth-child(1)",c.closest("tr")),d.length>0&&d.index()<f&&(c.removeClass("selected"),d.addClass("selected").focus(),e.x=0))}function p(b,c){var d=a.getDatavirtualizationProperties(b),e=a.getSelectedCell(b),f=m(b),h=Math.floor(f/Math.max(a.getRowHeight(b),1)),i=a.getNumRows(b),j=c.closest("tr").index()+d.firstElementInDOM,k,l=a.getScrollY(b),n=Math.ceil(l/Math.max(a.getRowHeight(b),1)),o=j-n;if(i<=h)return;j+h<i?(k={x:e.x,y:e.y+h-o},g(b,k),e.y+=h):(k={x:e.x,y:i-h},g(b,k))}function q(b,c){var d=a.getDatavirtualizationProperties(b),e=a.getSelectedCell(b),f=m(b),h=Math.floor(f/Math.max(a.getRowHeight(b),1)),i=a.getNumRows(b),j=c.closest("tr").index()+d.firstElementInDOM,k,l=a.getScrollY(b),n=Math.ceil(l/Math.max(a.getRowHeight(b),1)),o=j-n;if(i<=h)return;j-h>=0?(k={x:e.x,y:Math.max(e.y-h-o,0)},g(b,k),e.y-=h):(k={x:e.x,y:0},g(b,k))}function r(a,c){return a>=48&&a<=90||a===b.Space||a===b.Semicolon||a===b.Equals||a===b.Slash||a===b.Point||a===b.Dash||a===b.DecimalPoint||a===b.Minus||a===b.Divide||a===b.OpenBracket||a===b.CloseBracket}function s(b){var c=a.getSelectedCell(b),d=a.getNumRows(b),e=a.getNumCols(b),f=a.getDatavirtualizationProperties(b);c&&(c.y<f.firstElementInDOM||f.lastElementInDOM<c.y)&&(c.y<f.firstElementInDOM?g(b,c):h(b,c))}function t(b,c){var e=a.getSelectedCell(c.data.ref);c.data.target=b,c.data.clickPos={x:e.x,y:e.y},$(".arcTextInputSizeTarget",c.data.ref).removeClass("arcTextInputSizeTarget"),b.addClass("arcTextInputSizeTarget"),d.show(c)}var f={};return f.handleTab=function(a,b,c){c?l(a,b):k(a,b)},f.handleEnter=function(a,b,c){c?j(a,b):i(a,b)},f.handleKeyPressEvent=function(c){var d=$("#"+c.data.id),e=$("td.selected",d),g,h,m=a.getIsEditable(d),u=a.isActive(d),v=u&&m,w=!0;if(c.type==="keypress"||c.type==="keydown"){v&&s(d);switch(c.keyCode){case b.Tab:f.handleTab(d,e,c.shiftKey);break;case b.Enter:f.handleEnter(d,e,c.shiftKey);break;case b.LeftArrow:l(d,e);break;case b.UpArrow:j(d,e);break;case b.RightArrow:k(d,e);break;case b.DownArrow:i(d,e);break;case b.PageDown:p(d,e);break;case b.PageUp:q(d,e);break;case b.End:n(d,e);break;case b.Pos1:o(d,e);break;default:w=!1,d.hasClass("arcTextInputActive")||v&&r(c.keyCode)&&t(e,c)}w&&e.length>0&&(c.preventDefault(),c.stopImmediatePropagation())}},f}),define("objectpropertyapplier",["jquery","properties","logger","tools","propertytools","stylesheethandler","styleborderprops","stringtools","tooltiptypes","browserfeatures","scroll","objectresizer"],function(a,b,c,d,e,f,g,h,i,j,k,l){function o(a){return b.getBackgroundColor(a)==="rgba(255,255,255,0.01)"}function p(c,d){var e,f,g,h,i=!1;e=b.getBorder(c),e.type==="1Point"?f=1:f=2,g=Number(e.top)*f+Number(e.bottom)*f,h=Number(e.left)*f+Number(e.right)*f,g>=b.getHeight(c)&&(e.top=!1,e.bottom=!1,b.setBackgroundColor(c,e.color),b.setBorder(c,e),b.setHeight(c,Math.max(b.getHeight(c),f)),i=!0),h>=b.getWidth(c)&&(e.left=!1,e.right=!1,b.setBackgroundColor(c,e.color),b.setBorder(c,e),b.setWidth(c,Math.max(b.getWidth(c),f)),i=!0),i&&(l.applyObjectDimensions(c),d==="Field"?a("#"+c[0].id+" > div table").css("backgroundColor",b.getBackgroundColor(c)):a("#"+c[0].id+" div").css("backgroundColor",b.getBackgroundColor(c)))}function q(a){var c=b.getBorder(a);return c.left||c.right?!0:!1}function r(c){var d,e=b.getForegroundColor(c),g="."+h.makeClassName(c[0].id),i=b.getFont(c),j=b.getBorder(c),k={"text-decoration":i.textDecoration},m=a(g+" tr",c).hasClass("arcRadioSingleLine");f.setStyle(g,"color",e),f.setStyle(g,i),f.setStyle(g+" span > label",k),m&&(d=b.getHeight(c)-l.getVerticalAdjustment(j,c),f.setStyle(g,"height",d+"px"))}function s(c){var d=b.getPattern(c);a("#"+c[0].id+" > div:first"+(d&&d.ImageReference?"":" > div:first")).css("backgroundColor",b.getBackgroundColor(c))}function t(c){var d={};e.setVerticalAlignment(c,d),e.setHorizontalAlignment(c,d);switch(b.getObjType(c)){case"Button":case"Switch":a("button > span",c).css(d)}}function u(c){var d,e;b.hasFontChanged(c)&&(d=a("button",c),e=b.getFont(c),d.css(e)),b.setFontChanged(c,!1)}function v(c){var d,e={},f,g,h,i,j,k,l,m=!1;g=b.hasForegroundColorChanged(c),i=b.hasBackgroundColorChanged(c),l=b.hasPatternChanged(c),g&&(e.color=b.getForegroundColor(c),m=!0),i&&(e["background-color"]=b.getBackgroundColor(c),m=!0),l&&(j=b.getPattern(c),k=j&&j.ImageReference,k?(e["background-color"]="rgba(255, 255, 255, 0)",m=!0):(e["background-color"]=b.getBackgroundColor(c),m=!0)),m&&(d=a("button",c),d.css(e)),b.setForegroundColorChanged(c,!1),b.setBackgroundColorChanged(c,!1),b.setPatternChanged(c,!1)}function w(c){var d,e;b.hasFontChanged(c)&&(d=b.getFont(c),a("div:first",c).css(d)),b.setFontChanged(c,!1),b.hasPopupFontChanged(c)&&(e=b.getPopupFont(c)||null,e&&a(".arcHierPopupContent",c).css(e)),b.setPopupFontChanged(c,!1)}function x(c){var d;d=b.hasForegroundColorChanged(c),d&&a("div:first",c).css("color",b.getForegroundColor(c)),b.setForegroundColorChanged(c,!1)}function y(c){var d;b.hasFontChanged(c)&&(d=b.getFont(c),a("div:first",c).css(d)),b.setFontChanged(c,!1)}function z(c){var d;b.hasFontChanged(c)&&(d=b.getFont(c),a("table",c).css(d)),b.setFontChanged(c,!1)}function A(c){var d;d=b.hasForegroundColorChanged(c),d&&a("table",c).css("color",b.getForegroundColor(c)),b.setForegroundColorChanged(c,!1)}function B(a){return b.hasColumnWidthChanged(a)||(b.getObjType(a)==="Column"||b.getObjType(a)==="Field")&&b.hasWidthChanged(a)}function C(b){a("table",b).removeClass("arcHideVertGrid").removeClass("arcShowVertGrid").removeClass("arcHideHoriGrid").removeClass("arcShowHoriGrid")}function D(a){return a>n||ARCPLAN.datavirtualization!==!1}function E(c,d){var e=b.getGridColor(c),g=b.getGridType(c),i=b.getNumRows(c),j=h.makeClassName(c[0].id),k="."+j,l;if(g){C(c);switch(g){case"none":a("table",c).addClass("arcHideVertGrid"),a("table",c).addClass("arcHideHoriGrid");break;case"both":a("table",c).addClass(b.getObjType(c)==="Column"?"arcHideVertGrid":"arcShowVertGrid"),a("table",c).addClass("arcShowHoriGrid");break;case"horizontal":a("table",c).addClass("arcHideVertGrid"),a("table",c).addClass("arcShowHoriGrid");break;case"vertical":a("table",c).addClass(b.getObjType(c)==="Column"?"arcHideVertGrid":"arcShowVertGrid"),a("table",c).addClass("arcHideHoriGrid");break;default:}}a("table",c).addClass(j),z(c),A(c),m.adjustTableSize(c,d),F(c,d),m.applyTableRowHeight(c,d),m.applyTableColumnWidth(c,d);switch(d){case"Column":case"Table":if(b.getBackgroundColor2(c)){l=b.getPattern(c);if(!l||!l.PatternFormat)D(i)?(f.setStyle("table"+k+" tr:nth-child(even)","background-color",b.getBackgroundColor2(c)),f.setStyle("table"+k+" tr:nth-child(odd)","background-color",b.getBackgroundColor(c))):(a("tr:nth-child(even)",c).css("background-color",b.getBackgroundColor2(c)),a("tr:nth-child(odd)",c).css("background-color",b.getBackgroundColor(c)))}}d!=="Field"&&(D(i)?f.setStyle("table"+k+" td",{"border-right-color":e,"border-bottom-color":e}):a("td",c).css({"border-right-color":e,"border-bottom-color":e}))}function F(c,d){var e,f="1px solid rgba(255,255,255,0.01)",g={},h={},i=b.getPattern(c),j=i&&i.ImageReference;if(!j)switch(d){case"Table":case"Column":case"CheckboxGroup":e=b.getBorder(c);if(e){e.top||(g["border-top"]=f,h["padding-top"]=""),e.bottom||(g["border-bottom"]=f),e.left||(g["border-left"]=f,h["padding-left"]=""),e.right||(g["border-right"]=f);if(!e.top||!e.right||!e.bottom||!e.left)c.children().first().css(g),a("table",c).css(h)}}}function G(b,c){var d=b.length,e,f,g,h,i;if(d>0)for(e=0;e<d;e+=1)f=a(b[e]),g=f.parent(),h=f.attr("data-origSize"),f.hasClass("arcImgScaleAllways")?f.height(c):typeof h=="string"&&(i=parseFloat(h.split(",")[1]),i>=c?f.height(c):f.height(i))}function H(a,b){a&&(b.overflowX&&a.css("overflow-x",b.overflowX),b.overflowY&&a.css("overflow-y",b.overflowY))}function I(a,c){var d=b.getColumnWidth(a).accumulatedColumnWidth,e=b.getRowHeight(a)*b.getNumRows(a),f,h,i,j,k,l;return c!=="Table"&&c!=="Column"&&c!=="Row"&&c!=="CheckboxGroup"?{width:d,height:e}:(f=parseInt(b.getWidth(a),10),h=parseInt(b.getHeight(a),10),i=b.getBorder(a),j=g.getBorderWidth(i.type,i.type),i.left&&(f-=j.topLeft),i.right&&(f-=j.bottomRight),i.top&&(h-=j.topLeft),i.bottom&&(h-=j.bottomRight),d-f>=1&&d-f<=2&&c!=="Column"&&(d=f,k="hidden"),e=Math.floor(e),e-h>=-1&&e-h<=2&&c!=="Row"&&(e=h,l="hidden"),{width:d,height:e,overflowX:k,overflowY:l})}function J(c){var d=a(".arcHier",c),e=b.getBorder(c),f=b.getGridType(c);d.hasClass("arcBox")&&f==="both"&&(e.left&&d.parent().css("margin-left","-1px"),e.top&&d.parent().css("margin-top","-1px"))}function K(c){var d=b.getObjType(c),e=a(".arcHier",c).parent(),f=b.getScrollElem(c),g,h,i=b.getBorder(c),k=l.getHorizontalAdjustment(i,c),m=l.getVerticalAdjustment(i,c);switch(d){case"VerticalHierarchie":J(c),!e.parent().is(".arcHideYScrollbar")&&f.css("overflow-y")==="auto"&&(g=b.getScrollWidth(c),g===undefined&&e.height()>e.parent().height()&&(g=Math.max(e.width()-j.scrollbarWidth,b.getWidth(c)-k-j.scrollbarWidth),e.css("width",g+"px"),b.setScrollWidth(c,g)));break;case"HorizontalHierarchie":f.css("overflow-x")==="auto"&&(h=b.getScrollHeight(c),h===undefined&&e.width()>e.parent().width()&&(h=Math.max(e.height()-j.scrollbarWidth,b.getHeight(c)-m-j.scrollbarWidth),e.css("height",h+"px"),b.setScrollHeight(c,h)))}}function L(c,d){var e=d,f=b.getNumRows(c),g=b.getRowHeight(c),h=b.getBorder(c),i=l.getHorizontalAdjustment(h,c),k=l.getVerticalAdjustment(h,c),m=b.getHeight(c),n=b.getScrollElem(c),o=0;return ARCPLAN.datavirtualization!==!1&&b.isUseContentPaging(c)&&(n&&(o=f>0&&b.getVScrollBarAllowed(c)&&a(".arcHideYScrollbar",c).length===0&&f*g>m-k?j.scrollbarWidth:0),e=Math.max(d,b.getWidth(c)-i-o)),e}function M(a,b){var c;if(a.Elements){c=0;if(c+b<a.Elements.length)return a.Elements[c+b].Width-1}return typeof a.Width=="number"?a.Width:69}function N(b,c){var d=b.length,e,f,g,h,i,j,k;if(d>0)for(e=0;e<d;e+=1)g=a(b[e]),h=g.parent(),f=h.parent().children().index(h),i=M(c,f),j=g.attr("data-origSize"),g.hasClass("arcImgScaleAllways")?g.width(i):typeof j=="string"&&(k=parseFloat(j.split(",")[0]),k>=i-2?g.width(i-2):g.width(k))}function O(a,b){var c=a;return typeof c=="object"&&(typeof c.FaceName=="string"&&(c=d.toHTMLFont(c)),c=c[b]),c}function P(a,b,c,d){var e=a+" .LI_"+c+"_"+d;return b&&(b==="span"?e+=" .SPAN_"+c+"_"+d:e+=" > "+b),e}function Q(a,b,c,d,e){a[b]||(a[b]={prop:{},dim:0}),a[b].prop[d]=e,a[b].dim=c,a.maxDim=Math.max(a.maxDim,c)}function R(a,b,c){var e,f,g,h=c.postFix||"",i=d.toCamelCase(c.property);f=a-1,e=P(c.className,c.tagName,a,b),g=c.defaultProp,g instanceof Array&&(f<g.length?g=g[f]:g.length>0&&(g=g[g.length-1])),g=O(g,i),g&&Q(c.levelPropertyBag,e,a,c.property,g+h)}function S(a,b,c,e){var f,g=e.postFix||"",h=d.toCamelCase(e.property),i=P(e.className,e.tagName,b,c);f=O(a[e.propName],h),Q(e.levelPropertyBag,i,b,e.property,f+g)}function T(a){var c,f=0,g=[],h=0,i=!1;if(a.propValArray){i=b.getShowRootNode(a.objRef),d.iterateArcplanArray(a.propValArray,function(a,b){var c,d,h,j,k,l;if(b.Range){d=parseInt(b.Range.Start.Column,10),h=parseInt(b.Range.End.Column,10);for(c=d;c<=h;c+=1){j=e.getLevelFromRowProp(b.Range.Start.Row,i),k=e.getLevelFromRowProp(b.Range.End.Row,i),f=Math.max(f,c);for(l=0;l<f;l+=1)g[l]||(g[l]=0);g[c-1]=Math.max(g[c-1],Math.max(j,k))}}}),d.iterateArcplanArray(a.propValArray,function(b,c){var d,f,j,k,l,m;if(c.Range){f=parseInt(c.Range.Start.Column,10),j=parseInt(c.Range.End.Column,10);for(d=f;d<=j;d+=1){k=e.getLevelFromRowProp(c.Range.Start.Row,i),l=e.getLevelFromRowProp(c.Range.End.Row,i);for(m=k;m<=l;m+=1)S(c,d,m,a);h=0;for(m=0;m<Math.min(g.length,d-1);m+=1)h=Math.max(h,g[m]);if(h>l)for(m=l+1;m<=h;m+=1)R(d,m,a);else R(d,l+1,a);h=g[d-1]}}});if(h>0)for(c=1;c<=h+1;c+=1)R(f+1,c,a)}}function U(a,b){var c,d;if(!b)for(c=1;c<=a.maxDim;c+=1)for(d in a)a.hasOwnProperty(d)&&a[d].dim===c&&f.setStyle(d,a[d].prop)}function V(c,d,e){var g=b.getFont(c),h=b.getForegroundColor(c),i=b.getGridColor(c),j={maxDim:0},k;b.getObjType(c)==="MenuHierarchie"&&(g=b.getPopupFont(c),h=b.getForegroundColor2(c)),k=a("#"+c[0].id+" .arcHier"),k.hasClass("arcBox")?(e||(k.hasClass("arcLine")&&f.setStyle(d+" li","border-color",i),b.getObjType(c)==="HorizontalHierarchie"&&f.setStyle(d+" label","overflow","hidden")),T({levelPropertyBag:j,objRef:c,className:d,property:"background-color",propName:"Color",propValArray:b.getBackgroundColors(c),defaultProp:b.getBackgroundColor(c)})):T({levelPropertyBag:j,objRef:c,className:d,property:"background-color",propName:"Color",propValArray:b.getBackgroundColors(c),defaultProp:["#ffff00","#00ff00","#0000ff","#ff0000"],tagName:"span"}),T({levelPropertyBag:j,objRef:c,className:d,property:"color",propName:"Color",propValArray:b.getForegroundColors(c),defaultProp:h}),T({levelPropertyBag:j,objRef:c,className:d,property:"font-family",propName:"FontDescription",propValArray:b.getFonts(c),defaultProp:g}),T({levelPropertyBag:j,objRef:c,className:d,property:"font-size",propName:"FontDescription",propValArray:b.getFonts(c),defaultProp:g}),T({levelPropertyBag:j,objRef:c,className:d,property:"font-style",propName:"FontDescription",propValArray:b.getFonts(c),defaultProp:g}),T({levelPropertyBag:j,objRef:c,className:d,property:"font-weight",propName:"FontDescription",propValArray:b.getFonts(c),defaultProp:g}),T({levelPropertyBag:j,objRef:c,className:d,property:"text-decoration",propName:"FontDescription",propValArray:b.getFonts(c),defaultProp:g,tagName:"a"}),T({levelPropertyBag:j,objRef:c,className:d,property:"text-decoration",propName:"FontDescription",propValArray:b.getFonts(c),defaultProp:g,tagName:"label"}),U(j,e)}function W(c,e){var f,g,h,i,j,k=b.getDisplayStyle(c)==="BOX_STYLE";f=b.getSelectionPath(c),f&&b.getSelectType(c)!=="HierNoSelect"&&b.getObjType(c)!=="MenuHierarchie"&&(a("label, a, li",e).removeClass("arcHier-selected"),d.iterateArcplanArray(f,function(b,c){var f,l;g||(g=a("ol",e),h=g.children(":first").children("input, a"),h[0]&&(l=h[0].id.split("_"),j=l[4])),h=g,i=undefined,f=0,d.iterateArcplanArray(c,function(b,c){var e;f+=1;if(c&&c.v){e=d.makeNodeID("",f,1,c.v,j),h=a("li [id$='"+e+"']",h).parent();if(h&&h.length>0)i=h;else return i=undefined,!1}}),i&&(k?i.addClass("arcBoxHierSelected"):i.addClass("arcHier-selected"))}))}function X(a,c){var d=b.getPopupFont(a);d&&f.setStyle(c,{"font-family":d.fontFamily,"font-size":d.fontSize,"font-style":d.fontStyle,"font-weight":d.fontWeight,"text-decoration":d.textDecoration,color:b.getForegroundColor2(a)})}function Y(a,c){var d=b.getPopupGradientColorLeft(a),e=b.getPopupGradientColorRight(a),g=d+", "+e+")",h="linear-gradient(to right, "+g,i="-webkit-linear-gradient(left, "+g;f.setStyle(c,"background",i),f.setStyle(c,"background",h)}function Z(c){var d,e=h.makeClassName(c[0].id);o(c)&&a("#"+c[0].id+" .arcHierPopup").css("background-image","none"),a("ul",c).length>0&&(c.children().addClass(e),X(c,"."+e+" li"),d=Math.round(b.getRowHeight(c)),f.setStyle("."+e+" li",{"line-height":d+"px","background-color":b.getBackgroundColor2(c)}),f.setStyle("."+e+" li:hover",{"background-color":b.getHotTrackingBackColor(c),color:b.getHotTrackingFontColor(c)}),Y(c,"."+e+" .arcMenuSelectionDiv")),w(c)}function $(a){var c,d,f,g,h=b.getObjType(a);f=k.getScrollableElement(a),f&&f[0]&&h!=="MenuHierarchie"&&(c=b.getYSettingValue(a),d=b.getRowHeight(a),g=Math.max(c-1,0)*d,0===g&&k.scrollTo(a,f,undefined,1),k.scrollTo(a,f,undefined,g),b.getColumnWidth(a)&&(c=b.getXSettingValue(a),b.getColumnWidth(a).width?(d=b.getColumnWidth(a).width,k.scrollTo(a,f,(c-1)*d,undefined)):(g=e.getScrollPosFromColumn(c-1,a),k.scrollTo(a,f,g,undefined))))}function _(a,b){this.update=function(){var c;a.src=b,a.tagName==="EMBED"&&a.parentNode&&(a.type="image/svg+xml",c=a.parentNode.innerHTML,a.parentNode.innerHTML=c)}}function ba(a,b){var c,d,e,f,g,h=a.length;for(e=0;e<h;e+=1)f=a[e],f.lang&&(f.onerror="",c=f.lang.split(":"),c.length>1&&(d=b.buildObjectPictRequest(c[1]),g=new _(f,d),b.downloadPictToBrowserCache(d,g.update)))}function bb(a){var c=b.getToolTip(a),d=b.getObjType(a);if(c&&c.Elements&&c.Elements.length>=3&&a.children().length>=1)switch(d){case"Table":case"Row":case"Column":case"Field":bc(c,a);break;default:a.children(":first").prop("title",c.Elements[2].ToolTip)}}function bc(c,d){if(ARCPLAN.datavirtualization===!1){var e=d.children(":first"),f=0,g=0,h,j,k=b.getToolTipType(d),l=a("table",d),m,n,o,p,q;k===i.WholeObject?e.attr("title",c.Elements[2].ToolTip):e.attr("title",""),m=a("tr",l),h=m.length;for(f=0;f<h;f+=1){o=m[f],n=a("td",o),j=n.length;for(g=0;g<j;g+=1){p=a(n[g]);switch(k){case i.EachCell:q=2+(f*c.Elements[0].NumCols+g);break;case i.EachRow:q=2+f;break;case i.EachColumn:q=2+g;break;case i.WholeObject:q=c.Elements.length}q<c.Elements.length?p.attr("title",c.Elements[q].ToolTip).children().attr("title",c.Elements[q].ToolTip):p.attr("title",undefined).children().attr("title",undefined)}}}}var m={},n=100;return m.applyViewAvailability=function(a){b.isAvailableInView(a)?a.css("display","inline"):a.css("display","none")},m.applyBorderProperties=function(a,b){if(b==="Text"&&a.find("img").length>0)return;var c=h.makeClassName(a[0].id);p(a,b),g.setBorderStyle(c,a,b)},m.applyScrollBarAllowed=function(a){var c,d=b.getNumRows(a),e=b.getColumnWidth(a),f=e?e.numCols:1,g=b.getObjType(a),h=!0,i=!0,k,m,n,o,p=b.getBorder(a);c=l.getScrollableElement(a),b.setScrollElem(a,c);if(c){switch(g){case"Menu":case"MenuHierarchie":return;case"Field":case"Column":case"Row":case"Table":case"CheckboxGroup":d<=1&&(h=!1),f<=1&&(i=!1)}g==="Row"||g==="Field"?c.css("overflow-y","hidden"):h&&b.getVScrollBarAllowed(a)?(k=l.getHorizontalAdjustment(p,a),m=b.getWidth(a)-k,m<=j.scrollbarWidth&&(m=j.scrollbarWidth+1,n=-k/2,c.css("left",n+"px")),c.css("overflow-y","auto"),c.removeClass("arcHideYScrollbar"),o=I(a,g),H(c,o),c.width(q(a)?m:b.getWidth(a))):(j.mobile?c.addClass("arcHideYScrollbar").css("overflow-y","auto"):c.addClass("arcHideYScrollbar").css("overflow-y","scroll"),m=b.getWidth(a)+j.scrollbarWidth,c.width(m)),i&&b.getHScrollBarAllowed(a)?c.css("overflow-x","auto"):c.css("overflow-x","hidden")}},m.applyProperties=function(c){m.applyViewAvailability(c),l.applyObjectDimensions(c),bb(c);switch(b.getObjType(c)){case"Switch":b.getYSettingValue(c)===1?a("button",c).addClass("arcChecked"):a("button",c).removeClass("arcChecked"),t(c),u(c),v(c);break;case"Button":t(c),u(c),v(c);break;case"VerticalHierarchie":case"HorizontalHierarchie":m.applyScrollBarAllowed(c),m.applyHierProperties(c),y(c);break;case"MenuHierarchie":m.applyHierProperties(c),w(c),x(c);break;case"Menu":Z(c),x(c);break;case"Field":case"Column":case"Row":case"Table":case"CheckboxGroup":m.applyScrollBarAllowed(c),E(c,b.getObjType(c));break;case"RadioGroup":r(c)}m.applyBorderProperties(c,b.getObjType(c)),s(c),b.setNumRowsChanged(c,!1)},m.applyTableColumnWidth=function(c,g){var i=b.getColumnWidth(c),k=0,m=-1,n,o=b.getBorder(c),p=l.getHorizontalAdjustment(o,c),q,r,s,t,u=1,v="."+h.makeClassName(c[0].id),w,x;if(B(c)){n=a("table:first",c);switch(g){case"Column":if(e.hasColumnVertScrollbar(c)){t=b.getWidth(c);if(o.type==="3D1"||o.type==="3D3")u=0;m=t-u-j.scrollbarWidth,n.css("width",m+"px")}break;case"Row":case"Table":case"CheckboxGroup":i.Elements&&(s=a("img",n),N(s,i),d.iterateArcplanArray(i,function(a,b){a==="Width"&&(x=v+" tr:nth-child(1) td:nth-child("+(k+1)+")",f.setStyle(x,{width:Math.max(0,b-1)+"px"}),k+=1)}),x=v+" tr:nth-child(1) td:nth-child("+(k+1)+")",w=f.getStyle(x,"width"),typeof w!="undefined"&&f.removeStyle(x,"width"),i.accumulatedColumnWidth<b.getWidth(c)&&(p=0),m=i.accumulatedColumnWidth-p,m=L(c,m),isNaN(m)||(ARCPLAN.datavirtualization!==!1&&b.isUseContentPaging(c)&&b.getObjType(c)!=="CheckboxGroup"?n.css("width",m+"px"):n.css("width",i.accumulatedColumnWidth+"px"),n.parent().css("width",m+"px")));break;default:m=i.accumulatedColumnWidth/i.numCols,m>0&&(m-=1,q=a("td",n),q.length>0&&(r=a("img",q),r.length>0&&(r.hasClass("arcImgScaleAllways")||r.width()>m)&&r.width(m)),n.is(".arcHideVertGrid")&&(m-=1),q.css("width",""),x=v+" tr:nth-child(1) td:nth-child(1)",f.setStyle(x,{width:Math.max(0,m)+"px"}))}b.setColumnWidthChanged(c,!1)}},m.applyTableRowHeight=function(c,d){var g=b.getBorder(c),i=e.getAdjustedRowHeight(c,d),k=i,l=b.getNumRows(c),m=b.getGridType(c),n,o=i,p,q,r,s,t,u="."+h.makeClassName(c[0].id);if(typeof i=="number"&&i>=0){b.getFont(c)&&(o=Math.min(parseInt(b.getFont(c).lineHeight,10),k)),d==="Row"&&(p=a("table",c),e.hasRowHoriScrollbar(c)&&(i-=j.scrollbarWidth,k=i,p.height(k+"px")));if(d==="Row"||d==="Field"||b.hasRowHeightChanged(c)){d!=="Row"&&d!=="Field"&&D(l)?(f.setStyle("table"+u+" tr:not(.ignoreRow)",{height:i+"px","line-height":o+"px"}),f.setStyle("table"+u+" td > div",{height:k+"px","max-height":k+"px"})):(a("tr:not(.ignoreRow)",c).css({height:i+"px","line-height":o+"px"}),a("td > div",c).css({height:k+"px","max-height":k+"px"})),n=Math.floor(l*i);switch(d){case"Column":case"Table":case"CheckboxGroup":p=a("table",c),ARCPLAN.datavirtualization===!1&&p.css("height",n+"px"),p.parent().css("height",n+"px"),t=a("img",p),G(t,k);break;case"Row":ARCPLAN.datavirtualization===!1&&(n-=j.scrollbarWidth,a("table",c).height(n+"px"));break;case"Field":p=a("table",c),s=a("td",p),r=a("img",s),r.length>0&&G(r,n)}}b.setRowHeightChanged(c,!1)}},m.correctScrollElemWidthByOverflowYHidden=function(a,b){a&&b.overflowY&&a.hasClass("arcHideYScrollbar")&&(a.removeClass("arcHideYScrollbar"),a.width(a.width()-j.scrollbarWidth))},m.adjustTableSize=function(c,d){var e,f,g,h=b.getBorder(c),i,k=b.getScrollElem(c),n,o;switch(d){case"Column":case"Row":case"Table":case"CheckboxGroup":o=I(c,d),e=o.width,e>=0&&d!=="Column"&&(n=L(c,e),a("table",c).width(n+"px"),a("table",c).parent().width(n+"px")),b.hasNumRowsChanged(c)&&m.applyScrollBarAllowed(c),H(k,o),m.correctScrollElemWidthByOverflowYHidden(k,o)}d==="Row"&&b.getHScrollBarAllowed(c)&&e>=0&&e>b.getWidth(c)&&(g=b.getHeight(c),g-=l.getVerticalAdjustment(h,c),g-=j.scrollbarWidth,i=a("table",c),i.height(g+"px"),i.parent().height(g+"px"))},m.applyHierProperties=function(c,d){var e,g,i,k,m,n,p=h.makeClassName(c[0].id),q,r,s,t,u,v=14;r=c.children(),r.addClass(p),q=a("#"+c[0].id+" .arcHier"),e=Math.round(b.getRowHeight(c)),n=Math.ceil((e-14)/2),q.hasClass("arcLine")&&(e-=1),i=e,u=b.getScrollElem(c),u&&u.is(".arcHideYScrollbar")&&(t=b.getBorder(c),g=b.getWidth(c)-l.getHorizontalAdjustment(t,c),u.css("width",g+j.scrollbarWidth+"px")),W(c,q);if(q.hasClass("arcLine")){t=b.getBorder(c);if(!t.left||!t.top)k={},t.left||(k["border-left-width"]="1px"),!t.top&&!b.isOneDimHasSumKnotLast(c)&&(k["border-top-width"]="1px"),q.children().children().css(k)}k={height:e+"px"},m="."+p,d||(b.getShowIcons(c)&&!q.hasClass("arcBox")&&f.setStyle(m+" span",{width:"7px","border-width":"1px","margin-right":"3px"}),f.setStyle(m+" span","margin-top",n+2+"px"),f.setStyle(m+" label",k),f.setStyle(m+" a",k),f.setStyle(m+" a::before",k),f.setStyle(m+" li","line-height",i+"px"),b.getObjType(c)==="HorizontalHierarchie"&&q.hasClass("arcBox")&&(s=b.getColumnWidth(c).width,q.hasClass("arcLine")?s-=1:f.setStyle(m+" div > ol > li > ul","margin-left",s-1+"px"),q.hasClass("arcHoriBeside")||f.setStyle(m+" li > ul","margin-left",s+"px")),n=Math.round((b.getRowHeight(c)-14)/2),f.setStyle(m+" li > input","margin-top",n+"px")),V(c,m,d),b.getObjType(c)==="MenuHierarchie"&&(o(c)&&a("#"+c[0].id+" .arcHierPopup").css("background-image","none"),n=(i-v)/2,k={"margin-top":Math.round(n)+"px"},b.getSelectType(c)!=="HierMultiSelect"&&(k.opacity=0),f.setStyle(m+" input.arcHpCbox:not(:checked)",k),f.setStyle(m+" input.arcHpCbox:checked","margin-top",Math.round(n)+"px"),a(".arcBox",c).length>0?n=-1*(i/4-7):n=i/4-3,f.setStyle(m+" li > input:not(.arcHpCbox)","margin-top",Math.round(n)+"px"),f.setStyle(m+" label.arcSelectable","width",b.getWidth(c)+"px")),K(c)},m.updateImageRefs=function(b,c){var d=a("img",c).not("[src]"),e=a("embed",c).not("[src]");ba(d,b),ba(e,b)},m.updateReferences=function(c,e,f,g){var i=[],j=f;if(!e||!e.Elements||e.Elements.length===0)return;d.iterateArcplanArray(e,function(c,d){var e,f;if(!d||!d.ObjID)return;d.Worksheet!==undefined&&(j=h.removeExtension(d.Worksheet)),e=h.makeID(j,d.ObjID),f=a("#"+e),l.adjustScrollDependentContentSize(f),k.updateScrollReferences(f),$(f),d.ObjectData&&(d.ObjectProperties||(b.getScrollBarObjVert(f)&&i.push(b.getScrollBarObjVert(f)),b.getScrollBarObjHori(f)&&i.push(b.getScrollBarObjHori(f))))}),d.each(i,function(a,b){k.updateScrollReferences(b)}),m.updateImageRefs(g,a("#arcContainer"))},m}),define("viewmanagement",["jquery","logger","stringtools","properties","objectresizer","objectpropertyapplier","objectpropertysetter","events/eventid","tools","documentpositioner","viewupdater"],function(a,b,c,d,e,f,g,h,i,j,k){function n(a,b){return q(b,a).Name?!0:!1}function o(a,b){return p(a,b)}function p(a,b,c){var e=parseInt(a,10),f=c?d.getDocViews(c):undefined,g,h,j,k=!1,l,o,p,q=-1,r="";return m.viewRules!==""&&i.iterateArcplanArray(m.viewRules,function(a,b){b.IsStandard===!0&&(r=b.Name),j=parseInt(b.Width,10),q===-1&&(q=j,p=b.Name),j<q&&(q=j,p=b.Name),j<=e&&(!c||n(b.Name,f))&&(!k||l<j)&&(k=!0,l=j,o=b.Name)}),k||(!c||n(p,f)?o=p:o=r),o}function q(a,b){var c=0;if(typeof a=="object")for(c in a.Elements)if(a.Elements[c].View.Name===b)return a.Elements[c].View;return{}}function r(a){return a.ViewAvailability==="true"}function s(b,h){var i=c.makeID(d.getDocName(b),h.ObjID),j,k,l,m,n=a("#"+i),o=h.BaseProperties,p;o||(o=h.TableProperties.BaseProperties),j=Math.abs(parseInt(o.Position.XPos,10)),k=Math.abs(parseInt(o.Position.YPos,10)),l=Math.abs(parseInt(o.Width.Value,10)),m=Math.abs(parseInt(o.Height.Value,10)),d.setOrigXPos(n,j),d.setXPos(n,j),d.setOrigYPos(n,k),d.setYPos(n,k),d.setOrigWidth(n,l),d.setWidth(n,l),d.setOrigHeight(n,m),d.setHeight(n,m),d.setAvailableInView(n,o.ViewAvailability==="true"),f.applyViewAvailability(n),h.ObjectProperties&&(d.setVScrollBarAllowed(n,h.ObjectProperties.VScrollbarAllowed.Value==="true"),d.setHScrollBarAllowed(n,h.ObjectProperties.HScrollbarAllowed.Value==="true"),g.setPropertiesByView(h.ObjectProperties,i),r(o)&&(f.applyScrollBarAllowed(n),f.applyTableColumnWidth(n,d.getObjType(n)))),h.TableProperties&&h.TableProperties.ObjectProperties&&(d.setVScrollBarAllowed(n,h.TableProperties.ObjectProperties.VScrollbarAllowed.Value==="true"),d.setHScrollBarAllowed(n,h.TableProperties.ObjectProperties.HScrollbarAllowed.Value==="true"),g.setPropertiesByView(h.TableProperties.ObjectProperties,i),r(o)&&f.applyScrollBarAllowed(n)),r(o)&&e.applyObjectDimensions(n)}function t(a,b){a.Layers&&a.Layers.Layer&&a.Layers.Layer.Layout&&j.updateDocumentContainer(b,a.Layers.Layer.Layout)}function u(c,e,g){var h=d.getDocViews(c),i=q(h,e),j,k=0,l;b.log("applying view: "+e);if(i&&i.arcplanDocument){j=i.arcplanDocument.Objects,a(".arcHideYScrollbar",c).css("overflow-y","auto").removeClass("arcHideYScrollbar");for(k in j.Elements)for(l in j.Elements[k])s(c,j.Elements[k][l]);g&&f.updateReferences(c,i.arcplanDocument.Objects,d.getDocName(c),g),t(i.arcplanDocument,c)}b.log("done applying view: "+e)}function v(a,b,c){var d=new Date,e=m.currentView===b;e&&c&&c.doSendEvent&&c.doChangeViewEventWithRetryIfWaiting(a,h.EID_ONVIEWCHANGED,b)}function w(a,b,c){var e;b!==m.currentView&&(m.currentView=b,e=d.getDocName(a),window.setTimeout(function(){v(e,b,c)},300))}function x(a,b,c){b!==d.getDocCurrentView(a)&&(u(a,b,c),d.setDocCurrentView(a,b))}function y(a,b,c){var d,e=a.Elements.length,f,g,h,i,j;for(d=0;d<e;d+=1){h=a.Elements[d];if(h.hasOwnProperty("View")&&h.View.Name===b){f=h.View.arcplanDocument.Objects.Elements.length;for(g=0;g<f;g+=1){i=h.View.arcplanDocument.Objects.Elements[g];for(j in i)if(i[j].hasOwnProperty("ObjID")&&i[j].ObjID===c)return i}}}return null}function z(b,e,f,g,h){var i=a("#"+c.makeID(c.removeExtension(e),0)),j,l;typeof i=="object"&&(l=d.getDocViews(i),j=y(l,f,b),typeof g=="object"&&j!==null&&k.updateViewBaseProperties(j,g),typeof h=="object"&&j!==null&&k.updateViewObjectProperties(j,h))}var l={},m={viewRules:"",currentView:""};return l.applyViewByClientSize=function(a,b,c,d){var e=p(b,c,a),f=o(b,c);d.hasPendingUserinformation()||(x(a,e,d),w(a,f,d))},l.applyViewByName=function(a,b,c){c.hasPendingUserinformation()||(x(a,b,c),w(a,b,c))},l.applyCurrentView=function(a){u(a,m.currentView)},l.setViewRules=function(a,b,c){m.viewRules=a,m.currentView=o(b,c)},l.setInitialViewForDocument=function(a,b,c){var e=p(a,b,c);d.setDocCurrentView(c,e)},l.doViewsExist=function(){return m.viewRules!==""&&m.viewRules.Elements.length>0},l.updateViewProperties=function(a){l.doViewsExist()&&z(a.ObjID,a.Worksheet,a.View,a.BaseProperties,a.ObjectProperties)},l}),define("resizestrategyfactory",["jquery","logger","properties","objectresizer"],function(a,b,c,d){var e={};return e.createResizeStrategy=function(b,e){function g(a,b){return parseInt(c.getOrigWidth(a),10)<=b.width&&parseInt(c.getOrigHeight(a),10)<=b.height}function h(a,b){return parseInt(c.getOrigXPos(a),10)<=b.x&&parseInt(c.getOrigYPos(a),10)<=b.y}function i(a,b,d){var e,f,h,i;if(c.isFixedSizeAndPosition(a))return;f=parseInt(c.getOrigHeight(a),10),h=parseInt(c.getHeight(a),10),i=parseInt(c.getWidth(a),10),e={width:i,height:Math.max(h+d-b,f)},g(a,e)&&(c.setWidth(a,e.width),c.setHeight(a,e.height))}function j(a,b,d){var e;if(c.isFixedSizeAndPosition(a))return;e={x:c.getXPos(a),y:Math.max(parseInt(c.getYPos(a),10)+d-b,c.getOrigYPos(a))},h(a,e)&&(c.setXPos(a,e.x),c.setYPos(a,e.y))}function k(a,b,d){var e=parseInt(c.getOrigYPos(a),10),g=parseInt(c.getOrigHeight(a),10);f.origPos-f.tolerance<=e?j(a,b,d):e+g>f.origPos-f.tolerance&&(c.isSizeAdjustable(a)?i(a,b,d):j(a,b,d))}function l(a,b,d){var e;if(c.isFixedSizeAndPosition(a))return;e={x:Math.max(parseInt(c.getXPos(a),10)+d-b,parseInt(c.getOrigXPos(a),10)),y:parseInt(c.getYPos(a),10)},h(a,e)&&c.setXPos(a,e.x)}function m(a,b,d){var e,f,h,i;if(c.isFixedSizeAndPosition(a))return;f=parseInt(c.getOrigWidth(a),10),h=parseInt(c.getWidth(a),10),i=parseInt(c.getHeight(a),10),e={width:Math.max(h+d-b,f),height:i},g(a,e)&&c.setWidth(a,e.width)}function n(a,b,d){var e=parseInt(c.getOrigXPos(a),10),g=parseInt(c.getOrigWidth(a),10);f.origPos-f.tolerance<=e?l(a,b,d):e+g>f.origPos-f.tolerance&&(c.isSizeAdjustable(a)?m(a,b,d):l(a,b,d))}var f={objects:b,origPos:parseInt(e,10),tolerance:3};return{adjustObjectsVertically:function(b,c){var e,g;for(e=0;e<f.objects.length;e+=1)g=a("#"+f.objects[e].id),k(g,b,c),d.applyObjectDimensions(g)},adjustObjectsHorizontally:function(b,c){var e,g;for(e=0;e<f.objects.length;e+=1)g=a("#"+f.objects[e].id),n(g,b,c),d.applyObjectDimensions(g)}}},e}),define("resizelinefactory",["jquery","logger","stringtools","properties","resizestrategyfactory"],function(a,b,c,d,e){var f={constants:{horizontal:0,vertical:1}};return f.createResizeLine=function(a,b,c,d,g){function i(a,b){h.location.x=a,h.location.y=b}function j(a){var b=[];return typeof a=="object"&&typeof a.children=="function"&&(b=a.children()),b}var h={location:{x:0,y:0},limit:g,orientation:b,origPos:d,pos:c,resStrategy:undefined};h.resStrategy=e.createResizeStrategy(j(a),d);switch(b){case f.constants.horizontal:i(0,c);break;case f.constants.vertical:i(c,0)}return{setLocation:i,orientation:h.orientation,moveLine:function(a,b){var c=h.origPos,d,e,g,j,k;h.orientation===f.constants.horizontal?(d=b.height-c,e=a.height-h.location.y,g=e-d,j=h.location.x,k=Math.max(h.limit,h.location.y+g),i(j,k)):(d=b.width-c,e=a.width-h.location.x,g=e-d,j=Math.max(h.limit,h.location.x+g),k=h.location.y,i(j,k))},adjustObjectSizesAndPositions:function(){var a;h.orientation===f.constants.horizontal?(a=h.location.y,h.resStrategy.adjustObjectsVertically(h.pos,a)):(a=h.location.x,h.resStrategy.adjustObjectsHorizontally(h.pos,a)),h.pos=a}}},f}),define("layoutmanagement",["jquery","browserfeatures","logger","stringtools","properties","resizelinefactory","objectresizer","viewmanagement","layoutbehavior","stylesheethandler","objectpropertyapplier"],function(a,b,c,d,e,f,g,h,i,j,k){function n(){this.x=0,this.y=0,this.width=0,this.height=0,this.set=function(a,b){this.width=a,this.height=b}}function o(b){var c=new n,d,e,f,g,h;return b&&b.children&&(g=b.children(),typeof g=="object"&&g.length>0&&a.each(g,function(b,f){f.style.display!=="none"&&(h=a(f),d=parseFloat(h.width()),e=parseFloat(h.height()),!isNaN(d)&&!isNaN(e)&&(d>c.width&&(c.width=d),e>c.height&&(c.height=e)))})),c}function p(a,b,c,d,g,h){var i=f.createResizeLine(a,c,d,g,h),j,k=e.getDocResizeLineMap(a);k===undefined&&(k=[],e.setDocResizeLineMap(a,k)),typeof b=="object"&&b.selector!==undefined&&(k[b.selector]!==undefined?j=k[b.selector]:(j=[],k[b.selector]=j),j.push(i))}function q(){m.docSizeChangedListener&&m.docSizeChangedListener()}function r(a,b){var c=l.calculateObjectsRect(a);e.setDocInitialRect(a,c),l.updateLayout(a,b)}function s(a){var b=[];return typeof a=="object"&&typeof a.children=="function"&&(b=a.children()),b}function t(a){var b=e.getObjType(a),c=e.getScrollElem(a);switch(b){case"VerticalHierarchie":c.css("overflow-x","hidden");break;case"HorizontalHierarchie":c.css("overflow-y","hidden"),k.correctScrollElemWidthByOverflowYHidden(c,{overflowY:"hidden"})}}function u(b){var c=0;return b.children().each(function(){var b=a(this).height();c=Math.max(c,b)}),c}var l={},m={isFixedWindowSize:!1,pendingDocuments:[],docSizeChangedListener:undefined};return l.calculateObjectsRect=function(b){var c=new n,d,e,f,g,h;return b&&b.children&&(h=b.children(),typeof h=="object"&&h.length>0&&a.each(h,function(a,b){b.children&&b.children[0]&&b.style.display!=="none"&&b.children[0].style.display!=="none"&&(d=parseFloat(b.children[0].style.width),e=parseFloat(b.children[0].style.height),f=parseFloat(b.children[0].style.left),g=parseFloat(b.children[0].style.top),d+f>c.width&&(c.width=d+f),e+g>c.height&&(c.height=e+g))})),c},l.applyLayoutToUpdatedObject=function(a){g.applyObjectDimensions(a)},l.makeResizeable=function(b,c){var d=e.getDocResizeLineMap(b),g,h;if(typeof d=="object"){for(g in d)h=a(g),e.setResizeable(h,!1);d=[],e.setDocResizeLineMap(b,d)}e.setResizeable(c,!0),p(b,c,f.constants.horizontal,parseInt(e.getYPos(c),10)+parseInt(e.getHeight(c),10),parseInt(e.getOrigYPos(c),10)+parseInt(e.getOrigHeight(c),10),parseInt(e.getYPos(c),10)+parseInt(e.getOrigHeight(c),10)),p(b,c,f.constants.vertical,parseInt(e.getXPos(c),10)+parseInt(e.getWidth(c),10),parseInt(e.getOrigXPos(c),10)+parseInt(e.getOrigWidth(c),10),parseInt(e.getXPos(c),10)+parseInt(e.getOrigWidth(c),10))},l.moveResizeLines=function(a,b,c){var d=e.getDocInitialRect(a),f=e.isDocLayoutManaged(a),g=e.getDocResizeLineMap(a),h,i,j,k={width:b,height:c};if(f&&d&&d.height>0&&d.width>0)for(h in g){i=g[h];for(j in i)i[j].moveLine(k,d),i[j].adjustObjectSizesAndPositions()}},l.setDocSizeChangedListener=function(a){m.docSizeChangedListener=a},l.setDocSizeInDataAttribute=function(a){var b,c,d=l.calculateObjectsRect(a);b=d.width+d.x,c=d.height+d.y,a.attr("data-doc-size",""+b+" "+c)},l.setDocSize=function(a,b,c){var d,f,g,h=a?a.offset():{};a&&!e.hasDocFixedSize(a)&&(d=l.calculateObjectsRect(a),f=d.width+d.x,g=d.height+d.y,b-parseFloat(h.left)>f?(a.width("100%"),e.setDocWidth(a,b-parseFloat(h.left))):(a.width(f),e.setDocWidth(a,f)),c-parseFloat(h.top)>g?(a.height("100%"),e.setDocHeight(a,c-parseFloat(h.top))):(a.height(g),e.setDocHeight(a,g)))},l.setArcContainerDivExtend=function(){var b=o(a("#arcContainer"));a("#arcContainer").css("width",b.width).css("height",b.height)},l.updateLayout=function(b,c){var f,g,i=b?e.getDocLayoutObjectID(b):undefined,j,k,n,o,p,r,s=a("#arcContainer"),t=s.css("display")!=="none"?s.offset():s.parent().offset();if(typeof b=="object"){if(h.doViewsExist()||typeof i=="string")f=a(window).width(),g=a(window).height(),o=b.offset(),m.isFixedWindowSize===!1&&(p=f-t.left,r=g-t.top,h.applyViewByClientSize(b,p,r,c)),typeof i=="string"&&(o=b.offset(),j=e.getDocName(b),k=i,n=a("#"+d.makeID(j,k)),n.length!==0&&(l.makeResizeable(b,n),l.moveResizeLines(b,f-o.left,g-o.top)),l.setDocSize(b,parseFloat(a(window).width()),parseFloat(a(window).height())),l.setArcContainerDivExtend(b));l.setDocSizeInDataAttribute(b),q()}},l.addToPendingLayoutDocuments=function(a){var b=!1,c;for(c=0;c<m.pendingDocuments.length;c+=1)if(m.pendingDocuments[c]===a){b=!0;break}return b||m.pendingDocuments.push(a),m.pendingDocuments},l.updatePendingLayoutDocuments=function(b){var c;if(b)for(c=0;c<m.pendingDocuments.length;c+=1)l.updateLayout(a("#"+m.pendingDocuments[c]),b);m.pendingDocuments.length=0},l.initialize=function(a,b){m.isFixedWindowSize=!1,r(a,b)},l.initializeWithFixedWindowSize=function(a){m.isFixedWindowSize=!0,e.setDocInitialRect(a,new n)},l.resetLayoutManagement=function(b){var c=s(b),d,f;if(e.isDocLayoutManaged(b))for(f=0;f<c.length;f+=1)d=a("#"+c[f].id),e.setYPos(d,e.getOrigYPos(d)),e.setXPos(d,e.getOrigXPos(d)),e.setWidth(d,e.getOrigWidth(d)),e.setHeight(d,e.getOrigHeight(d)),g.applyObjectDimensions(d)},l.adjustObjectHeight=function(b,c,f){var h=e.getDocLayoutObjectID(b),i=e.getOrigHeight(c),j=Math.max(i,f),k,m,n,o,p,q=a(window).width(),r=a(window).height(),s=e.getBorder(c),t=g.getVerticalAdjustment(s,c),u=e.isDocLayoutManaged(b);if(!u)return;if(j!==e.getHeight(c)){l.makeResizeable(b,c),k=e.getDocResizeLineMap(b)[c.selector];for(m=0;m<k.length;m+=1){if(k[m].orientation===1)continue;k[m].setLocation(parseInt(e.getXPos(c),10),parseInt(e.getYPos(c),10)+parseInt(j,10)+t),k[m].adjustObjectSizesAndPositions()}n=b.offset(),o=e.getDocName(b),typeof h=="string"&&(p=h.replace("[OBJ",""),p=p.replace("]",""),c=a("#"+d.makeID(o,p)),c.length!==0&&(l.makeResizeable(b,c),l.moveResizeLines(b,q-n.left,r-n.top)))}},l.adjustObjectWidth=function(b,c,f){var h=e.getDocLayoutObjectID(b),i=e.getOrigWidth(c),j=Math.max(i,f),k,m,n,o,p,q=a(window).width(),r=a(window).height(),s=e.getBorder(c),t=g.getHorizontalAdjustment(s,c),u=e.isDocLayoutManaged(b);if(!u)return;if(j!==e.getWidth(c)){l.makeResizeable(b,c),k=e.getDocResizeLineMap(b)[c.selector];for(m=0;m<k.length;m+=1){if(k[m].orientation===0)continue;k[m].setLocation(parseInt(e.getXPos(c),10)+j+t,parseInt(e.getYPos(c),10)),k[m].adjustObjectSizesAndPositions()}n=b.offset(),o=e.getDocName(b),typeof h=="string"&&(p=h.replace("[OBJ",""),p=p.replace("]",""),c=a("#"+d.makeID(o,p)),c.length!==0&&(l.makeResizeable(b,c),l.moveResizeLines(b,q-n.left,r-n.top)))}},l.adjustObjectSizeIfNecessary=function(b){var c,f,g,h,j,k,m,n=e.getBorder(b),o;if(e.getObjType(b)==="VerticalHierarchie"||e.getObjType(b)==="HorizontalHierarchie")g=a("ol:first",b),c=e.getDocName(b),f=d.makeID(e.getDocName(b),0),k=a("#"+f),j=e.isDocLayoutManaged(k),parseInt(e.getLayoutBehavior(b),10)===i.EAdjustToContent&&j&&g.length>0&&(t(b),e.getObjType(b)==="VerticalHierarchie"?e.isUseContentPaging(b)?l.adjustObjectWidth(k,b,e.getContentWidth(b)):l.adjustObjectWidth(k,b,g[0].scrollWidth):(o=u(g),l.adjustObjectHeight(k,b,o)))},l}),define("events/eventcallbacks",["events/eventid","logger","ui","stringtools","nodetypes","properties","layoutmanagement","popuphandler","popupkeyeventhandler","browserfeatures","tablekeyboardhandler","keycodes"],function(a,b,c,d,e,f,g,h,i,j,k,l){function q(a,b){return p.executePendingBlurEvent()?(p.setPendingEvent({callback:b,event:a}),!0):!1}function r(a){var b={docName:undefined,objID:undefined,ref:a.data.ref};return a.data.ref&&(b.docName=f.getDocName(a.data.ref),b.objID=f.getID(a.data.ref)),b}function s(a){switch(a.type){case"checkbox":return a.parentNode&&(a.parentNode.tagName==="LI"||$(a).parent().hasClass("arcLabelContainer"))?c.getNodeInfo(a).row:a.checked?"1":"0";case"text":case"textarea":case"password":return a.value;default:return""}}function t(a,b){var c;b!==undefined&&a!==undefined&&(a.children().length>0?(c=a.find("input:first"),c.length>0?c.attr("value",b):a.children().first().text(b)):a.text(b))}function u(a){var b;return a&&(b=a.srcElement,b||(b=a.target)),b}function v(a,b,c,d){var e,f;if(b&&typeof b.tagName=="string"&&b.tagName.toLowerCase()==="g")for(e=0;e<b.childNodes.length;e+=1)f=b.childNodes.item(e),v(a,f,c,d);else b&&b.id!==c&&typeof b.tagName=="string"&&b.tagName.toLowerCase()!=="effect"&&b.style&&!a.test(b.id)&&b.getAttribute("pointer-events")!=="none"&&(b.style.opacity=d)}function w(a,b,c){if(a){var d=a.getElementById("content"),e,f,g=b,h,i;if(!d)return;i=new RegExp("^[0-9]{3}(_[0-9]{3}_[0-9]{3}_)[0-9]{3}.*"),g=i.exec(g),h=new RegExp("^[0-9]{3}"+g[1]+"[0-9]{3}.*");for(e=0;e<d.childNodes.length;e+=1)f=d.childNodes.item(e),v(h,f,b,c)}}function x(a){if(a.hasClass("arcTdInnerDiv")){while(!a.is("td")&&!a.is("body")&&a.length>0)a=a.parent();if(a.is("body"))return}!a.is(":disabled")&&(!j.mobile||!a.is("input"))&&!a.hasClass("arcHpCbox")&&(a.addClass("arcClicked"),window.setTimeout(function(){$(a).removeClass("arcClicked")},500))}function y(a){var b;return a&&(b=a.split("|").join("||")),b}function z(a,b,c){var d=f.getSelectedCell(a),e=f.getNumRows(a),g=f.getNumCols(a),h=$("td.selected",a);if(d)switch(b){case l.Tab:k.handleTab(a,h,c);break;case l.Enter:k.handleEnter(a,h,c)}}var m={},n=!1,o,p;return m.setRequestProcessor=function(a){o=a,i.setDoSendEventCallback(a.doSendEvent)},m.setEventSetter=function(a){p=a},m.getTarget=function(a){var b=a.target,c;b.nodeType===e.TEXT_NODE&&(b=b.parentNode);if(b.tagName==="IMG"&&a.data.ref){c=f.getObjType(a.data.ref);switch(c){case"Field":case"Column":case"Row":case"Table":case"Menu":case"CheckboxGroup":case"RadioGroup":case"Switch":case"VerticalHierarchie":case"HorizontalHierarchie":case"MenuHierarchie":b=b.parentNode}}return b.tagName==="NOBR"&&(b=b.parentNode),b.tagName==="SPAN"&&b.parentNode.tagName==="BUTTON"&&(b=b.parentNode),b.ownerSVGElement&&(b=b.ownerSVGElement),b},m.getClickPos=function(a,b){var d,e,g,h;switch(a.tagName.toUpperCase()){case"IMG":return b.offsetX===undefined?(g=b.pageX-$(a).offset().left,h=b.pageY-$(a).offset().top):(g=b.offsetX,h=b.offsetY),{x:g,y:h};case"SVG":return g=b.pageX-parseInt(f.getXPos(b.data.ref),10),h=b.pageY-parseInt(f.getYPos(b.data.ref),10),{x:g,y:h};case"DIV":if($(a).hasClass("arcTdInnerDiv")||$(a).hasClass("arcTdInnerDivFixedHeight")){while(a.parentElement&&a.parentElement.tagName!=="TD")a=a.parentElement;if(a.parentElement&&a.parentElement.tagName==="TD")return c.getCellPosition(a.parentElement)}break;case"TD":return c.getCellPosition(a);case"LABEL":case"A":case"INPUT":d=a.parentNode,$(d).hasClass("arcLabelContainer")&&(d=$(d).parent()[0]),e=c.getCellPosition(d);if(e.x!==-1)return e;break;case"LI":e=c.getCellPosition(a);if(e.x!==-1)return e;break;case"BUTTON":return{x:0,y:0}}return{x:-1,y:-1}},m.getValue=function(a,b){var d;switch(a.tagName){case"LABEL":case"A":if(a.parentNode&&a.parentNode.tagName==="LI")return c.getNodeInfo(a).row;break;case"LI":return c.getNodeInfo(a).row;case"SPAN":if(a.parentNode&&(a.parentNode.tagName==="LABEL"||a.parentNode.tagName==="A")&&a.parentNode.parentNode&&a.parentNode.parentNode.tagName==="LI")return c.getNodeInfo(a.parentNode).row;break;case"INPUT":case"TEXTAREA":return s(a);case"BUTTON":return"";case"DIV":if($(a).hasClass("cke_editable_inline"))return d=f.getHTMLEditor(b),d.getData();return;default:return'"null"'}},window.highlight=function(a,b){var c=u(a);w(c.ownerDocument,b,.5)},window.reverthighlight=function(a,b){var c=u(a);w(c.ownerDocument,b,1)},m.clickOnSwitch=function(c){if(q(c,m.clickOnSwitch))return;var d=r(c),e=$("#"+c.data.id),g=m.getTarget(c),h=f.getYSettingValue(e)===1?0:1,i=$(g);x(i),o.setLastMouseDownPos(c),b.log("Event clickOnSwitch for doc: "+d.docName+" and id: "+d.objID),o.doSendEvent(d.docName,d.objID,a.EID_SWITCH,h)},m.onMenuClick=function(a){if(q(a,m.onMenuClick))return;var b=r(a),c=m.getTarget(a),d;a.preventDefault(),a.stopImmediatePropagation(),c&&(d=h.handleMenuPopupEvent(a,$(c)),d&&o.doSendEvent(b.docName,b.objID,d.eventType,d.value))},m.onTableKeyDown=function(a){if(q(a,m.onTableKeyDown))return;var b=r(a),c=m.getTarget(a);c&&a.type==="keydown"&&k.handleKeyPressEvent(a)},m.onTableKeyPress=function(a){if(q(a,m.onTableKeyPress))return;var b=r(a),c=m.getTarget(a),d;c&&a.type==="keypress"&&k.handleKeyPressEvent(a)},m.onHierClick=function(c){var d=r(c),e=m.getTarget(c),g,i=m.getClickPos(e,c),j=m.getValue(e,d.ref),k=a.EID_CLICK,l=!0,n,p,s;if(e){g=$(e),f.getObjType(d.ref)!=="MenuHierarchie"&&x(g);if(g.is("input")&&g.is(":checkbox")&&!g.hasClass("arcHpCbox"))g.is(":checked")?k=a.EID_OPENNODE:k=a.EID_CLOSENODE;else if((g.is("label")||g.is("a")&&g.text()!=="Too much data")&&f.getObjType(c.data.ref)!=="MenuHierarchie")k=a.EID_SELECTNODE,c.preventDefault(),c.stopImmediatePropagation();else if(g.is("a")&&g.text()==="Too much data")l=!1;else if(g.hasClass("arcHierPopup")||g.hasClass("arcHierPopupSelection")||h.isCurrentPopup(c.data.ref)){if(q(c,m.onHierClick))return;n=h.handlePopupEvent(c,g),typeof n=="object"&&(i.x=undefined,i.y=undefined,l=n.sendEvent,j=n.value,k=n.eventType,n.stopPropagation&&(c.preventDefault(),c.stopImmediatePropagation()))}}k===a.EID_CLICK&&(p=c.shiftKey,s=c.ctrlKey),l&&(o.setLastMouseDownPos(c),b.log("clickOnHierNode fr doc:"+d.docName+" and id: "+d.objID),o.doSendEvent(d.docName,d.objID,k,j,i.y,i.x,undefined,p,s)),h.showPendingPopupPos()},m.onHierMouseDown=function(c){var d=r(c),e=m.getTarget(c),g,h=m.getValue(e,d.ref),i,j,k,l,n;e&&(e.tagName.toUpperCase()==="SPAN"&&(e=$(e).parent()[0]),g=m.getClickPos(e,c),j=e.tagName==="LABEL"||e.tagName==="LI"||e.tagName==="SPAN"||e.tagName==="A"&&e.textContent!=="Too much data",k=f.getObjType(c.data.ref)!=="MenuHierarchie",l=c.offsetX||c.pageX-$(e).offset().left,n=l>3||f.getObjType(c.data.ref)!=="VerticalHierarchie"||e.tagName!=="LI",j&&k&&n&&(c.preventDefault(),o.setLastMouseDownPos(c),b.log("mousedownOnHierNode fr doc:"+d.docName+" and id: "+d.objID),o.doSendEvent(d.docName,d.objID,a.EID_SELECTNODE,h,g.y,g.x,undefined,c.shiftKey,c.ctrlKey)))},m.onButtonClickCallback=function(c,d,e,f){var g="",h=0,i=0,j;o.hasPendingUserinformation()||(b.log("button click fr doc:"+c+" and id: "+d),o.doSendEvent(c,d,a.EID_CLICK,g,h,i,j,e,f))},m.onClick=function(c){if(q(c,m.onClick))return;var d=r(c),e=m.getTarget(c),g=c.data.clickPos||m.getClickPos(e,c),h=m.getValue(e,d.ref),i,j,k=c.data.container||d.ref.closest(".arcContainer");d.objID&&(f.setDocSelectedObject(k,d.ref[0].id),o.hasPendingUserinformation()||(j=$(e),x(j),o.setLastMouseDownPos(c),b.log("click fr doc:"+d.docName+" and id: "+d.objID),o.doSendEvent(d.docName,d.objID,a.EID_CLICK,h,g.y,g.x,undefined,c.shiftKey,c.ctrlKey)))},m.onDocumentClick=function(a){var b;a.eventPase===Event.AT_TARGET&&f.setDocSelectedObject(a.data.container,undefined),a.data.activationCallback&&a.data.getTopDocNameCallback&&(b=f.getDocName(a.data.container),b!==a.data.getTopDocNameCallback()&&a.data.activationCallback(b,a.data.container))},m.onChange=function(c){if(q(c,m.onChange))return;var d=r(c);b.log("Event change for doc: "+d.docName+" and id: "+d.objID),o.doSendEvent(d.docName,d.objID,a.EID_SWITCH,c.target.value)},m.onInput=function(c){var d=r(c),e=m.getTarget(c),g=m.getValue(e,d.ref),h=c.data.clickPos||m.getClickPos(e,c),i=c.keyCode;z(d.ref,i,c.shiftKey);if(c.data.ref&&f.getObjType(c.data.ref)==="CheckboxGroup"&&e&&e.tagName!=="INPUT")return!1;if(e.tagName==="TEXTAREA"&&g===c.data.ref.text())return b.log("Input canceled for doc: "+d.docName+" and id: "+d.objID),!1;b.log("Event Input for doc: "+d.docName+" and id: "+d.objID),t(c.data.target,g),o.doSendEvent(d.docName,d.objID,a.EID_INPUT,y(g),h.y,h.x,c.keyCode,c.shiftKey,c.ctrlKey)},m.onResize=function(a){h.onResize(),g.updateLayout(a.data.container,o),g.setDocSize(a.data.container,parseFloat($(window).width()),parseFloat($(window).height()))},m.onPopupFunction=function(a){var b=m.getTarget(a);h.handlePopupFunctionEvent(b)},m.onDrop=function(b){var c=r(b),d=m.getTarget(b),e=b.data.text,f=m.getClickPos(d,b);b.preventDefault(),n&&(n=!1,o.doSendEvent(c.docName,c.objID,a.EID_DROP,e,f.y+1,f.x+1))},m.onDragStart=function(a){var b=r(a),c="["+b.docName+";OBJ"+b.objID+"]";n=!0,a.data.setText(c)},m}),define("draganddrop",["events/eventcallbacks","events/eventdatafactory"],function(a,b){function m(a){a.addClass("arcNoUserSelect").on("selectstart.draganddrop",function(a){if(e===!0)return!1})}function n(a){a.removeClass("arcNoUserSelect").off("selectstart.draganddrop")}function o(){$.each($(".arcDropArea"),function(){var a=$(this).children().first(),c=$(this)[0].id,d=b.createInstance(c,$("#"+c));a.off("mouseup.draganddrop"),a.off("mouseover.draganddrop"),a.off("mouseout.draganddrop"),a.on("mouseup.draganddrop",d,j),a.on("mouseover.draganddrop",function(a){$(a.target).css("cursor","copy")}),a.on("mouseout.draganddrop",function(a){$(a.target).css("cursor","")})})}function p(b){b.data.setText=function(a){f=a},$("body").css("cursor","no-drop"),$(".arcClickable").css("cursor","inherit"),a.onDragStart(b)}var c={},d=!1,e=!1,f,g,h,i,j,k,l;return i=function(){e=!1,l=undefined,$("body").off("mousemove.draganddrop"),$(document).off("mouseup.draganddrop",i),n($("body")),n($(".arcNoUserSelect")),d&&(d=!1,$.each($(".arcDropArea"),function(){var a=$(this).children().first();a.off("mouseup.draganddrop mouseover.draganddrop mouseout.draganddrop"),a.css("cursor","")}),$("body").css("cursor",""),$(".arcClickable").css("cursor",""))},j=function(c){return c.stopPropagation(),c.preventDefault(),i(),c.data.text=f,a.onDrop(c),!1},k=function(b){var c,f,i;return c=b.originalEvent.pageX-g,f=b.originalEvent.pageY-h,i=Math.sqrt(c*c+f*f),e&&!d&&i>=5&&(d=!0,p(b),$("body").off("mousemove.draganddrop",k),o()),!1},c.makeDraggable=function(a){var c=b.createInstance(a[0].id,a),f=a.children(),j=a.children("div").children("div");f.addClass("arcDraggable"),l&&e&&l[0].id===a[0].id&&(m(f),d?o():$("body").on("mousemove.draganddrop",c,k)),f.on("mousedown.draganddrop",c,function(b){g=b.originalEvent.pageX,h=b.originalEvent.pageY,i(),l=a,m(f),m($("body")),e=!0,$("body").off("mousemove.draganddrop"),$("body").on("mousemove.draganddrop",b.data,k),$(document).off("mouseup.draganddrop"),$(document).on("mouseup.draganddrop",b.data,i)})},c.makeDropable=function(a){var c=b.createInstance(a[0].id,a);a.addClass("arcDropArea")},c.onScroll=function(){i()},c}),define("htmleditor",["jquery","properties","events/eventcallbacks","events/eventdatafactory","logger","keycodes","ui","browserfeatures","popuphandler"],function(a,b,c,d,e,f,g,h,i){function o(){var b=a(document);b.off("mousedown.htmleditor",q),h.nativeTouchControls&&(b.off("touchstart.htmleditor",q),b.off("MSPointerDown.htmleditor",q)),j=!1,l=!1}function p(a){var b;typeof CKEDITOR!="undefined"&&(b=CKEDITOR.instances[n+a[0].id],b&&b.destroy(!0))}function q(a){var b={};j=g.hasTargetObjectClickEvent(a.target),j&&(b.data=a.data,b.target=a.data.target,b.data.target=undefined,k.setPendingBlurEvent(b))}function r(c,e,g,j,k){var m=b.getHTMLEditor(c),o=c[0].id,p={},r,t;e.off("click.htmleditor"),e.on("click.htmleditor",function(a){a.preventDefault(),a.stopImmediatePropagation()}),m&&m.destroy(),require([window.require.toUrl("../lib/ckeditor/ckeditor.js")],function(){s(p),p.startupFocus=j,m=CKEDITOR.inline(n+o,p),m.setData(g),t=b.getIsEditable(c),r=b.isActive(c),r&&t?(b.setHTMLEditor(c,m),m.on("blur",k,!1,{id:o}),m.on("key",function(b){b.data.keyCode===f.ESC&&(l=!0,a("#"+n+o).trigger("blur"))}),m.on("focus",function(e){var f=a(document),j=d.createInstance(o,c);b.setHtmlSource(c,g),i.hideCurrentPopup(),j.target=a("#"+n+o)[0],f.on("mousedown.htmleditor",j,q),h.nativeTouchControls&&(f.on("touchstart.htmleditor",j,q),f.on("MSPointerDown.htmleditor",j,q))})):m.on("instanceReady",function(e){var f=m.getData();b.setHTMLEditor(c,undefined),m.destroy(),a("#"+n+o).html(f)})})}function s(a){a.contentCss="",a.customConfig="",a.browserContextMenuOnCtrl=!0,a.removePlugins="contextmenu,tabletools,liststyle",a.enterMode=window.CKEDITOR.ENTER_BR,a.title=!1,a.toolbar=[["Cut","Copy","Paste","-","Undo","Redo"],["Bold","Italic","Underline"],["Font","FontSize","TextColor","BGColor"],["Outdent","Indent"],["NumberedList","BulletedList"]],a.allowedContent={br:{attributes:!1,classes:!1,styles:!1},span:{attributes:!1,classes:!1,styles:"font-family,font-size,color,background-color"},strong:{attributes:!1,classes:!1,styles:!1},em:{attributes:!1,classes:!1,styles:!1},u:{attributes:!1,classes:!1,styles:!1},"div ul ol":{attributes:!1,classes:!1,styles:"margin-left"},li:{attributes:!1,classes:!1,styles:!1}}}function t(e,f){var g={},h=b.getHTMLEditor(f);l?h.setData(b.getHtmlSource(f)):h.checkDirty()&&(g.data=d.createInstance(e,f),g.target=a("#"+n+e)[0],typeof g.target!="undefined"&&(j||c.onInput(g))),o()}function u(b){var c=b.listenerData.id,d=a("#"+c);t(c,d)}function v(b){var c=b.listenerData.id,d=a("#"+c);t(c,d),d.children().first().remove(),d.children().first().css("display","block")}var j=!1,k,l=!1,m={},n="editorContainerFor_";return m.setEventSetter=function(a){k=a},m.removeAllHtmlEditorInstances=function(){var a,b;if(typeof CKEDITOR!="undefined"){for(b in CKEDITOR.instances)a=CKEDITOR.instances[b],a.destroy(!0),a=null;o()}},m.initializeEditor=function(a,b,c){var d=!1;r(a,b,c,d,u)},m.initializeEditorForNotInitialHtmlText=function(a,b,c){var d=!0;p(a),r(a,b,c,d,v)},m.initializeEditorForVHTMLField=function(a,b,c){function e(a){o()}var d=!1;p(a),r(a,b,c,d,e)},m}),define("userparam",["stringtools","logger"],function(a,b){var c={},d={};return c.setParam=function(a,c){!a||typeof a!="string"&&typeof a!="number"?b.error("Invalid UserParam Name: "+a):!c||typeof c!="string"&&typeof c!="number"?typeof c=="undefined"?d[a]&&delete d[a]:typeof c=="function"?b.error("Code Injection is not supported "+a):b.error("Parameter mismatch: "+a):d[a]=c},c.getParam=function(a){if(!a||typeof a!="string"&&typeof a!="number"){b.error("Invalid UserParam Name: "+a);return}return d[a]},c.getNumParams=function(){var a,b=0;for(a in d)d.hasOwnProperty(a)&&(b+=1);return b},c.clear=function(){var a;for(a in d)d.hasOwnProperty(a)&&delete d[a]},c.serialize=function(){var b,c="";for(b in d)d.hasOwnProperty(b)&&(c+="<Name>"+a.escapeForXml(b)+"</Name>",c+="<Text>"+a.escapeForXml(d[b])+"</Text>");return c},c}),define("version",["logger"],function(a){var b="8.2.0.7059",c={};return c.getVersion=function(){var a=b.split("."),c=a[3].substr(0,2);return parseInt(a[0],10)*16777216+parseInt(a[1],10)*65536+parseInt(a[2],10)*256+parseInt(c,10)},c.getReadableVersion=function(){return b},c.logVersion=function(){a.log("arcplan HTML5 client, version "+c.getReadableVersion())},c}),define("motionchartviewmodel",["logger","animationfactory"],function(a,b){function c(c,d){function f(b,c){var d=e.svgRoot[0].getScreenCTM(),f=e.svgRoot[0].createSVGPoint();return f.x=b,f.y=c,isNaN(f.x)?(a.warn("wrong Point: p.x: "+f.x+" event: "+event),f={x:-1,y:-1}):f=f.matrixTransform(d.inverse()),f}function g(a){return f(a.clientX,a.clientY)}function h(a){return a.touches&&a.touches.length>0?f(a.touches[0].clientX,a.touches[0].clientY):{x:-1,y:-1}}function i(a,b){return a/(b-1)}function j(b){var c=$("#sliderHandle",e.svgRoot),d=e.sliderValues.split(";"),f,g,h,j;e.sliderValues&&e.sliderValues.length===0&&a.warn("There are no values for slider positions."),b.x!==-1&&b.y!==-1&&(f=k(b,d),f>=0?(h=d.length,j=i(f,h),o(j)):a.warn("wrong index: "+f+"SVGPoint: "+"x:"+b.x+"y:"+b.y))}function k(a,b){var c,d,e,f,g;return c=parseFloat(b[0]),d=parseFloat(b[b.length-1]),e=Math.max(a.x,c),e=Math.min(e,d),g=(e-c)/(d-c),f=Math.round(parseFloat(b.length-1)*g),f}function l(a,b,c,d){var e,f,g,h,i=b.Elements?b.Elements[1].NumRows:0,j=b.Elements?b.Elements[0].NumCols:0,k;a&&(e=a.attr("id"),typeof e=="string"&&(h=(new RegExp("^[0-9]{3}_([0-9]{3})_([0-9]{3})_[0-9]{3}.*")).exec(e),h.length===3&&(f=parseInt(h[1],10),g=parseInt(h[2],10),!isNaN(f)&&!isNaN(g)&&!isNaN(j)&&!isNaN(i)&&(c?k=2+f*j+g:k=2+g*j+f,k<i*j+2&&(d.textContent=b.Elements[k].ToolTip)))))}function m(a,b){var c=$("title",e.svgRoot),d,f,g;for(d=0;d<c.length;d+=1)f=c[d],g=$(f).parent(),l(g,a,b,f)}function n(a){var b,c=e.TooltipMap.Elements[0].transposed==="true";a+1<e.TooltipMap.Elements.length&&e.TooltipMap.Elements[a+1].ToolTip&&(b=e.TooltipMap.Elements[a+1].ToolTip,m(b,c))}function o(a){var b=Math.round(parseFloat(e.settings.length-1)*a),c,d=!1,f=e.animations.length;b>=0&&e.settings[b]&&(e.currentSetting(e.settings[b]),e.TooltipMap&&n(b));for(c=0;c<f;c+=1)d=e.animations[c].setAnimationToFractionOfDuration(a)||d;e.isRunning()&&d&&e.pauseUnpauseAnimation()}function p(a){var b=a/(e.duration*1e3);o(b)}function q(){var a=0,b=$("#sliderHandle",e.svgRoot),c,d=e.sliderValues.split(";"),f,g,h,i,j;return j=b.attr("x"),d.length>1&&(f=parseFloat(d[0]),g=parseFloat(d[d.length-1]),h=Math.max(j,f),h=Math.min(h,g),i=(h-f)/(g-f),i>=1?a=0:a=i*e.duration*1e3),a}function r(a){var c=$("animate,animateTransform",a),d=[],f,g,h,i,j=c.length;for(g=0;g<j;g+=1){h=$(c[g]),i=h.attr("values"),i||h.attr("from")&&h.attr("to")&&(i=h.attr("from")+";"+h.attr("to"));if(!i)continue;f=b.createAnimation(h.parent()[0],h.attr("attributeName"),i,parseFloat(h.attr("dur"))),$(h.parent()[0]).attr("id")==="sliderHandle"&&(e.sliderValues=h.attr("values"),e.sliderValues||h.attr("from")&&h.attr("to")&&(e.sliderValues=h.attr("from")+";"+h.attr("to"))),d.push(f),e.duration=parseFloat(h.attr("dur")),h.remove()}return d}var e=this;e.settings=[],e.svgRoot=$(c),e.requestId=0,e.duration=1,e.starttime=0,e.sliderValues="",e.TooltipMap=[],e.setSliderPosition=function(a,b){var c=g(b);j(c)},e.currentCursor=document.body.style.cursor,e.setHandCursor=function(a,b){e.currentCursor=b.target.style.cursor,b.target.style.cursor="pointer"},e.resetCursor=function(a,b){b.target.style.cursor=e.currentCursor},e.isRunning=d.observable(!1),e.isDragging=d.observable(!1),e.currentSetting=d.observable(""),e.startDragSlider=function(a,b){var c;this.isDragging(!0),this.svgRoot&&this.isRunning()&&(c=$("currentValue",this.svgRoot),this.isRunning(!1),this.svgRoot[0].pauseAnimations(),c&&c.attr("opacity",1))},e.stopDragSlider=function(a,b){this.isDragging(!1)},e.handleMouseMove=function(a,b){if(this.isDragging()){var c=g(b);j(c)}},e.touchMoveSlider=function(a,b){if(this.isDragging()){var c=h(b);j(c)}},e.pauseUnpauseAnimation=function(a){var b,c;this.svgRoot&&(c=$("#currentValue",this.svgRoot),this.isRunning(!this.isRunning()),this.isRunning()?(b=q(),this.starttime=Date.now()-b,this.requestId=window.requestAnimationFrame(this.step)):this.requestId&&window.cancelAnimationFrame(this.requestId))},e.handleEndEvent=function(a){this.isRunning(!1)},e.setSettings=function(){for(var a=0;a<arguments.length;a+=1)this.settings[a]=arguments[a];this.settings.length>0&&this.currentSetting(this.settings[0])},e.setTooltips=function(a){e.TooltipMap=a.ToolTipMap},e.animations=r(c),e.isClosed=!1,e.step=function(a){!e.isClosed&&e.isRunning()&&(p(Date.now()-e.starttime),e.requestId=window.requestAnimationFrame(e.step))},o(0),function(){$(e.svgRoot).unload(function(){e.isClosed=!0,e.isRunning(!1),e.requestId&&window.cancelAnimationFrame(e.requestId)})}()}return{CMotionChartViewModel:c}}),define("texthtmlgenerator",["properties","tools","objectresizer","styleborderprops"],function(a,b,c,d){function f(b,c){var e=b[0].id,f=$("<div></div>"),g=$("<div></div>"),h=$("<div></div>"),i=$("<div></div>"),j=a.getZIndex(b),k={left:"0px",top:"0px",position:"relative"},l=a.getForegroundColor(b),m=a.getBackgroundColor(b),n={color:l,backgroundColor:m},o=d.getBorderStyleObject(b),p;return p="dynaText",h.append(i),g.append(h),f.append(g),$("div",f).addClass(p).css(k),f.addClass(p),o||(o={}),f.css(n).css(o),i.attr("id","editorContainerFor_"+e),i.attr("contenteditable",a.getIsEditable(b)?"true":"false"),f.css("z-index",j),h.css("z-index",j+1),f[0].outerHTML}var e={};return e.buildHtml=function(b,d){if(typeof d!="object")return a.setContent(b,undefined),d;a.setContent(b,d),b[0].innerHTML=f(b),c.applyObjectDimensions(b)},e.buildHtmlForNotInitialHtmlText=function(b){b.prepend(f(b)),a.setXPosChanged(b,!0),a.setYPosChanged(b,!0),a.setWidthChanged(b,!0),a.setHeightChanged(b,!0),c.applyObjectDimensions(b)},e.convertTextToHtml=function(a,b){var c,d,e,f,g,h="",i=40,j,k=$("<span></span>");k.css(b),c=a.replace(/\n\r/g,"\n"),c=c.replace(/\r/g,"\n"),d=c.split("\n"),f=d.length;for(e=0;e<f;e+=1){g=d[e],j=0;while(g.indexOf("\t")===0)g=g.substr(1),j+=i;j>0?(h+="<div style='margin-left:"+j+"px'>",h+="<span>"+g+"</span></div>"):(g!==""&&(h+="<span>"+g+"</span>"),h+="<br>")}return k.html(h),k[0].outerHTML},e}),define("events/eventsetterfactory",["events/eventcallbacks","events/eventdatafactory","draganddrop","logger","properties","tools","htmleditor","texthtmlgenerator","textinput"],function(a,b,c,d,e,f,g,h,i){function j(){function m(c){switch(e.getObjType(c)){case"RadioGroup":break;case"VerticalHierarchie":case"HorizontalHierarchie":case"MenuHierarchie":break;case"Menu":break;default:c.on("click",b.createInstance(c[0].id,c),a.onClick).addClass("arcClickable")}}function n(b){switch(e.getObjType(b)){case"RadioGroup":case"VerticalHierarchie":case"HorizontalHierarchie":case"MenuHierarchie":case"Menu":break;default:b.off("click",a.onClick).removeClass("arcClickable")}}function o(a){switch(e.getObjType(a)){case"Field":case"Row":case"Column":case"Table":case"Menu":case"MenuHierarchie":case"HorizontalHierarchie":case"VerticalHierarchie":c.makeDropable(a)}}function p(c,d){q(c),$("button",c).on("mouseup.eventsetter",function(a){e.getYSettingValue(c)===1&&$(this).removeClass("arcChecked")}).on("mousedown.eventsetter",function(a){e.getYSettingValue(c)===0&&$(this).addClass("arcChecked")}).addClass("arcClickable").on("click.eventsetter",b.createInstance(d,c),a.clickOnSwitch)}function q(a){$("button",a).off("mouseup.eventsetter").off("mousedown.eventsetter").off("click.eventsetter").removeClass("arcClickable")}function r(c,d){c.off("click",a.onMenuClick),$("select",c).length>0?$("select",c).on("change",b.createInstance(d,c),a.onChange).addClass("arcChangeable"):c.on("click",b.createInstance(d,c),a.onMenuClick).addClass("arcClickable")}function s(c,d){var e=c.children(":first"),f=b.createInstance(d,c),g=b.createInstance(d,c);f.eventCallbacks=a,g.eventCallbacks=a,e.length>0&&(e.off("keypress"),e.on("keypress",f,a.onTableKeyPress),e.off("keydown"),e.on("keydown",g,a.onTableKeyDown))}function t(b){b.off("click",a.onMenuClick),$("select",b).off("select",a.onChange)}function u(a,b,c,d){var e;a.off("click.eventsetter",c.onClickEditableObj),a.off("click.eventsetter",c.onClickNonEditableObj),a.removeClass("arcTextInputActive"),a.find(".arcTextInputSizeTarget").removeClass("arcTextInputSizeTarget"),e=c.createExtendedEventDataForInput(a,b),d?a.on("click.eventsetter",e,c.onClickEditableObj):a.on("click.eventsetter",e,c.onClickNonEditableObj)}function v(a){var b=$("#"+a.data.id),c=e.getFont(b),d=$("textarea",b).html(),f=h.convertTextToHtml(d,c);b.children().first().css("display","none"),h.buildHtmlForNotInitialHtmlText(b),g.initializeEditorForNotInitialHtmlText(b,$("div[contenteditable]",b),f)}function w(a,b,c,d){var e;a.off("click.eventsetter",v),e=c.createExtendedEventDataForInput(a,b),d&&a.on("click.eventsetter",e,v)}var j,k,l={};return l.setEvents=function(c,g){var h=g[0].id;c&&c.Events&&e.isActive(g)&&(g.off("click",a.onClick),g.off("click",a.onInput),f.iterateArcplanArray(c.Events,function(c,f){switch(f.Type){case"OnClick":m(g),e.setHasClickEvent(g,!0);break;case"OnInput":e.getObjType(g)==="CheckboxGroup"&&(g.on("click",b.createInstance(h,g),a.onInput),e.setHasInputEvent(g,!0));break;case"OnDrop":o(g);break;case"OnChange":case"OnExit":case"OnSwitch":case"OnCheck":case"OnUnCheck":case"OnComment":break;default:d.warn('Unhandled event type: "'+f.Type+'" for object: '+h)}}))},l.setDragEvents=function(a){switch(e.getObjType(a)){case"Field":case"Row":case"Column":case"Table":case"Menu":case"MenuHierarchie":case"HorizontalHierarchie":case"VerticalHierarchie":c.makeDraggable(a)}},l.setTypeSpecificEvents=function(c){var d=c[0].id;if(e.isActive(c))switch(e.getObjType(c)){case"Menu":r(c,d);break;case"RadioGroup":$("input",c).on("click",b.createInstance(d,c),a.onChange).addClass("arcClickable");break;case"Switch":p(c,d);break;case"VerticalHierarchie":case"HorizontalHierarchie":case"MenuHierarchie":c.off("click",a.onHierClick),c.on("click",b.createInstance(d,c),a.onHierClick),$(".arcHier",c).off("mousedown",a.onHierMouseDown),$(".arcHier",c).on("mousedown",b.createInstance(d,c),a.onHierMouseDown),(e.getHasClickEvent(c)||e.getObjType(c)==="MenuHierarchie")&&c.addClass("arcClickable");break;case"Table":case"Column":case"Row":case"Field":s(c,d)}},l.setEventForInput=function(a,b,c){var d,f=e.getIsEditable(a),h=e.isActive(a),i=h&&f,j=e.getObjType(a),k,l=e.isFormattedTextInput(a);switch(j){case"Field":case"Column":case"Row":case"Table":j==="Field"&&e.isVHTMLField(a)?g.initializeEditorForVHTMLField(a,$("div[contenteditable]",a),e.getHtmlSource(a)):u(a,b,c,i);break;case"Text":k=e.getContent(a),a.off("click.eventsetter",v),typeof k=="object"?g.initializeEditor(a,$("div[contenteditable]",a),k.HtmlSource):l?w(a,b,c,i):u(a,b,c,i);break;default:}},l.removeAllEvents=function(b){if(b.length===0)return;switch(e.getObjType(b)){case"Menu":t(b);break;case"RadioGroup":$("input",b).off("click",a.onChange).removeClass("arcClickable");break;case"Switch":q(b);break;case"VerticalHierarchie":case"HorizontalHierarchie":case"MenuHierarchie":b.off("click",a.onHierClick),$(".arcHier",b).off("mousedown",a.onHierMouseDown),b.removeClass("arcClickable");break;case"Table":case"Column":case"Row":case"Field":var c=b.children(":first");c.length>0&&(c.off("keypress"),c.off("keydown"))}e.getHasClickEvent(b)&&(n(b),e.setHasClickEvent(b,!1)),e.getHasInputEvent(b)&&(b.off("click",a.onInput),e.setHasInputEvent(b,!1)),b.off("click.eventsetter"),b.removeClass("arcTextInputActive"),b.find(".arcTextInputSizeTarget").removeClass("arcTextInputSizeTarget")},l.setPendingBlurEvent=function(a){j=a,j&&window.setTimeout(l.executePendingBlurEvent,300)},l.executePendingBlurEvent=function(){var b=j;return j?(j=null,a.onInput(b),i.removeForm(),!0):!1},l.setPendingEvent=function(a){k=a},l.executePendingEvent=function(){var a=k;return k?(k=null,a.callback(a.event),!0):!1},l}return{createInstance:j}}),define("view",["jquery","events/eventcallbacks","events/eventdatafactory","logger","stringtools","tools","textinput","properties","layoutmanagement","stylesheethandler","popuphandler","scroll","filterpanel","objectpropertysetter","objectpropertyapplier","viewmanagement","datavirtualization","patternapplier","events/eventsetterfactory","textinputeventhandlerfactory","texthtmlgenerator","documentpositioner","htmleditor"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){return function(x,y,z,A){function H(a,b,c){return{requestProcessor:x,container:a,activationCallback:b,getTopDocNameCallback:c}}function I(b){return b[0].style.width==="100%"||!h.hasDocFixedSize(a(b))}function J(a,b,c,d){!d||typeof b!="object"||h.hasVisibleChanged(a)?(h.setXPosChanged(a,!0),h.setYPosChanged(a,!0),h.setWidthChanged(a,!0),h.setHeightChanged(a,!0),h.setColumnWidthChanged(a,!0),h.setNumRowsChanged(a,!0),b=q.init(a,b,c,x,A),h.setVisibleChanged(a,!1)):b=q.update(a,b,c,x,A);if(h.getObjType(a)==="Text"||h.isVHTMLField(a))h.setXPosChanged(a,!0),h.setYPosChanged(a,!0),h.setWidthChanged(a,!0),h.setHeightChanged(a,!0),b=u.buildHtml(a,b);b&&(a[0].innerHTML=b)}function K(b){var c=h.getDocSelectedObject(b),d=a("#"+c),e,f,g,i;d.length>0&&(i=h.getDatavirtualizationProperties(d),e=h.getSelectedCell(d),e?(d.children(":first").focus(),f=a("tr:nth-child("+(e.y+1-i.firstElementInDOM)+")",d),f.length>0&&(g=a("td:nth-child("+(e.x+1)+")",f),g.length>0&&g.addClass("selected"))):d.children("div:first").focus())}function L(){var a,b=B.length;for(a=0;a<b;a+=1)B[a].containerDiv.css("display","none")}function M(a){var b,c=a?a.length:0;for(b=0;b<c;b+=1)i.adjustObjectSizeIfNecessary(a[b])}function N(){var b=a(document);b.scrollTop(0),b.scrollLeft(0)}function O(){j.removeAllClasses()}function P(){var b;for(b=0;b<B.length;b+=1)a(window).off("resize."+B[b].name)}function Q(){var b;for(b=0;b<B.length;b+=1)a(B[b]).off("click."+B[b].name)}function R(a){var b=(a.ownerSVGElement||a).id,c,d,f,g=new RegExp("^OBJ"),h=new RegExp(":.*$"),i=new RegExp("^OBJ[0-9]*:");return d=b.replace(g,"").replace(h,""),f=b.replace(i,""),c=e.makeID(f,d),c}function S(){g.removeForm()}var B=[],C={},D={x:undefined,y:undefined},E="",F=t.createInstance(),G=s.createInstance();return b.setEventSetter(G),g.setEventSetter(G),w.setEventSetter(G),g.setOnInputCallback(b.onInput),C.setDocSizeChangedListener=function(a){i.setDocSizeChangedListener(a)},C.setLastMouseDownPos=function(b){var c=a("#arcContainer").offset();D.x=b.pageX-c.left,D.y=b.pageY-c.top},C.getLastMouseDownPos=function(){return{x:D.x,y:D.y}},C.activateDocument=function(b,c){var d=-1,e,f,g=!1,i,j=0,k=0,l;for(e=0;e<B.length;e+=1)f=B[e],f.name===b&&(d=e);d!==-1&&B.splice(d,1),B.push({name:b,containerDiv:c});for(e=B.length-1;e>=0;e-=1)B[e].containerDiv.css("z-index",e),g?B[e].containerDiv.css("display","none"):(B[e].containerDiv.css("display","block"),g=I(B[e].containerDiv)),j=Math.max(j,v.getDocHeight(B[e].containerDiv)),k=Math.max(k,v.getDocWidth(B[e].containerDiv));h.getDocType(c)==="Dialog"&&(a(".arcDialogDoc-overlay").remove(),i=parseInt(c.css("z-index"),10)-1,l=a("<div class='arcDialogDoc-overlay'></div>").css("z-index",i).css("width",k).css("height",j),a("#arcContainer").append(l)),E!==b&&(E=b,h.getHasDocActivateEvent(c)&&x.doDocActivateEvent(b))},C.closeDocument=function(b){var c=e.removeExtension(b),f,g,i=!1,k=a("#"+e.makeID(c,0)).remove();d.log("closeDocument: "+c),a(window).off("resize."+c),k.off("click."+c),a(".arcDialogDoc-overlay").remove(),j.removeClassesForDocument(c),h.resetAllPropertiesForDocument(c),v.closeDocumentDialog(c);for(f=0;f<B.length;f+=1)if(B[f].name===c){f===B.length-1&&(i=!0),B.splice(f,1);break}B.length>0&&i&&(g=B[B.length-1],C.activateDocument(g.name,g.containerDiv))},C.transferObjects=function(b,c,g){var j=g,s,t,u=[],w=[],A=0,C=parseFloat(a(window).width()),D=parseFloat(a(window).height());if(!c||!c.Elements)return;return f.iterateArcplanArray(c,function(c,d){var f,g,y,B;if(!d||!d.ObjID)return;d.Worksheet!==undefined&&(j=e.removeExtension(d.Worksheet)),u.indexOf(j)===-1&&u.push(j);if(ARCPLAN.clientRedesign===!0&&z.isArcplanObjectAlreadyCreated(j,d.ObjID))return;g=e.makeID(j,d.ObjID),f=b||v.getDocContainer(j),B=a("#"+g),B.length===0?(B=a("<div id='"+g+"' tabindex='-1'></div>"),B.appendTo(f),B.addClass("objContainer"),h.setObjType(B,c),h.setDocName(B,j),h.setID(B,d.ObjID),h.setActive(B,!0),s=!1):s=!0,typeof d.View=="string"&&p.updateViewProperties(d),l.setIgnoreJavaScriptEvents(!0),d.Data&&(y=d.Data),d.ObjectProperties&&(h.setActive(B,d.ObjectProperties.SelectionEnabled!=="false"),h.setVisible(B,typeof d.ObjectProperties.Invisible!="undefined"&&d.ObjectProperties.Invisible==="false")),d.Position&&h.setZIndex(B,(parseInt(d.Position,10)+1)*10),d.BaseProperties&&(t=n.setBaseProperties(d.BaseProperties,B,s,h.isDocLayoutManaged(f))),d.ObjectProperties&&(n.setScrollDependencies(d.ObjectProperties,B),n.setProperties(d.ObjectProperties,g)),d.ObjectData&&(d.ObjectData.NumRows&&h.setNumRows(B,parseInt(d.ObjectData.NumRows,10)),d.ObjectData.NumCols&&h.setNumCols(B,parseInt(d.ObjectData.NumCols,10)),k.isCurrentPopup(B)&&(k.rememberSelection(B),k.unregisterOutSideEvent(B)),h.setScrollWidth(B,undefined),h.setScrollHeight(B,undefined),J(B,d.ObjectData,y,s)),h.isActive(B)?(G.setTypeSpecificEvents(B),d.ObjectProperties&&G.setEvents(d.ObjectProperties,B),G.setEventForInput(B,g,F),G.setDragEvents(B)):((c==="Text"||h.isVHTMLField(B))&&G.setEventForInput(B,g,F),G.removeAllEvents(B)),h.isVisible(B)&&o.applyProperties(B),q.updatePosition(B),m.updateAfterLoadingObject(B),s&&h.isDocLayoutManaged(f)&&(t?(i.resetLayoutManagement(f),i.addToPendingLayoutDocuments(f[0].id)):i.applyLayoutToUpdatedObject(B)),a("input",B).attr("disabled",!h.isActive(B)),a("select",B).attr("disabled",!h.isActive(B)),h.getIsPassword(B)&&a("input",B).attr({readonly:h.isActive(B)?"false":"true",tabindex:"-1"}),B.children().css("position","absolute"),k.isCurrentPopup(B)?k.show(B,!0):c==="MenuHierarchie"&&!h.isUseContentPaging(B)&&k.setSelectionFromPath(h.getSelectionPath(B),B);if(c==="VerticalHierarchie"||c==="HorizontalHierarchie")w[A]=B,A+=1;r.loadPattern(B,B.children(),x),(c==="Menu"||c==="MenuHierarchie")&&r.applyDropdownSymbol(B,x),l.clearScrolledObjects(),l.setIgnoreJavaScriptEvents(!1)}),f.each(u,function(a,b){var c=v.getDocContainer(b);i.setDocSizeInDataAttribute(c),i.setDocSize(c,C,D),typeof y.getFixedWindowSizeForWidget()!="object"&&p.applyCurrentView(c)}),B.length>0&&K(B[B.length-1].containerDiv),d.log("done transferObjects ("+u+")"),w},C.doPostUpdate=function(a){i.updatePendingLayoutDocuments(x),M(a)},C.getTopDocumentName=function(){return B.length>0?B[B.length-1].name:null},C.loadDocument=function(c){var e,f,g=c.arcplanDocument,j,k={width:"100%",height:"100%"},l=g.Layers.Layer.Layout,n=y.getDocAreaRectForWidget(),q=y.getFixedWindowSizeForWidget(),s=n!==undefined,t,u,w=!0,A=parseFloat(a(window).width()),B=parseFloat(a(window).height()),D=a("#arcContainer").position();j=g.Name,d.log("loadDocument: "+j),L(),e=v.getDocContainer(j),e.length===0&&(w=!1,e=v.createDocumentDiv(j,n,s,l,g.WorksheetType)),e.css("display","none"),h.setDocViews(e,g.Views),p.setInitialViewForDocument(a(window).width(),a(window).height(),e),f={PatternFormat:g.Layers.Layer.Background.PatternFormat,ImageReference:g.Layers.Layer.Background.ImageReference},g.Settings!==undefined&&g.Settings.LayoutManagement!==undefined&&g.Settings.LayoutManagement==="true"?(h.setDocLayoutManaged(e,!0),u=g.Settings.ResizeObject,typeof u=="string"&&u.indexOf("[OBJ")!==-1&&(u=u.replace("[OBJ","").replace("]","")),h.setDocLayoutObjectID(e,u)):h.setDocLayoutManaged(e,!1),g.DocumentProperties!==undefined&&g.DocumentProperties.ActivateEvent!==undefined&&(g.DocumentProperties.ActivateEvent==="true"?h.setHasDocActivateEvent(e,!0):h.setHasDocActivateEvent(e,!1)),h.setPattern(e,f),r.loadPattern(e,e,x),h.setDocFixedSize(e,!1),v.setDocumentPositionAndSizeStylesInCssMap(e,g,l,k,s,n),v.setDocumentPositionAndSizeInProperties(e,l,s,n,D,A,B),g.Layers.Layer.Background.TrueColor1&&(k.backgroundColor=g.Layers.Layer.Background.TrueColor1),e.css(k),typeof b=="object"&&b!==null&&a(window).on("resize."+j,H(e),b.onResize),e.on("click."+j,H(e,C.activateDocument,C.getTopDocumentName),b.onDocumentClick),ARCPLAN.clientRedesign===!0&&z.createNewArcplanObjects(j,e,g.Objects),t=C.transferObjects(e,g.Objects,j),e.css("display","inline"),h.setDocType(e,g.WorksheetType),E=j,C.activateDocument(j,e),m.setCreateBookmarkFunction(x.doCreateBookmark),m.notifyDocumentLoaded(e),q?i.initializeWithFixedWindowSize(e):(w&&i.resetLayoutManagement(e),i.initialize(e,x)),M(t),i.setDocSizeInDataAttribute(e),i.setDocSize(e,A,B),o.updateReferences(e,g.Objects,j,x),N()},C.getCurrentDocSize=function(a){var b=v.getDocContainer(a),c,d=0,e=0;return b&&(c=i.calculateObjectsRect(b),d=c.width,e=c.height),{Width:d,Height:e}},C.isLayoutManagedInDoc=function(a){var b=v.getDocContainer(a),c=h.isDocLayoutManaged(b)!==!1;return c},C.showPendingEditCell=function(a,b){F.showPendingEditCell(a,b)},C.getDocCurrentView=function(){var a=B[B.length-1].containerDiv;return h.getDocCurrentView(a)},C.getCurrentDocProperties=function(){var a,b={isDialogCenter:!1,hasDocFixedSize:!1,container:null};return B.length>0&&(a=B[B.length-1].containerDiv,b.isDialogCenter=h.isDocAutoCenter(a)===!0&&h.getDocType(a)==="Dialog",b.hasDocFixedSize=h.hasDocFixedSize(a)===!0,b.container=a),b},C.executeInputBoxAction=function(b){var c,d,f,g,i=e.removeExtension(b.Worksheet),j=v.getDocContainer(i),k=parseInt(b.Column,10),l=parseInt(b.Row,10);if(j.length>0){d=e.makeID(i,b.ObjID),f=a("#"+d,j);if(f.length>0){c=h.getObjType(f);switch(c){case"Table":case"Field":case"Row":case"Column":F.selectCell(f,d,l,k);break;case"Text":F.selectTextField(f,d);break;case"Menu":case"MenuHierarchie":f.find(".arcHierPopup").trigger("click");break;case"Button":case"Switch":a("button",f).trigger("click");break;case"RadioGroup":g=a("input[type=radio]",f),a(g[l]).click();break;case"CheckboxGroup":g=a("input[type=checkbox]",f),a(g[l]).click();break;case"VerticalHierarchie":case"HorizontalHierarchie":}}}},window.handleClick=function(d,e){var f=R(e.target),g=c.createInstance(f,a("#"+f)),i=parseInt(h.getXPos(g.ref),10),j=parseInt(h.getYPos(g.ref),10),l={data:g,pageX:e.pageX+i,pageY:e.pageY+j,target:e.target};k.hideCurrentPopup(),b.onClick(l)},C.getEventSetter=function(){return G},C.cleanOnSessionEnd=function(){y.onWaitingStateChanged(!1),O(),P(),Q(),S(),h.resetAllProperties(),v.closeDocumentDialog(),a("#arcContainer").empty(),w.removeAllHtmlEditorInstances()},x.setView(C),C}}),define("userdialog",["jquery","keycodes","stringtools","logger","drivertype","guitypes","usertypes","stringsres","stringsid","jquery.simplemodal"],function(a,b,c,d,e,f,g,h,i){var j={};return j.createUserDialog=function(){var b={sendEvent:undefined,callback:undefined,gui:{Type:"0",UserLogin:{DriverType:0,UserName:"","Driver Name":"User Login"}}},j=function(b){var c=a("<div></div>");return typeof b=="string"&&c.addClass(b),c},k=function(b,c,d,e){var f=a("<input>");return f.addClass("loginField"),typeof b=="string"&&f.attr("name",b),typeof c=="string"&&f.addClass(c),typeof d=="string"&&f.val(d),typeof e=="string"&&f.attr("type",e),f},l=function(){var b={},c={containingLanguageValue:function(a){return b.language=a,this},containingClientValue:function(a){return b.client=a,this},andAppendTo:function(c){var d=a("<tr></tr>"),e=a("<tr></tr>"),f=a("<td></td>");d.append(a("<td></td>").text(h.getMessageById(i.CLIENT))),e.append(a("<td></td>").append(k("_client","loginFieldInColumn",b.client,"text"))),d.append(a("<td></td>").text(h.getMessageById(i.LANGUAGE))),e.append(a("<td></td>").append(k("_language","loginFieldInColumn",b.language,"text"))),d.appendTo(c),e.appendTo(c)}};return c},m=function(b,c){function d(b,c){return a("<input></input>",{id:b,value:c,name:"userOption",type:"radio","class":"arcUserOptionInput"})}function e(b,c){return a("<label></label>",{"for":b,text:c,"class":"arcUserOptionLabel"})}var f=a("<tr></tr>"),j=a("<td class='arcUserOptionRow'></td>"),k=d("_winUser","1"),l=d("_arcUser","2"),m=["windows","arcplan"],n=!0,o=!0;ARCPLAN.engage&&ARCPLAN.engage.server&&ARCPLAN.engage.server.allowedAuthenticationModes&&(m=ARCPLAN.engage.server.allowedAuthenticationModes),m.indexOf("windows")===-1&&m.length>0&&(o=!1),m.indexOf("arcplan")===-1&&m.length>0&&(n=!1),f.append(j),j.append(k),j.append(e("_winUser",h.getMessageById(i.WINDOWS_USER))),j.append(l),j.append(e("_arcUser",h.getMessageById(i.ARCPLAN_USER))),c&&c===g.windows?(o=!0,n=!1):c&&c===g.arcplan&&(o=!1,n=!0),k.prop("checked",!0);if(!o||!n)o||(k.prop("checked",!1),l.prop("checked",!0)),n||(k.prop("checked",!0),l.prop("checked",!1)),f.hide();f.append(j),b.append(f)},n=function(){var b={fieldClass:"loginFieldLong",inputType:"text",colSpan:1},c={withLabel:function(a){return b.label=a,this},and:function(){return this},andLong:function(){return b.fieldClass="loginFieldLong",this},andMedium:function(){return b.fieldClass="loginFieldMedium",this},andShort:function(){return b.fieldClass="loginFieldShort",this},textField:function(){return b.inputType="text",this},passwordField:function(){return b.inputType="password",this},checkboxField:function(){return b.inputType="checkbox",this},withName:function(a){return b.name=a,this},containingValue:function(a){return b.value=a,this},withColSpan:function(a){return b.colSpan=a,this},andAppendTo:function(c){var d=a("<tr></tr>"),e=a("<tr></tr>"),f=a("<td></td>").attr("colSpan",b.colSpan);b.inputType==="checkbox"?(f.append(a("<input>").attr("type","checkbox").attr("name",b.name).attr("id","id"+b.name)),f.append(a("<label></label>").attr("for","id"+b.name).text(" "+b.label)),e.append(f)):(d.append(a("<td></td>").text(b.label)).attr("colSpan",b.colSpan),e.append(a("<td></td>").append(k(b.name,b.fieldClass,b.value,b.inputType)).attr("colSpan",b.colSpan))),d.appendTo(c),e.appendTo(c)}};return c},o=function(a){var b,d,e="",f=[10,22,14,9,27,2,28,19,7,16];for(d=0;d<a.length;d+=1)b=a.charCodeAt(d),b-=f[d%10],d===0?e=String.fromCharCode(b):e+=String.fromCharCode(b);return e=c.encodeUtf8(e),e=c.encodeBase64(e),e},p=function(a,b){var c=a.split("\\");return c.length===2?a:a.indexOf("@")!==-1?a:b.length>0?b+"\\"+a:a},q=function(a){var b=a.split("\\");return b.length===2?b[0]:""},r=function(a){var b=a.split("\\");return b.length===2?b[1]:a},s=function(a,c,d,e,f,g){b.sendEvent({UserInformation:{UserLogin:{UserName:p(a,d),Password:o(c),Client:e,Language:f,StoreCredentials:g}}},b.callback)},t=function(){var c=a("input[name=_password]").val(),d=243,e=a("input[id=_arcUser]").is(":checked"),f=a("input[name=_storeCred]").length===1?a("input[name=_storeCred]").is(":checked"):0;e&&(d=244),b.sendEvent({UserInformation:{LoginUser:{AuthMode:d,UserName:a("input[name=_user]").val(),Password:o(c),StoreCredentials:f}}},b.callback)},u=function(){b.sendEvent({UserInformation:{UserLogin:{Cancel:!0}}},b.callback)},v={forUIRequest:function(a){return b.gui=a,this},withDoSendEvent:function(a){return b.sendEvent=a,this},withCallback:function(a){return b.callback=a,this},andShowIt:function(){var c,g,k,o,p,v,w,x,y,z=1,A;if(typeof b.gui!="object"){d.warn("UserDialog: No GUI object.");return}if(typeof b.sendEvent!="function"){d.warn("UserDialog: No sendEvent function.");return}if(typeof b.callback!="function"){d.warn("UserDialog: No callback function.");return}c=j("arcMsgBox"),w=j("arcMsgBox-banner").appendTo(c),x=j("arcMsgBox-centerContent").appendTo(w),y=j("arcMsgBox-contentPanel").appendTo(x),v=a("<form></form>").attr("action","#").appendTo(y),f.isLogonMixedKeepLogin(b.gui)?A=h.getMessageById(i.LOGIN):A=b.gui.UserLogin.DriverName||h.getMessageById(i.USER_LOGIN),g=j("arcMsgBox-caption").text(A),v.append(g),k=j("arcMsgBox-content"),p=a("<table></table>").width("100%"),e.isSAPDriver(b.gui)&&(l().containingClientValue(b.gui.UserLogin.Client).containingLanguageValue(b.gui.UserLogin.Language).andAppendTo(p),z=2),f.isDomainLogin(b.gui)&&n().withLabel("Domain").andMedium().textField().withName("_domain").containingValue(q(b.gui.UserLogin.UserName)).withColSpan(z).andAppendTo(p),f.isLogonMixedKeepLogin(b.gui)&&m(p,b.gui.UserLogin.UserType),n().withLabel(h.getMessageById(i.USERNAME)).andLong().textField().withName("_user").containingValue(r(b.gui.UserLogin.UserName)).withColSpan(z).andAppendTo(p),n().withLabel(h.getMessageById(i.PASSWORD)).andLong().passwordField().withName("_password").withColSpan(z).andAppendTo(p),b.gui.UserLogin.ClientCredentialStorage==="true"&&n().withLabel(h.getMessageById(i.KEEP_LOGGEDIN)).and().checkboxField().withName("_storeCred").withColSpan(z).andAppendTo(p),k.append(p),v.append(k),o=j("arcMsgBox-buttonLine"),o.append(a("<button></button>").attr("type","submit").attr("name","loginOkButton").addClass("arcMsgBox-button").text(h.getMessageById(i.OK)).click(function(c){c.preventDefault(),f.isLogonMixedKeepLogin(b.gui)?t():s(a("input[name=_user]").val(),a("input[name=_password]").val(),f.isDomainLogin(b.gui)?a("input[name=_domain]").val():"",e.isSAPDriver(b.gui)?a("input[name=_client]").val():"",e.isSAPDriver(b.gui)?a("input[name=_language]").val():"",a("input[name=_storeCred]").is(":checked")),a.modal.close()})),o.append(a("<button></button>").addClass("arcMsgBox-button").attr("name","loginCancelButton").text(h.getMessageById(i.CANCEL)).click(function(b){b.preventDefault(),u(),a.modal.close()})),v.append(o),a.modal.close(),c.modal({minWidth:400,overlayCss:{"background-color":"#222"},containerCss:{width:"100%",left:0},escClose:!1,zIndex:2000002,focus:!1,onShow:function(b){var c=a('input:text[value=""]',b.data)[0];c?c.focus():a("input",b.data)[0].focus()}})}};return v},j}),define("msgbox",["jquery","keycodes","stringtools","tools","logger","require","stringsres","stringsid","jquery.simplemodal"],function(a,b,c,d,e,f,g,h){var i={};return i.createMsgBox=function(){var b={options:{top:100,left:100,centered:!0,caption:g.getMessageById(h.INFORMATION_TITLE),text:g.getMessageById(h.INFORMATION_TEXT),fileUpload:{enabled:!1},comboBox:{enabled:!1,values:[]},indicator:"no-icon",modal:!0,log:!1,callback:{click:undefined,ok:undefined,yes:undefined,no:undefined,cancel:undefined}},result:{comboBoxSelection:-1},popupShown:!1,possibleIndicatorValues:["success","warning","info","error","question"]},i=function(a){var b="";a.log&&(b="MsgBox: "+a.caption+": "+a.text,a.indicator==="error"?e.error(b):a.indicator==="warning"?e.warn(b):e.info(b))},j=function(c){var d;c=c||{},d=c.data||{},b.options.comboBox.enabled===!0&&(b.result.comboBoxSelection=Number(a("#arcMsgBox-comboBox").find("option:selected").val())),b.popupShown=!1,a.modal.close(),typeof d=="function"&&d(b.result)},k=function(b,c,d){return a("<button></button>").addClass("arcMsgBox-button").addClass("arcToolbarMargin").addClass("arcMsgBox-buttonHeight").text(c).click(d,j)},l=function(b,c){var d,e,f;for(d=0;d<b.length;d+=1)e=a("<a></a>",{target:"_blank",href:b[d].url,text:b[d].text,"class":"arcLink"}),b.length===1&&e.click(j),f=a("<div class='arcLinkContainer'></div>"),e.appendTo(f),c.append(f)},m=function(b,c,d){var e,f=a("<a></a>",{target:"_blank",href:d[0].url,"class":"arcWordBreak"}),g=a("<button></button>",{text:c,"class":"arcMsgBox-button arcToolbarMargin arcMsgBox-buttonHeight"}).appendTo(f);return f.click(function(a){if(d.length>1)for(e=1;e<d.length;e+=1)window.open(d[e].url);j(a)}),f},n=function(b){var c=a("#fileUploadFrame"),d=a("<div id='arcUploadFailedContainer'></div>"),e=a("<div class='arcMsgBox-contentPanel'>"),f=a("<div></div>",{text:g.getMessageById(h.FILE_UPLOAD_FAILED),"class":"arcMsgBox-caption"}).appendTo(e),i=a("<div></div>",{text:c.contents().find("title").text()}).appendTo(e),j=a("<div class='arcMsgBox-buttonLine'></div>"),l=a("<button></button>",{text:g.getMessageById(h.SHOW_DETAILS),"class":"arcMsgBox-button arcToolbarMargin arcMsgBox-buttonHeight"});l.click(function(){a("#fileUploadFrame").css("display","block")}),i.prepend("</br>"),j.append(l),j.append(k("cancel",g.getMessageById(h.CANCEL),b.callback.cancel)),d.append(e),d.append(j),a("#arcFileUploadFrameContainer").prepend(d),a("#fileUploadFrame").css("display","none")},o=function(e){var o="",p={escClose:!0,zIndex:2000002,overlayCss:{backgroundColor:"#000"},containerCss:{width:"100%",left:0}},q,r,s,t,u,v,w,x,y,z=f.toUrl("../res/import.html?"+ARCPLAN.version_argument),A=0;b.popupShown&&j(),b.popupShown=!0,e.log&&i(e),r=a("<div class='arcMsgBox-centerContent'></div>"),s=a("<div class='arcMsgBox-contentPanel'></div>"),b.options.fileUpload.enabled===!0?(q=a("<div></div>",{id:"arcFileUploadFrameContainer"}),x=a("<iframe></iframe>",{name:"fileUploadFrame",id:"fileUploadFrame","class":"arcFileUploadFrame","data-caption":e.caption,"data-text":e.text}).attr("src",z).load(function(){var c=a("#fileUploadFrame").contents();e.caption.length>0&&c.find("#importCaption").text(e.caption),e.text.length>0&&c.find("#importText").text(e.text),c.find("#importFileSelect").val(g.getMessageById(h.UPLOAD_BROWSE)),c.find("#importBtnOk").text(g.getMessageById(h.OK)),c.find("#importBtnCancel").text(g.getMessageById(h.CANCEL)),c.find("#uploadInProgress").text(g.getMessageById(h.UPLOAD_IN_PROGRESS)),typeof e.callback.cancel=="function"&&c.find("#importBtnCancel").click(e.callback.cancel),typeof e.callback.ok=="function"&&c.find("#importBtnOk").click(e.callback.ok),b.options.cgiUrl&&c.find("#importForm").attr("action",b.options.cgiUrl),x.on("load",function(a){n(e)})}),q.append(x)):(e.caption.length>0&&(v=a("<div class='arcMsgBox-caption'></div>"),v.text(e.caption),v.appendTo(s)),e.links?(w=a("<div class='arcMsgBox-contentPanel-openLink'></div>"),l(e.links,w)):(w=a("<div class='arcMsgBox-content arcWordBreak'></div>"),w.html(c.convertNewLineToHTMLBreaks(e.text))),w.appendTo(s),e.comboBox.enabled&&(w=a("<select id='arcMsgBox-comboBox' style='min-width:80px;'></select>"),d.iterateArcplanArray(e.comboBox.values,function(b,c){c!==""&&w.append(a("<option></option>").val(A).html(c)),A+=1}),w.appendTo(s)),t=a("<div class='arcMsgBox-buttonLine'></div>"),typeof e.callback.ok=="function"&&t.append(k("ok",g.getMessageById(h.OK),e.callback.ok)),typeof e.callback.yes=="function"&&t.append(k("yes",g.getMessageById(h.YES),e.callback.yes)),typeof e.callback.no=="function"&&t.append(k("no",g.getMessageById(h.NO),e.callback.no)),typeof e.callback.cancel=="function"&&t.append(k("cancel",g.getMessageById(h.CANCEL),e.callback.cancel)),e.links?(t.append(m("ok",g.getMessageById(h.OK),e.links)),t.append(k("cancel",g.getMessageById(h.CANCEL),e.callback.cancel)),a(".arcMsgBox-contentPanel-openLink > a").click(j)):a("button",t).length===0&&t.append(k("ok",g.getMessageById(h.OK),e.callback.click)),u=a("<div class='arcMsgBox-banner'></div>"),q=a("<div class='arcMsgBox'></div>"),s.css("max-height",a(window).height()*.8+"px"),s.appendTo(r),t.appendTo(r),r.appendTo(u),u.appendTo(q)),a.modal.close(),q.modal(p)},p={at:function(a,c){return typeof a=="number"&&(b.options.top=a,b.options.centered=!1),typeof c=="number"&&(b.options.left=c,b.options.centered=!1),this},withCaption:function(a){return typeof a=="string"&&(b.options.caption=a),this},withText:function(a){return typeof a=="string"&&(b.options.text=a),this},withFileUpload:function(a){return b.options.fileUpload.enabled=!0,b.options.cgiUrl=a,this},withComboBox:function(a){return b.options.comboBox.enabled=!0,b.options.comboBox.values=a,this},indicating:function(a){var c;if(typeof a=="string")for(c=b.possibleIndicatorValues.length-1;c>=0;c-=1)b.possibleIndicatorValues[c]===a&&(b.options.indicator=a);return this},withCallback:function(a){return typeof a=="function"&&(b.options.callback.click=a),this},withLink:function(a){return b.options.links=a,this},modeless:function(){return b.options.modal=!1,this},logIt:function(){return b.options.log=!0,this},onYes:function(a){return typeof a=="function"&&(b.options.callback.yes=a),this},onNo:function(a){return typeof a=="function"&&(b.options.callback.no=a),this},onCancel:function(a){return typeof a=="function"&&(b.options.callback.cancel=a),this},onOk:function(a){return typeof a=="function"&&(b.options.callback.ok=a),this},show:function(){o(b.options)},andShowIt:function(){this.show()},showInformation:function(){this.indicating("info").show()},showSuccess:function(){this.indicating("success").show()},showError:function(){this.indicating("error").show()},showWarning:function(){this.indicating("warning").show()}};return p},i}),define("userinformation",["ui","guitypes","stringtools","logger","msgbox","popuppositioner","userdialog","tools","replytypes","clientcredentials","properties","events/eventcallbacks","popuphandler","stringsres","stringsid"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function r(){return window}function s(a,b,e){var f,g,h=a.Parameter.Elements[0].Text,j=[],k,l,m,n;f={UserInformation:{Reply:{Type:i.startJS,Blob:""}}},m=h.split("."),g=r();while(m.length>0&&g)n=m.splice(0,1),g=g[n];for(k=1;k<a.Parameter.Elements.length;k+=1)a.Parameter.Elements[k].Text!==undefined?j.push(a.Parameter.Elements[k].Text):a.Parameter.Elements[k].Double!==undefined?j.push(parseFloat(a.Parameter.Elements[k].Double)):(d.error("Unexpected Parameter type at index: "+k),j.push(undefined));d.log("startjs: "+h+"() with "+j.length+" parameter(s)");if(typeof g=="function")try{l=g.apply(r(),j)}catch(o){d.error("Exception in "+h+"(): "+o)}else d.error(h+" is not a function");f.UserInformation.Reply.Blob=c.encodeBase64(l),b(f,e)}function t(a,b,c){var d=a.MessageBox||a,f,g={16:"error",48:"warning",64:"info"},h=g[d.Flags];f=e.createMsgBox().withCaption(d.Caption||"Information").withText(d.Text).withCallback(function(){var a={UserInformation:{Reply:{Type:i.msgbox,Result:1}}};b(a,c)}),h&&f.indicating(h),f.andShowIt()}function u(a,b,c){var d=a.MessageBox||{},f=parseInt(d.Flags||"0",10),g=e.createMsgBox().withCaption(d.Caption).withText(d.Text).indicating("question"),h=function(a){var d={UserInformation:{Reply:{Type:i.question,Result:a}}};b(d,c)};f===q.okcancel?(g.onOk(function(){h(1)}),g.onCancel(function(){h(0)})):f===q.yesno?(g.onYes(function(){h(1)}),g.onNo(function(){h(0)})):f===q.yesnocancel&&(g.onYes(function(){h(1)}),g.onNo(function(){h(2)}),g.onCancel(function(){h(0)})),g.show()}function v(a,b,c){g.createUserDialog().forUIRequest(a).withDoSendEvent(b).withCallback(c).andShowIt()}function w(a,b,d,e,g,i){var j,n,o,p,q=null,r,s,t,u,v,w=0,x=e.Elements?e.Elements.length:1,y=30,z=d?d.x:0,A=d?d.y:0,B,C,D,E=[],F=function(a){function e(){var d=0,e=999999,f=0;for(f=0;f<a;f+=1){if(typeof b[f]!="string")return f;c[f]<e&&(d=f,e=c[f])}return d}function f(a){var d=e();b[d]=a,c[d]=a.length}var b=[],c=[],d=0;return{push:function(a){var b=0;typeof a=="string"&&a.length>d&&f(a)},getArray:function(){return b}}}(4);$("#arcPopupObject").remove(),j=$("#arcDialogCenter");if(j.length===0||!j.is(":visible"))j=$("#arcContainer");o="<div id='arcPopupObject' style='position:absolute;'><div class='arcpopup'><div><div></div><div class='arcPopupContent arcHierPopupContent'><div class='arcMenu'><ul></ul></div></div><div></div></div>",r=$(o),s=$(o).appendTo(j),p=c.makeID(g,0),q=$("#"+p).offset(),n=j.offset(),q!==null&&i&&(q.left-=n.left,q.top-=n.top,r.offset(q),s.offset(q)),t=$(".arcMenu ul",r),u=$(".arcMenu ul",s),!e.Elements&&e.Row&&(e.Elements=[{Row:e.Row}]),h.iterateArcplanArray(e,function(a,b){var c,d,e;w+=1;switch(a){case"PrinterName":c=b,d=0;break;case"Row":c=b.Text,d=w}w===x-1&&c==="----------"?e="<li class='arcMenuItem arcMenuSeparator' value='"+d+"'>"+"<div class='arcMenuSelectionDiv'>"+"<span></span>"+"</div>"+"<div class='arcMenuSeparator'></div>"+"</li>":e="<li class='arcMenuItem' value='"+d+"'>"+"<div class='arcMenuSelectionDiv'>"+"<span></span>"+"</div>"+"<div class='arcMenuItemText'>"+c+"</div>"+"</li>",F.push(e),E.push(e)}),u.append(F.getArray().join("")),t.append(E.join("")),k.setSelectType(r,"HierSingleSelect"),k.setNumRows(r,x),k.setRowHeight(r,y),k.setXPos(r,z),k.setYPos(r,A),v={requestProcessor:undefined,id:"arcPopupObject",ref:r},B=x*y,C=u.outerWidth(),D=f.getPopupPosition(z,A,C,B,j.offset()),$("#arcPopupObject",j).remove(),r.appendTo(j),r.on("click",v,l.onPopupFunction).addClass("arcClickable"),m.showByRect(r,null,D)}function x(a,b,c,d,e){var f=typeof a.PopUp.PositionX!="undefined"&&typeof a.PopUp.PositionY!="undefined",g={x:a.PopUp.PositionX||d.x,y:a.PopUp.PositionY||d.y};w(a,c,g,a.PopUp.Rows,e,f),m.setCallBack(function(a){var d={UserInformation:{Reply:{Type:i.popupmenu,Value:a}}};$("#arcPopupObject").remove(),b(d,c)})}function y(a,b,c,d){if(a.UserPrinters.Elements.length>2)e.createMsgBox().withCaption("Printing").withText("Please choose the printer you would like to use:<br><br>").withComboBox(a.UserPrinters).onOk(function(d){var e={UserInformation:{Reply:{Type:i.printerAlias,PrinterName:a.UserPrinters.Elements[d.comboBoxSelection].PrinterName}}};b(e,c)}).onCancel(function(a){}).andShowIt();else if(a.UserPrinters.Elements.length===2){var f={UserInformation:{Reply:{Type:i.printerAlias,PrinterName:a.UserPrinters.Elements[1].PrinterName}}};b(f,c)}}function z(a,b,c,d,f,g){ARCPLAN.cameBackWith=function(a){var b=f;a.GetUserInformation?typeof b=="function"&&b(a):(c(a,!1),$.modal.close()),delete ARCPLAN.cameBackWith},e.createMsgBox().withFileUpload(g).withCaption(n.getMessageById(o.UPLOAD_TITLE)).withText(n.getMessageById(o.UPLOAD_SELECT_FILE)).onCancel(function(a){var d=a||window.event,e={UserInformation:{Reply:{Result:-1}}};return d.cancelBubble=!0,d.stopPropagation&&d.stopPropagation(),b(e,c),!1}).onOk(function(a){var b=a||window.event,c=window.frames.fileUploadFrame.document,e=$("#importFile",c),f=e?e.val().split("\\").pop():"",g="",h={UserInformation:{Reply:{Value:"1",FileName:"",Blob:""}}};$("#importFileSelect",c).attr("disabled","disabled"),$("#importBtnOk",c).attr("disabled","disabled"),$("#importBtnCancel",c).attr("disabled","disabled"),$("#uploadInProgress",c).css("display","block");if(f||!$("#soapMessage",c).val())h.UserInformation.Reply.FileName=f,typeof d=="function"&&(g=d(h)),$("#soapMessage",c).val(g);window.setTimeout(function(){var a=$("#importForm",c);return function(){a.submit()}}(),100),b.cancelBubble=!0,b.stopPropagation&&b.stopPropagation()}).andShowIt()}function A(a,b,c,d){var e=j.getKeychain(d);b(e,c)}function B(a,b,c,d){var f=j.storeKey(d,a.UserName,a.ClientCredential);f&&f.UserInformation&&f.UserInformation.Reply&&f.UserInformation.Reply.Result===0?e.createMsgBox().withCaption(n.getMessageById(o.CONFIGURATION_ERROR_TITLE)).withText(n.getMessageById(o.PASSWORDNOTSAVED)).indicating("error").onOk(function(a){b(f,c)}).logIt().andShowIt():b(f,c)}function C(a){var b;return h.each(a,function(a){a!=="Type"&&(b=a)}),b}var p={},q={okcancel:1,yesno:4,yesnocancel:3};return p.handleUserInformation=function(a,c){if(a.Type===b.StartJS)return s(a.UserFunction,c.doSoapRequest,c.callback);if(a.Type===b.GetKeychain)return A(a,c.doSoapRequest,c.callback,c.application);if(a.Type===b.ClientStoreKey)return B(a,c.doSoapRequest,c.callback,c.application);c.onWaitingStateChanged(!1),a.Type===b.Message?t(a,c.doSoapRequest,c.callback):a.Type===b.Question?u(a,c.doSoapRequest,c.callback):b.isLoginGUIType(a)?v(a,c.doSoapRequest,c.callback):a.Type===b.Popupmenu?x(a,c.doSoapRequest,c.callback,c.mouseDownPos,c.topDocumentName):a.Type===b.UserPrinter?y(a,c.doSoapRequest,c.callback,c.mouseDownPos):a.Type===b.FileFromApplet?z(a,c.doSoapRequest,c.callback,c.getSoapCallback,c.secondUICallback,c.cgiUrl):e.createMsgBox().withCaption(n.getMessageById(o.NOT_IMPLEMENTED_TITLE)).withText(n.getMessageById(o.NOTIMPLEMENTED_UNSERINFOSTYPE,[a.Type,C(a)])).indicating("error").andShowIt()},p}),define("openlinkaction",["msgbox","stringsres","stringsid"],function(a,b,c){function f(a){return a==="171"?e.newWindow:a==="172"?e.sameWindow:e.noAction}var d={},e={newWindow:"newWindow",sameWindow:"sameWindow",noAction:"noAction"};return d.executeOpenLinkAction=function(d){var g,h,i,j=d.Elements,k=a.createMsgBox(),l=[],m,n,o;if(j)for(g=0;g<j.length;g+=1)n=f(j[g].URL.Window),h=j[g].URL.v,i=h.toLowerCase().indexOf("mailto:")===0?!0:!1,n===e.newWindow||i===!0?l.push({text:h,url:h}):n===e.sameWindow&&i===!1&&(m=h);l.length>0&&(l.length===1?o=b.getMessageById(c.OPENLINK_TITLE):o=b.getMessageById(c.OPENLINK_ALL_TITLE),k.withCaption(o).withLink(l).andShowIt()),m&&(window.location.href=m)},d}),define("splashscreen",["version","stringsres","stringsid"],function(a,b,c){function e(){var a=600,b=443,c=20,d=0,e=$(window).outerWidth(),f=$(window).outerHeight(),g=$("#arcContainer").offset(),h=f-g.top,i=e-g.left,j,k,l,m,n,o,p=51,q=81,r=p;ARCPLAN.engage&&(e<481&&(r=q),h=Math.floor(f-r),i=e,$("#arcContainer").parent().css({height:h+"px",width:i+"px"})),i>a&&h>b?(j=h-(h-b)/2,k=(i-a)/2,$("#arcSplashScreenImage").css({"background-size":a+"px "+b+"px",width:a+"px",height:b+"px"}),$("#arcSplashScreenTextBox").css({display:"none",width:a,height:b}),$("#arcSplashScreenTextBox").fadeIn(0),$("#arcSplashScreenVersion").fadeIn(0),$("#arcNotForProductiveUsage").fadeIn(0),$("#arcSplashScreenLicense").fadeIn(0),$("#arcSplashScreenLicenseOwner").fadeIn(0)):(l=h/b,m=i/a,n=a*Math.min(m,l),o=b*Math.min(m,l),j=h-(h-o)/2,k=(i-n)/2,$("#arcSplashScreenImage").css({"background-size":n+"px "+o+"px",width:n+"px",height:o+"px"}),$("#arcSplashScreenTextBox").css({display:"none",width:n,height:o}),$("#arcSplashScreenTextBox").fadeIn(0),o<450?$("#arcSplashScreenVersion").fadeOut(200):$("#arcSplashScreenVersion").fadeIn(200),o<405?$("#arcNotForProductiveUsage").fadeOut(200):$("#arcNotForProductiveUsage").fadeIn(200),o<420?$("#arcSplashScreenLicenseOwner").fadeOut(200):$("#arcSplashScreenLicenseOwner").fadeIn(200),n<600||o<450?$("#arcSplashScreenLicense").fadeOut(0):$("#arcSplashScreenLicense").fadeIn(200))}function f(){$("#arcSplashScreenLicense").append('<div id="arcLicensedProducts"></div>'),$("#arcLicensedProducts").append(b.getMessageById(c.LICENSEDFOR)),g()}function g(){$("#arcSplashScreenLicense").append('<div id="arcSplashScreenProductList"></div>'),$("#arcSplashScreenProductList").append('<div id="arcSplashScreenProducts"></div>'),$("#arcSplashScreenProducts").append('<div id ="aEnterprise" class="arcSplashScreenProductItem"></div>'),$("#arcSplashScreenProducts").append('<div id ="aEngage" class="arcSplashScreenProductItem"></div>'),$("#arcSplashScreenProducts").append('<div id ="aEdge" class="arcSplashScreenProductItem"></div>'),$("#aEnterprise").html(" arcplan  <br> Enterprise"),$("#aEngage").html(" arcplan  <br> Engage"),$("#aEdge").html(" arcplan  <br> Edge")}function h(){$("#arcSplashScreenVersion").html("HTML5 Client "),$("#arcSplashScreenVersion").append(a.getReadableVersion())}function i(a){var b,c,d,e,f;b=Math.floor(a/16777216),c=Math.floor(a/65536)-b*256,d=Math.floor(a/256)-c*256-b*65536,e=a-d*256-c*65536-b*16777216,f=b+"."+c+"."+d+"."+e,$("#arcSplashScreenVersion").append(" (arcplan Application Server: "+f+")")}function j(a){var b,c,d;b=a&1,c=a&16,d=a&65536,b&&($("#aEnterprise").css("background-color","#009ADC"),$("#aEnterprise").css("border-color","#009ADC")),c&&($("#aEngage").css("background-color","#FF8700"),$("#aEngage").css("border-color","#FF8700")),d&&($("#aEdge").css("background-color","#FFB900"),$("#aEdge").css("border-color","#FFB900"))}function k(a,d){var e=!0,f;f=d&1048576,f&&$("#arcNotForProductiveUsage").append("OEM ");switch(a){case"301":$("#arcNotForProductiveUsage").append(b.getMessageById(c.EVALUATIONVERSION));break;case"302":e=!1;break;case"303":$("#arcNotForProductiveUsage").append(b.getMessageById(c.TESTORBACKUPVERSION));break;case"304":$("#arcNotForProductiveUsage").append(b.getMessageById(c.PARTNERVERSION))}e&&$("#arcNotForProductiveUsage").append(" - "+b.getMessageById(c.NOT_FOR_PR_USAGE))}function l(a){$("#arcSplashScreenLicenseOwner").append(b.getMessageById(c.LICENSEOWNER)),$("#arcSplashScreenLicenseOwner").append(a+" <br>")}var d={};return d.show=function(){var a=$("#arcContainer");a.before('<div id="arcSplashScreen"><div id="arcSplashScreenOuter"><div id="arcSplashScreenInner"><div id="arcSplashScreenImage"><div id="arcSplashScreenTextBox"><div id="arcNotForProductiveUsage"></div><div id="arcSplashScreenLicenseOwner"></div><div id="arcSplashScreenVersion"></div></div></div></div></div></div>'),h(),$("#arcSplashScreenTextBox").append('<div id="arcSplashScreenLicense"></div>'),f(),e(),$(window).on("resize.arcResizeSplashScreen",e),a.css("overflow","hidden")},d.addLicenseInformation=function(a,b,c,d){i(a),j(b),l(d),k(c,b)},window.jasmine&&(d.resizeSplashScreen=e),d}),define("requestprocessorfactory",["stringtools","tools","requesttools","userinformation","version","events/eventid","msgbox","browserfeatures","userparam","keepalive","scroll","viewmanagement","filterpanel","objectpropertyapplier","stringsres","stringsid","openlinkaction","splashscreen","properties","showhiermenuaction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){function u(u,v,w){function x(){var a=$("#arcContainer"),b=a?a.position():null;return v&&v.getFixedWindowSizeForWidget()?v.getFixedWindowSizeForWidget().width:$(window).width()-(b?b.left:0)}function y(){var a=$("#arcContainer"),b=a?a.position():null;return v&&v.getFixedWindowSizeForWidget()?v.getFixedWindowSizeForWidget().height:$(window).height()-(b?b.top:0)}function z(){return typeof v.getDocAreaRectForWidget()!="undefined"}var A={application:v?v.getApplication():undefined,cgiSite:u,clientParams:{clientType:h.mobile?"1005":"1004",platformName:"Windows Desktop",browserVersion:navigator.appVersion,language:navigator.language,width:x(),height:y(),leftMargin:"0",topMargin:"0",printMode:"4",titleBar:"0",passwordChange:"0"},changedView:undefined,openDocList:[],closeDocList:[],showHierMenuList:[],keepAliveIntervalId:undefined,isSessionClosing:!1,operationNames:{ClosePresentation:"ClosePresentation",CreateBookmark:"CreateBookmark",InitPresentation:"InitPresentation",KeepAlive:"KeepAlive",OpenDocument:"OpenDocument",OpenStartDoc:"OpenStartDoc",SendAppletProps:"SendAppletProps",SendEvent:"SendEvent"},runningRequestList:[],serverName:"",sessionContext:v,sessionID:0,sessionToken:"",startdoc:v?v.getStartDoc():undefined,view:undefined,isUserinformationPending:!1,inboxAction:undefined,timeoutBetweenRetries:5e3,openingStartDoc:!1,lastEventForWidget:undefined},B=[],C,D=function(){return"arcSessionToken="+window.escape(A.serverName)+"|"+A.sessionID},E=function(a){A.timeoutBetweenRetries=a},F=function(a,b,c,d,e){var f=o.getMessageById(b),g=o.getMessageById(c);G(a,f,g,"error",d,e)},G=function(a,b,c,d,e,f){var h;a&&a({caption:b,text:c});if(f===!0){e&&d==="error"&&A.sessionContext.logger.error(b+" "+c);return}h=g.createMsgBox(),h.withText(c).withCaption(b).indicating(d),e&&h.logIt(),A.sessionContext.onWaitingStateChanged(!1),A.openingStartDoc=!1,h.andShowIt()},H=function(){document.cookie=D()+"; path=/"},I=function(a){A.view=a},J=function(){var a=A.serverName+A.sessionID,b=[];return b[a.length]="x",b.join("x")},K=function(a){var b=c.createGetRequest("Presentation",A.cgiSite,"",{PARAM1:0,PARAM2:"GETOBJECTPICTFROMCACHE",PARAM3:0,PARAM4:'"'+a+'"',SPACE:'"'+J()+'"'});return b},L=function(a,b,d){var e=c.createGetRequest("Presentation",A.cgiSite,A.serverName,{PARAM1:"",PARAM2:"GETHIERDATAFROMCACHE",PARAM3:A.sessionID,PARAM4:'"'+a+'"',PARAM5:b,PARAM6:d,SPACE:'"'+J()+'"'});return e},M=function(a,b,d){var e=c.createGetRequest("Presentation",A.cgiSite,A.serverName,{PARAM1:"",PARAM2:"GETOBJECTDATAFROMCACHE",PARAM3:A.sessionID,PARAM4:'"'+a+'"',PARAM5:b,PARAM6:d,SPACE:'"'+J()+'"'});return e},N=function(a,b,d,e){var f=c.createGetRequest("Presentation",A.cgiSite,A.serverName,{PARAM1:"",PARAM2:"GETOBJECTDATAFROMCACHEWITHFILTER",PARAM3:A.sessionID,PARAM4:'"'+a+'"',PARAM5:b,PARAM6:d,PARAM7:'"'+e+'"',SPACE:'"'+J()+'"'});return f},O=function(a){var b;if(B[a]){for(b in B[a])B[a][b].abort();B[a]=undefined}},P=function(a,b,d,e,f,g,h){var i,j;if(B[b]){if(B[b][f])return A.sessionContext.logger.log("request already send to server hash: "+b+" startRow: "+d+" numRows:"+e),!1;for(j in B[b])B[b][j].abort();B[b]=[]}return i=c.ajax({url:g,type:"GET",success:function(c){B[b]&&h(a,d,c,C)},error:function(a,c,d){B[b][f]=undefined,T(a,c,d)},beforeSend:function(a){a.setRequestHeader("arcSessionToken",D())}}),B[b]||(B[b]=[]),B[b][f]=i,!0},Q=function(a,b,c,d,e){var f=L(b,c,d),g=""+c+"_"+d;P(a,b,c,d,g,f,e)},R=function(a,b,c,d,e){var f=M(b,c,d),g=""+c+"_"+d;P(a,b,c,d,g,f,e)},S=function(a,b,c,d,e,f){var g=N(b,c,d,e),h=e+c+"_"+d;return O(b),P(a,b,c,d,h,g,f)},T=function(b,c,d,e){if(d==="abort"||A.isSessionClosing&&d==="")return;A.sessionContext.logger.error(b),a.hasUrlWrongProtocol(A.cgiSite,window.location.protocol)?F(e,p.CONFIGURATION_ERROR_TITLE,p.PROTOCOL_MISMATCH,!1):F(e,p.NETWORK_ERROR_TITLE,p.NETWORK_ERROR,!1)},U=function(a,b){var d=0;c.ajax({url:a,type:"GET",success:b,error:function(c,e,f){if(A.isSessionClosing===!0)return;d+=1,d<10?setTimeout(function(){U(a,b)},A.timeoutBetweenRetries):T(c,e,f)},beforeSend:function(a){a.setRequestHeader("arcSessionToken",D())}})},V=function(a,b,d){var e;try{e=c.ajax(a),A.isSessionClosing===!1&&A.runningRequestList.push(e)}catch(f){throw F(b,p.NETWORK_ERROR_TITLE,p.NETWORK_ERROR,!0,d),f}},W=function(a,d,e,f,g,h){var i=c.createSoapRequest(a,d,A.serverName),j,k=!1,l=0,m=A.timeoutBetweenRetries,n=function(a,c){if(A.isSessionClosing===!0&&a.statusText==="abort")return;var d,f,i,j,n=A.runningRequestList.indexOf(a);if(!k){n>-1&&A.runningRequestList.splice(n,1);if(a)try{ARCPLAN.logFullResponseText?f=a.responseText:f=a.responseText.substring(0,500),d=jQuery.parseJSON(a.responseText),f=null,d&&d.Error?(d.Error.Type==="CgiError"&&d.Error.ID===-5&&(l+=1,l<8?(k=!0,E(500),F(o.error,p.NETWORK_ERROR_TITLE,p.DATA_ERROR_NO_BODY,!0,!0)):(E(m),k=!1)),k||(j=b.formatError(d.Error),G(g,j.caption,j.text,j.type,!0,h),i=!0)):E(m)}catch(q){throw A.sessionContext.logger.error(q),f&&A.sessionContext.logger.error("responseText: "+f),F(g,p.DATA_ERROR_TITLE,p.READING_SERVER_ANSWER_ERROR,!1,h),i=!0,q}}if(!k)try{i||e(d)}catch(r){throw A.sessionContext.logger.error(r),F(g,p.INTERNAL_ERROR_TITLE,p.INTERNAL_ERROR,!0,h),r}},o={url:A.cgiSite,type:"POST",dataType:"xml",data:i,complete:n,accepts:{xml:"application/json"},contentType:"text/xml",error:function(a,b,c){if(A.isSessionClosing===!0)return;l+=1,l<10?(k=!0,setTimeout(function(){V(o,g,h)},A.timeoutBetweenRetries)):T(a,b,c,g)},success:function(){k=!1},converters:{"text xml":function(a){return a}}};V(o,g,h)},X=function(a){return function(b){var d=a;return c.createSoapRequest(d,c.addSessionIdAndTokenToParams(b,A.sessionID,A.sessionToken),A.serverName)}},Y=function(){return A.isUserinformationPending},Z=function(a,b){var c=function(b,c){A.isUserinformationPending=!1,_(a,b,c,"userInformationCallback")};return function(e){if(e.GetUserInformation){var f=Z(a,b),g={doSoapRequest:c,callback:b,mouseDownPos:A.view.getLastMouseDownPos(),onWaitingStateChanged:A.sessionContext.onWaitingStateChanged,getSoapCallback:X(a),secondUICallback:f,application:A.application,cgiUrl:A.cgiSite,topDocumentName:A.view.getTopDocumentName()};A.isUserinformationPending=!0,d.handleUserInformation(e.GetUserInformation,g)}else b(e)}},_=function(a,b,c,d,e,f){var g;return g=Z(a,c),A.sessionContext.onWaitingStateChanged(!0),ba(a,b,g,d,e,f)},ba=function(a,b,d,e,f,g){var h=c.addSessionIdAndTokenToParams(b,A.sessionID,A.sessionToken);return W(a,h,d,e,f,g)},bb=function(a){var c,d,e=!1;A.view.loadDocument(a),A.closeDocList.length>0&&(b.each(A.closeDocList,function(a,b){A.view.closeDocument(b)}),A.closeDocList=[]),A.openDocList.length>0?(ARCPLAN.hideContentWhileLoadingDocuments!==!1&&$("#arcContainer").css("display","none"),c=A.openDocList.shift(),A.openDocList.length===0&&ARCPLAN.hideContentWhileLoadingDocuments!==!1&&(e=!0),bd(c,e)):(A.changedView?(d=A.changedView,A.changedView=undefined,bm(d.docName,0,d.evID,d.viewName)):A.sessionContext.onWaitingStateChanged(!1),A.sessionContext.onDocumentLoaded(),A.openingStartDoc=!1),A.inboxAction&&(A.view.executeInputBoxAction(A.inboxAction),A.inboxAction=undefined)},bc=function(b){var c,d;g.createMsgBox().withCaption(o.getMessageById(p.INFORMATION_TITLE)).withText(o.getMessageById(p.WIDGET_OPEN_ANOTHER_DOCUMENT_QUESTION)).indicating("question").onCancel(function(e){if(A.closeDocList.length>0)for(c=0;c<A.closeDocList.length;c+=1){d=a.removeExtension(A.closeDocList[c]);if(b===d){window.location.reload();break}}}).onOk(function(a){A.sessionContext.onOpenDocumentFromWidget(A.lastEventForWidget)}).andShowIt()},bd=function(b,c){var d=a.removeExtension(b),e=a.removeExtension(A.startdoc);d!==e&&z()?bc(e):(A.sessionContext.logger.log("doOpenDoc: "+d),_(A.operationNames.OpenDocument,{Worksheet:d,Width:A.clientParams.width,Height:A.clientParams.height,"PrintState ":!1},function(a){bb(a),c&&$("#arcContainer").css("display","block")},"doOpenDoc"))},be=function(a,b){var d=c.createGetRequest("Presentation",A.cgiSite,A.serverName,{PARAM1:0,PARAM2:"DownloadFile",PARAM3:'"'+a+'"',PARAM4:0,SPACE:".pdf"});b.open(d,"PDF")},bf=function(a,b,d){var e,f,g,h=a;typeof b=="string"&&b.length>0&&(g=b.lastIndexOf("\\"),g!==-1?h=b.substring(g+1):h=b),f={PARAM1:0,PARAM2:"DownloadFile",PARAM3:'"'+encodeURIComponent(a)+'"',PARAM4:0,PARAM5:'"'+encodeURIComponent(h)+'"'},e=c.createGetRequest("Presentation",A.cgiSite,A.serverName,f),d.open(e,"Export")},bg=function(a){b.iterateArcplanArray(a,function(c,d){d.ObjID&&b.iterateArcplanArray(a,function(a,b){if(b.ObjID&&d.ObjID===b.ObjID&&d.Worksheet===b.Worksheet&&d!==b&&d.ObjectData)return d.BaseProperties=b.BaseProperties,d.ObjectProperties=b.ObjectProperties,b.ObjectProperties=undefined,b.BaseProperties=undefined,b.Worksheet=undefined,b.ObjID=undefined,!1})})},bh=function(a,c){var d={Elements:[]},e=a.Actions||{Elements:[]},f=c,g=!1,h=!1,i,j;a.GetUserInformation||(A.isUserinformationPending=!1),A.openingStartDoc===!0&&!a.Actions&&(A.openingStartDoc=!1,typeof ARCPLAN.onStartDocLastAction=="function"&&ARCPLAN.onStartDocLastAction()),b.iterateArcplanArray(e,function(a,b){switch(a){case"UpdateObjPropAction":case"UpdateObjContAction":ARCPLAN.clientRedesign===!0&&w.updateArcplanObjects(b.UpdateObjects),b.UpdateObjects&&(d.Elements=d.Elements.concat(b.UpdateObjects.Elements),b.UpdateObjects.Elements.length=0),h=!0}}),b.iterateArcplanArray(e,function(a,b){switch(a){case"OpenDocAction":f?A.openDocList.push(b.Worksheet):bd(b.Worksheet),f=!0;break;case"UpdateObjPropAction":case"UpdateObjContAction":h&&(bg(d),i=A.view.transferObjects(null,d),h=!1);break;case"CloseDocumentAction":f?A.closeDocList.push(b.Worksheet):A.view.closeDocument(b.Worksheet);break;case"OpenDownloadFileAction":bf(b.FileName,b.Export,window);break;case"OpenPrintDocumentAction":be(b.Worksheet,window);break;case"SetViewRulesAction":l.setViewRules(b.Views,$(window).width(),$(window).height());break;case"CancelAction":g=!0;break;case"InputBoxAction":f?A.inboxAction=b:A.view.executeInputBoxAction(b);break;case"FinishAction":A.view.cleanOnSessionEnd(),window.history.back();break;case"URLListAction":A.sessionContext.onWaitingStateChanged(!1),q.executeOpenLinkAction(b);break;case"NotifyLoginAction":A.sessionContext.onNotifyLogin();break;case"ShowHierarchyMenuPopupAction":A.showHierMenuList.push(b)}}),n.updateReferences(null,d,undefined,C),A.view.doPostUpdate(i),f||(A.changedView?(j=A.changedView,A.changedView=undefined,bm(j.docName,0,j.evID,j.viewName)):A.sessionContext.onWaitingStateChanged(!1)),(A.view.getEventSetter().executePendingEvent()===!1||g)&&A.view.showPendingEditCell(f,g),A.showHierMenuList.length>0&&(t.executeShowHierMenu(A.showHierMenuList,A.view.getTopDocumentName(),A.view.getLastMouseDownPos()),A.showHierMenuList.length=0)},bi=function(){A.sessionContext.logger.log("doOpenStartDoc: "+A.startdoc),A.openingStartDoc=!0,_(A.operationNames.OpenStartDoc,{Worksheet:A.application+"\\"+A.startdoc,ObjID:0,EventID:f.EID_OPENSTARTDOC,ClientType:A.clientParams.clientType},bh,"doOpenStartDoc")},bj=function(){var b,c;b="smil "+h.smil+",svg "+h.svg+",nativeTouchControls "+h.nativeTouchControls+",datavirtualization "+(ARCPLAN.datavirtualization!==!1),c=function(a){a&&(bh(a,!0),bi())},A.sessionContext.logger.log("doAppletProps("+A.sessionID+")"),_(A.operationNames.SendAppletProps,{Worksheet:"",ObjID:"0",EventID:f.EID_SENDAPPLETPROPS,ClientType:A.clientParams.clientType,PrintMode:A.clientParams.printMode,TitleBar:A.clientParams.titleBar,Width:A.clientParams.width,Height:A.clientParams.height,PasswordChangeEnabled:A.clientParams.passwordChange,LocalSaveEnabled:0,BrowserFeatures:b,ClientBaseUrl:a.removeRubbishFromClientBaseURL(window.require.toUrl("")),ClientPlatformType:h.platformType,cgiurl:A.cgiSite},c,"doAppletProps")},bk=function(){var a=function(){bj()};A.sessionContext.logger.log("doUserParams("+A.sessionID+")"),_(A.operationNames.SendEvent,{Worksheet:"",ObjID:"0",EventID:f.EID_SENDUSERPARAM,Text:"0",UserParameters:i},a,"doUserParams")},bl=function(a,b,c,d,e,g){var h;z()&&(c===f.EID_SWITCH?h="SWITCH":c===f.EID_CLICK?h="CLICK":c===f.EID_INPUT&&(h="INPUT"),h&&(A.lastEventForWidget={docName:a,objID:b,eventName:h,value:d,row:e+1,column:g+1}))},bm=function(b,c,d,e,g,h,i,j,l){if(A.isUserinformationPending){A.sessionContext.logger.warn("SendEvent, ignoring sendEvent because UserInformation is pending");return}var n,o,p,q={Worksheet:b,ObjID:c,EventID:d};o=a.makeID(b,c),p=$("#"+o);if(s.isActive(p)===!1){A.sessionContext.logger.log("SendEvent, Trying to send an event to the inactive object "+c+", document="+b+", eventID="+d);return}bl(b,c,d,e,g,h),A.view.isLayoutManagedInDoc(b)&&(q.Size=A.view.getCurrentDocSize(b)),A.sessionContext.logger.log("SendEvent, eventID="+d);switch(d){case f.EID_SWITCH:q.Value=e,n=!0;break;case f.EID_CLICK:q.Text=e;break;case f.EID_INPUT:q.Text=e;break;case f.EID_ONVIEWCHANGED:q.Text=e;break;case f.EID_SWITCH_HIERPOPUP:q.Text=e,n=!0;break;case f.EID_OPENNODE:case f.EID_CLOSENODE:q.Row=e;break;case f.EID_SELECTNODE:q.Node=e;break;case f.EID_MULTISELECTION:q.Selections=e,n=!0;break;case f.EID_DOCACTIVATE:case f.EID_DROP:q.Text=e}g!==undefined&&(q.PositionY=g),h!==undefined&&(q.PositionX=h),d===f.EID_SELECTNODE?q.Shift=j===!0||l===!0:d===f.EID_INPUT?(q.Key=i||0,q.Shift=j===!0,q.Ctrl=l===!0):d===f.EID_CLICK&&(q.Shift=j===!0,q.Ctrl=l===!0),q.Settings=k.getScrolledObjects(),k.clearScrolledObjects(),_(A.operationNames.SendEvent,q,bh,"doSendEvent"),n===!0&&m.notifyFilterHasChanged(o)},bn=function(a){bm(a,0,f.EID_DOCACTIVATE,"0")},bo=function(a,b,c){if(!A.sessionContext.getWaitingState()&&!Y())bm(a,0,b,c);else{if(A.isSessionClosing)return;A.changedView={docName:a,evID:b,viewName:c}}},bp=function(a,b){function c(a){bh(a),b()}A.sessionContext.logger.log("doOpenBookmark("+A.sessionID+")"),_(A.operationNames.SendEvent,{Worksheet:A.startdoc,ObjID:"0",EventID:f.EID_OPENBOOKMARK,Text:a},c,"doOpenBookmark")},bq=function(a,b){function c(b){A.sessionContext.onWaitingStateChanged(!1),a({application:A.application,document:A.view.getTopDocumentName(),bookmark:b.Bookmark})}A.sessionContext.logger.log("CreateBookmark("+A.sessionID+")"),_(A.operationNames.CreateBookmark,{Element:0,ObjID:0,Worksheet:A.view.getTopDocumentName()},c,"doCreateBookmark",b)},br=function(){var a=c.createGetRequest("closepresentation",A.cgiSite,A.serverName,{PARAM1:A.sessionID});A.isSessionClosing||(A.sessionContext.logger.log("closeSession("+A.sessionID+")"),j.stopKeepAlives(A.keepAliveIntervalId),A.isSessionClosing=!0,$.each(A.runningRequestList,function(a,b){b.abort()}),c.makeSynchronousGetRequest(a),A.runningRequestList=[],A.view.cleanOnSessionEnd(),$.modal.close())},bs=function(a){A.view.setLastMouseDownPos(a)},bt=function(a){a==="-112"?F(null,p.LICENCE_ERROR_TITLE,p.LICENCE_EXCEEDED,!0):a==="-113"?F(null,p.LICENCE_ERROR_TITLE,p.LICENCE_EXPIRED,!0):a==="-116"?F(null,p.LICENCE_ERROR_TITLE,p.NOMOBILE_CLIENT_LICENSE,!0):a==="-118"?F(null,p.LICENCE_ERROR_TITLE,p.NOHTML5_MOBILEUSAGE,!0):a==="-119"?F(null,p.LICENCE_ERROR_TITLE,p.NOTHML5_USAGE,!0):F(null,p.DATA_ERROR_TITLE,p.SESSION_END,!0)},bu=function(a,b){var d="";return c.addSessionIdAndTokenToParams(b,A.sessionID,A.sessionToken),d=c.createSoapRequest(a,b,A.serverName),d},bv=function(){function b(a){var b="Error on send KeepAliveRequest:";typeof a!="undefined"&&(typeof a.caption!="undefined"&&(b+=" Details:"+a.caption),typeof a.text!="undefined"&&(b+=" - "+a.text)),A.sessionContext.logger.log(b),j.stopKeepAlives(A.keepAliveIntervalId)}var a=!0;ba(A.operationNames.KeepAlive,{},function(){},"keepAlive",b,a)},bw=function(){var b=ARCPLAN.language||"server",c={server:"0",en:"1",de:"2"};b.toLowerCase()==="client"&&(b=a.browserLangToArcplanLang(h.clientLanguage));switch(b.toLowerCase()){case"en":return c.en;case"de":return c.de;default:return c.server}};return C={doInitPresentation:function(){var a=function(a){a&&(A.sessionID=a.SessionID,A.sessionToken=a.SessionToken,A.serverName=a.SelectedServerName,A.serverVersion=a.ServerVersion,A.licenseFlag=a.License,A.licenseType=a.Type,A.licenseOwnerName=a.OwnerName,r.addLicenseInformation(A.serverVersion,A.licenseFlag,A.licenseType,A.licenseOwnerName),A.sessionID>0?(H(),i.getNumParams()>0?bk():bj(),A.keepAliveIntervalId=j.startKeepAlives(bv)):bt(A.sessionID))};A.sessionContext.onWaitingStateChanged(!0),A.sessionContext.logger.log("InitPresentation "+(new Date).toLocaleString()),W(A.operationNames.InitPresentation,{ClientType:A.clientParams.clientType,AppName:A.application+"\\"+A.startdoc,ClientVersion:e.getVersion(),LangId:bw(),"arcplanClient ":null},a,"doInitPresentation")},hasPendingUserinformation:Y,doSendEvent:bm,doChangeViewEventWithRetryIfWaiting:bo,doDocActivateEvent:bn,doOpenDoc:bd,doOpenBookmark:bp,doCreateBookmark:bq,doOpenPDF:be,doOpenFile:bf,buildObjectPictRequest:K,downloadPictToBrowserCache:U,setView:I,requestObjectData:R,requestHierData:Q,requestObjectDataWithFilter:S,closeSession:br,setLastMouseDownPos:bs,getSoapMessage:bu,setTimeOutInMilliseconds:E,removeHashFromObjectDataRequestList:O},C}return{createInstance:u}});var ARCPLAN=ARCPLAN||{};define("sessionobject",["jquery","tools","arcplanobjects/arcplanobjectsfactory","components/button/buttonbuilder","requestprocessorfactory","events/eventcallbacks","logger","view","browserfeatures","jquery.simplemodal"],function(a,b,c,d,e,f,g,h,i){function j(){a("#arcSplashScreen").length===0&&(a.modal(a("<div></div>").attr("id","arcLoadingContainer").append(a("<div></div>").attr("class","arcLoadingImage").attr("alt","Loading...")),{close:!1,autoResize:!0,zIndex:2e6,fadeInDelay:1e3,onOpen:function(a){i.mobile&&a.data.show(),a.overlay.show().css("background-color","#000")}}),a(".simplemodal-overlay").addClass("arcWaiting"),a(".simplemodal-container").addClass("arcWaiting"))}function k(){a(".simplemodal-container").removeClass("arcWaiting"),a(".simplemodal-overlay").removeClass("arcWaiting").append(a("<div></div>")).css("cursor","default"),a("#arcSplashScreen").length===0?a.modal.close():(a("#arcContainer").css("overflow",""),a("#arcSplashScreen").remove(),a(window).off("resize.arcResizeSplashScreen"))}return function(){var b={},i={cgi:"/arcplan/8/scripts/arcCGI8.exe",application:undefined,startdoc:undefined,docAreaRectForWidget:undefined,fixedWindowSizeForWidget:undefined,requestObj:undefined,view:undefined,docSizeChangedListener:undefined,loginEventListener:undefined,openDocumentFromWidgetListener:undefined,waitingstate:!1},l=function(){return i.waitingstate||i.requestObj.hasPendingUserinformation()},m={logger:g,getApplication:function(){return i.application},getStartDoc:function(){return i.startdoc},getDocAreaRectForWidget:function(){return i.docAreaRectForWidget},getFixedWindowSizeForWidget:function(){return i.fixedWindowSizeForWidget},getWaitingState:function(){return i.waitingstate},onWaitingStateChanged:function(a){a!==i.waitingstate&&(g.log("onWaitingStateChanged: "+a),i.waitingstate=a,a?j():k(),typeof ARCPLAN.onWaitingStateChanged=="function"&&ARCPLAN.onWaitingStateChanged(a))},onOpenDocumentFromWidget:function(a){typeof i.openDocumentFromWidgetListener=="function"&&i.openDocumentFromWidgetListener(a)},onDocumentLoaded:function(){typeof ARCPLAN.oOnDocumentLoaded=="function"&&ARCPLAN.oOnDocumentLoaded()},onNotifyLogin:function(){typeof i.loginEventListener=="function"&&i.loginEventListener()}};return b.getWaitingState=function(){return i.waitingstate},b.setCgi=function(a){i.cgi=a},b.setApplication=function(a){i.application=a},b.setStartDoc=function(a){i.startdoc=a},b.setDocAreaRectForWidget=function(a){i.docAreaRectForWidget=a},b.setFixedWindowSizeForWidget=function(a,b){i.fixedWindowSizeForWidget={width:a,height:b}},b.setDocSizeChangedListener=function(a){i.docSizeChangedListener=a},b.setLoginEventListener=function(a){i.loginEventListener=a},b.setOpenDocumentFromWidgetListener=function(a){i.openDocumentFromWidgetListener=a},b.doInitPresentation=function(){var b=a('meta[name="viewport"]').attr("content"),g;b&&(b=b.replace("maximum-scale=1.0","maximum-scale=10.0"),a('meta[name="viewport"]').attr("content",b)),g=c.createInstance(),d.setOnButtonClickCallback(f.onButtonClickCallback),g.registerArcplanObjectBuilder("Button",d),i.requestObj=e.createInstance(i.cgi,m,g),f.setRequestProcessor(i.requestObj),i.view=h(i.requestObj,m,g,50),i.view.setDocSizeChangedListener(i.docSizeChangedListener),i.requestObj.doInitPresentation()},b.doSendEvent=function(a,b,c,d,e,f){if(i.requestObj===undefined)throw"Session has not been initialized cannot send event: "+a+"_"+b+"_"+c;return l()?!1:(i.requestObj.doSendEvent(a,b,c,d,e,f),!0)},b.doOpenBookmark=function(a,b){if(i.requestObj===undefined)throw"Session has not been initialized cannot send event";return l()?!1:(i.requestObj.doOpenBookmark(a,b),!0)},b.doCreateBookmark=function(a,b){if(i.requestObj===undefined)throw"Session has not been initialized cannot send request";return l()?!1:(i.requestObj.doCreateBookmark(a,b),!0)},b.doGetDocCurrentView=function(){return i.view.getDocCurrentView()},b.doGetCurrentDocProperties=function(){return i.view.getCurrentDocProperties()},b.closeSession=function(){i.requestObj.closeSession()},b}});var ARCPLAN=ARCPLAN||{};define("arcclient",["jquery","sessionobject","userparam","events/eventid","browserfeatures","msgbox","version","motionchartviewmodel","filterpanel","stringsres","stringsid","splashscreen"],function(a,b,c,d,e,f,g,h,i,j,k,l){function o(c,d,g){j.resetCustomStringResources(),a("#arcContainer").children().remove(),m.mockSessionObj?m.sessionObj=m.mockSessionObj:(m.sessionObj=b(),e.compatibilityMode()&&f.createMsgBox().withCaption(j.getMessageById(k.COMPATIBILITY_WARNING_TITLE)).withText(j.getMessageById(k.COMPATIBILITY_WARNING)).indicating("warning").logIt().andShowIt()),typeof m.docSizeChangedListener=="function"&&m.sessionObj.setDocSizeChangedListener(m.docSizeChangedListener),typeof m.loginEventListener=="function"&&m.sessionObj.setLoginEventListener(m.loginEventListener),typeof g=="string"&&m.sessionObj.setCgi(g),typeof c=="string"&&m.sessionObj.setApplication(c),typeof d=="string"&&m.sessionObj.setStartDoc(d)}function p(a){window.console&&window.console.warn(a)}function q(){var b=a("#arcContainer"),c="<div id='arcSplashScreen' class='arcWidgetSplashScreen'><div class='arcVerticalCentered'><div id='arcWidgetSplashScreenContainer'><div class='arcLoadingImage arcHorizontalCentered'></div></div></div></div>";b.before(c)}var m={mockSessionObj:undefined,sessionObj:undefined,docSizeChangedListener:undefined,loginEventListener:undefined},n={};return n.setMockSessionObj=function(a){m.mockSessionObj=a},n.changeLocation=function(a,b,d,e){l.show(),o(a,b,d),typeof e=="function"&&e(c),m.sessionObj.doInitPresentation()},n.showDocAreaForWidget=function(a,b,c,d,e,f,g,h,i){var j={left:parseInt(d,10),top:parseInt(e,10),right:parseInt(d,10)+parseInt(f,10),bottom:parseInt(e,10)+parseInt(g,10),width:parseInt(f,10),height:parseInt(g,10)};if(isNaN(j.left)===!0)throw"docAreaRect.left is not a number";if(isNaN(j.top)===!0)throw"docAreaRect.top is not a number";if(isNaN(j.width)===!0)throw"docAreaRect.width is not a number";if(isNaN(j.height)===!0)throw"docAreaRect.height is not a number";q(),o(a,b,c),m.sessionObj.setDocAreaRectForWidget(j),h>0&&i>0&&m.sessionObj.setFixedWindowSizeForWidget(h,i),m.sessionObj.doInitPresentation()},n.acSendClickEvent=function(a,b,c,e){var f=c-1,g=e-1;return m.sessionObj.doSendEvent(a,b,d.EID_CLICK,"",f,g)},n.acSendInputEvent=function(a,b,c,e,f){var g=e-1,h=f-1;return m.sessionObj.doSendEvent(a,b,d.EID_INPUT,c,g,h)},n.acSendSwitchEvent=function(a,b,c){return m.sessionObj.doSendEvent(a,b,d.EID_SWITCH,c)},n.acSendEvent=function(a,b,c,d,e,f,g){try{var h;if(c===undefined||c==="")throw"Parameter 'eventName' must not be null or empty.";if(c.toUpperCase()==="CLICK")return n.acSendClickEvent(a,b,f,g);if(c.toUpperCase()==="SWITCH"){if(e===undefined||e.toLowerCase()!=="int")throw"Parameter 'parameterType' must be int for SWITCH-Event.";try{h=parseInt(d,10)}catch(i){throw"Parameter 'parameter="+d+"' for SWITCH-Event is not a number"+i}return n.acSendSwitchEvent(a,b,h)}if(c.toUpperCase()==="INPUT")return n.acSendInputEvent(a,b,d,f,g);throw"Event '"+c+"' is not supported."}catch(j){throw"Exception occurred while trying to send request: "+j}},n.createMotionChartModel=function(a,b){return new h.CMotionChartViewModel(a,b)},n.openBookmark=function(a,b){return m.sessionObj.doOpenBookmark(a,b)},n.createBookmark=function(a,b){return m.sessionObj.doCreateBookmark(a,b)},n.getDocCurrentView=function(){return m.sessionObj.doGetDocCurrentView()},n.getCurrentDocProperties=function(){return m.sessionObj.doGetCurrentDocProperties()},n.closeSession=function(){m.sessionObj!==undefined&&(m.sessionObj.closeSession(),m={mockSessionObj:m.mockSessionObj})},n.toggleFilterPanel=function(){i.toggleFilterPanel()},n.setDocSizeChangedListener=function(a){m.sessionObj&&m.sessionObj.setDocSizeChangedListener(a),m.docSizeChangedListener=a},n.setFilterPanelEventListener=function(a){i.setEventListener(a)},n.setFilterPanelInitialPinnedState=function(a){i.setIsInitiallyPinned(a)},n.setLoginEventListener=function(a){m.loginEventListener=a},n.setOpenDocumentFromWidgetListener=function(a){m.sessionObj&&m.sessionObj.setOpenDocumentFromWidgetListener(a)},a(document).ready(function(){ARCPLAN.suppressAutomaticStartup!==!0&&(g.logVersion(),n.changeLocation(ARCPLAN.application,ARCPLAN.startDocName,ARCPLAN.arcCgiSite,ARCPLAN.setUserParams)),window.unload=function(){n.closeSession()},window.onbeforeunload=function(){n.closeSession()},e.scrollbarWidth=e.measureScrollbarWidth()}),n})