define("scroll",["jquery","tools","stringtools","logger","properties","browserfeatures","textinput","objectresizer","scrollobserver","datavirtualization"],function(a,b,c,d,e,f,g,h,i,j){function o(b,c,d){var e,f,g,h=null,i;i=a("embed",d).get();if(i.length>0){e=i[0].getSVGDocument();if(e){f=e.getElementsByTagName("g");if(f){b||(b="0"),c||(c="0");for(g=0;g<f.length;g+=1)if(f[g]){switch(f[g].getAttribute("Scroll")){case"vert":h="translate(0,-"+c+")";break;case"hor":h="translate(-"+b+",0)";break;case"both":h="translate(-"+b+",-"+c+")";break;default:h=null}h&&f[g].setAttribute("transform",h)}}}}}function p(a,b){var c,f=!b.hasClass("arcHide-scrollbar-hori"),g=!b.hasClass("arcHide-scrollbar-vert"),h=e.getScrollHeight(a),n=e.getScrollWidth(a),o=b.height(),p=b.width();d.log("adding Touch event handler to "+e.getDocName(a)+":"+e.getID(a)),b.addClass("wrapper"),b.children("div").not(".arcIETransparentBackgroundFix").addClass("scroller"),c=e.getIScrollInstance(a),c&&c.destroy(),c=new window.iScroll(b[0],{bounce:!1,hideScrollbar:!0,hScrollbar:f,vScrollbar:g,onBeforeScrollStart:function(a){a.changedTouches&&a.changedTouches.length>1&&a.preventDefault()},onScrollStart:function(){l||i.addScrolledObject(a),this.isEventObj=!0,this.lastPos===undefined&&(this.lastPos={left:0,top:0},this.scrollBarObj={vert:null,hori:null},this.scrollRefs={vert:null,hori:null}),this.scrollBarObj.vert=e.getScrollBarObjVert(a)||a,this.scrollBarObj.hori=e.getScrollBarObjHori(a)||a,e.getScrollRefs(this.scrollBarObj.vert)&&(this.scrollRefs.vert=e.getScrollRefs(this.scrollBarObj.vert).vert),e.getScrollRefs(this.scrollBarObj.hori)&&(this.scrollRefs.hori=e.getScrollRefs(this.scrollBarObj.hori).hori)},onScrollEnd:function(){this.isEventObj=!1,e.setScrollX(a,-this.x),e.setScrollY(a,-this.y),j.updatePosition(a),m=!1},onScrollMove:function(b,c,d){var f,g={left:0-(c||0),top:0-(d||0)},i,l=d===0,m=0-d+o>=h,q=c===0,r=0-c+p>=n,s;b&&(h&&!l&&!m||n&&!q&&!r)&&b.preventDefault(),e.setScrollX(a,g.left),e.setScrollY(a,g.top),this.lastPos.top!==g.top?(i=this.scrollRefs.vert,this.scrollBarObj.vert&&(s=e.getIScrollInstance(this.scrollBarObj.vert))):this.lastPos.left!==g.left&&(i=this.scrollRefs.hori,this.scrollBarObj.hori&&(s=e.getIScrollInstance(this.scrollBarObj.hori))),this.lastPos=g,s&&s.isEventObj===!1&&s.scrollTo(c,d);if(i)for(f=0;f<i.length;f+=1)s=e.getIScrollInstance(i[f]),s&&s.isEventObj===!1?s.scrollTo(c,d):e.getObjType(i[f])==="SVGContainer"&&k.scrollTo(i[f],undefined,-c,-d);j.updatePosition(a)}}),e.setIScrollInstance(a,c)}function q(a,b,c){var d;for(d=0;d<a.length;d+=1)k.scrollTo(a[d],undefined,b,c)}function r(b){var c=function(){var c,d,h,o,p;b.data.ref&&(l||i.addScrolledObject(b.data.ref),c=e.getScrollRefs(b.data.ref),d=e.getScrollElem(b.data.ref),d&&d[0]&&(f.mobile&&b.originalEvent.preventDefault(),o=d[0].scrollLeft,p=d[0].scrollTop,e.setScrollX(b.data.ref,o),e.setScrollY(b.data.ref,p),c&&(q(c.vert,undefined,p),q(c.hori,o,undefined),c.vert.length===0&&(h=e.getScrollBarObjVert(b.data.ref),h&&k.scrollTo(h,undefined,undefined,p)),c.hori.length===0&&(h=e.getScrollBarObjHori(b.data.ref),h&&k.scrollTo(h,undefined,o,undefined))),a("#arcTextInput").length===1&&g.recalcInputPosition(b.data.ref),m||n.onScroll(),j.updatePosition(b.data.ref))),m=!1},d=!1;d=typeof e.getScrollRequestId(b.data.ref)!="undefined"?e.getScrollRequestId(b.data.ref):!1,ARCPLAN.scrollDirectly?c():(d&&window.cancelAnimationFrame(d),d=window.requestAnimationFrame(c),e.setScrollRequestId(b.data.ref,d))}function s(b){var c;ARCPLAN.datavirtualization!==!1&&(e.getObjType(b)==="Menu"||e.isUseContentPaging(b))&&(e.getObjType(b)==="Menu"?c=a(".arcPopupContent",b):c=a(".arcHierPopupInnerDiv",b),c.off("scroll.menuscroll"),c.on("scroll.menuscroll",function(){e.setScrollY(b,a(this).scrollTop()),j.updatePosition(b)}))}function t(a){var b=e.getObjType(a);return b==="MenuHierarchie"||b==="Menu"}function u(a){var b;b=e.getScrollElem(a),t(a)?s(a):b&&b[0]&&e.getObjType(a)!=="SVGContainer"&&(e.getScrollHeight(a)||e.getScrollWidth(a))&&(f.mobile&&window.iScroll?p(a,b):(b.off("scroll",r),b.on("scroll",{ref:a},r)))}function v(b,d,f){var g=e.getDocName(b),h=e.getScrollDeps(b),i,j,k;if(h)for(i=0;i<h[f].length;i+=1)j=c.makeID(g,h[f][i]),k=a("#"+j),k.length!==0&&d.indexOf(k)===-1&&(z(k)&&d.push(k),v(k,d,f))}function w(a,b){v(a,b,"vert")}function x(a,b){v(a,b,"hori")}function y(a,c){function d(a){var b=e.getScrollElem(a),c=!1,d=e.getObjType(a),f=e.getColumnWidth(a),g=e.getWidth(a),h=e.getHScrollBarAllowed(a);if(!h)return!1;switch(d){case"Table":case"Row":if(f.accumulatedColumnWidth>g)return!0;return!1;case"Field":return!1;default:return b&&(c=b.css("overflow-x")==="auto"),c&&b[0].clientWidth<b[0].scrollWidth}}function g(a,b){var c=e.getScrollElem(a),d,g,h=e.getObjType(a);if(!c)return;d=e.getExtraScrollHeight(a)>0;switch(h){case"Table":case"Column":g=e.getNumRows(a)*e.getRowHeight(a),g>144e4&&(g=c.find(":first").height());break;default:g=c.find(":first").height()}!d&&b?(g+=f.scrollbarWidth,c.find(":first").height(g)):d&&!b&&(g-=f.scrollbarWidth,c.find(":first").height(g)),e.setScrollHeight(a,g),b?e.setExtraScrollHeight(a,f.scrollbarWidth):e.setExtraScrollHeight(a,0)}if(c.length>0){var h=d(a),i=!1,j={};b.each(c,function(a,b){j[a]=d(b),i=i||j[a]}),i?g(a,!h):g(a,!1),b.each(c,function(a,b){g(b,(i||h)&&!j[a])})}}function z(a){return typeof a!="undefined"&&e.isVisible(a)===!0&&e.isAvailableInView(a)===!0}var k={},l=!1,m=!1,n;return require(["draganddrop"],function(a){n=a}),window.iScroll&&(window.iScroll.prototype.isEventObj=!1,window.iScroll.prototype.scrollBarObj={vert:null,hori:null},window.iScroll.prototype.scrollRefs={vert:null,hori:null},window.iScroll.prototype.lastPos={left:0,top:0}),k.scrollTo=function(a,b,c,f){var g=e.getIScrollInstance(a),h=!1;if(g){c===undefined&&(c=e.getScrollX(a)),f===undefined&&(f=e.getScrollY(a));if(!b||c!==b[0].scrollLeft||f!==b[0].scrollTop)g.options.onScrollStart(),g.options.onScrollMove(undefined,0-c,0-f),g.options.onScrollEnd()}else b=b||e.getScrollElem(a),b&&b[0]?(c!==undefined&&c!==b[0].scrollLeft&&(m=!0,h=!0,b.scrollLeft(c)),f!==undefined&&f!==b[0].scrollTop&&(m=!0,h=!0,b.scrollTop(f)),h&&j.updatePosition(a)):a.children().first().hasClass("dynaChart")?o(c,f,a):d.log("No scrollElem in "+e.getObjType(a)+" "+e.getID(a))},k.updateScrollReferences=function(a){var b,c={vert:[],hori:[]},d=e.getDocName(a),f=e.getScrollDeps(a),g,h;if(e.isVisible(a)){u(a);if(f){w(a,c.vert),x(a,c.hori),g=e.getScrollBarObjVert(a),h=e.getScrollBarObjHori(a),z(g)||(g=a),z(h)||(h=a);for(b=0;b<c.vert.length;b+=1)e.setScrollBarObjVert(c.vert[b],g),c.vert[b].addClass("arcHide-scrollbar-vert"),u(c.vert[b]);for(b=0;b<c.hori.length;b+=1)e.setScrollBarObjHori(c.hori[b],h),c.hori[b].addClass("arcHide-scrollbar-hori"),u(c.hori[b]);y(a,c.vert)}e.setScrollRefs(a,c)}},k.setIgnoreJavaScriptEvents=function(a){l=a},k.getScrollableElement=function(a){return h.getScrollableElement(a)},window.jasmine&&(k.onScroll=r),k.getScrolledObjects=i.getScrolledObjects,k.clearScrolledObjects=i.clearScrolledObjects,k})